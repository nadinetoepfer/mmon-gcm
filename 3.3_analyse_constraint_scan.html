<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>mmon-gcm - Analysing the results of the constraint scan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./4.1_generate_alternative_flux_modes_matrix.html" rel="next">
<link href="./3.2_run_constraint_scan.html" rel="prev">
<link href="./favicon.svg" rel="icon" type="image/svg+xml">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="mmon-gcm - Analysing the results of the constraint scan">
<meta property="og:description" content="\(e = FqFm \cdot R_{ch}\) <- We want to know e, that is the capacity of guard cell vs mesophyll. Function of efficiency and number of chloroplasts">
<meta property="og:site-name" content="mmon-gcm">
<meta name="twitter:title" content="mmon-gcm - Analysing the results of the constraint scan">
<meta name="twitter:description" content="\(e = FqFm \cdot R_{ch}\) <- We want to know e, that is the capacity of guard cell vs mesophyll. Function of efficiency and number of chloroplasts">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">mmon-gcm</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Analysing the results of the constraint scan</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./logo.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">MMON-GCM</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Building model and defining parameters</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.0_generating_linkers.html" class="sidebar-item-text sidebar-link">Generating table for linkers/osmolytes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.1_buildingmodel.html" class="sidebar-item-text sidebar-link">Building model</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.2_defining_parameters.html" class="sidebar-item-text sidebar-link">Finding parameters</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.3_atpase_constraint.html" class="sidebar-item-text sidebar-link">Is H+ATPase limiting?</a>
  </div>
</li>
          <li class="sidebar-item">
  1.4_flutschconcentrations.ipynb
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.5_convert_horrer_starch_level.html" class="sidebar-item-text sidebar-link">Starch amount estimation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Solving and analysing specific scenarios for paper</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.1_solvingmodel.html" class="sidebar-item-text sidebar-link">Solving guard cell models for different parameters</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.2_analysingsolutions.html" class="sidebar-item-text sidebar-link">Analysing solutions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.3_flux_map_values.html" class="sidebar-item-text sidebar-link">Calculating line widths for flux maps</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Running constraints scan</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.1_generate_constraints_df.html" class="sidebar-item-text sidebar-link">Constraint scan</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.2_run_constraint_scan.html" class="sidebar-item-text sidebar-link">Running Constraint Scan</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.3_analyse_constraint_scan.html" class="sidebar-item-text sidebar-link active">Analysing the results of the constraint scan</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Running and analysing alternative flux modes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4.1_generate_alternative_flux_modes_matrix.html" class="sidebar-item-text sidebar-link">Alternative Flux Modes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4.2_run_alternative_flux_modes.html" class="sidebar-item-text sidebar-link">Run alternative flux modes simulations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4.3_analyse_alternative_flux_modes.html" class="sidebar-item-text sidebar-link">Analysing alternative flux modes</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  prep_plant_cell.ipynb
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">functions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/alternativemodes.html" class="sidebar-item-text sidebar-link">alternativemodes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/analysing.html" class="sidebar-item-text sidebar-link">Analysing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/buildingediting.html" class="sidebar-item-text sidebar-link">buildingediting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/constraintscan.html" class="sidebar-item-text sidebar-link">constraintscan</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/helper.html" class="sidebar-item-text sidebar-link">Helper functions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/osmolyteconstraints.html" class="sidebar-item-text sidebar-link">osmolyteconstraints</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/solving.html" class="sidebar-item-text sidebar-link">solving</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#importing-results-and-constraints" id="toc-importing-results-and-constraints" class="nav-link active" data-scroll-target="#importing-results-and-constraints">Importing results and constraints</a></li>
  <li><a href="#a---what-contributes-to-phloem-output" id="toc-a---what-contributes-to-phloem-output" class="nav-link" data-scroll-target="#a---what-contributes-to-phloem-output">7a - What contributes to phloem output?</a>
  <ul class="collapse">
  <li><a href="#set-up-features-for-linear-regression-by" id="toc-set-up-features-for-linear-regression-by" class="nav-link" data-scroll-target="#set-up-features-for-linear-regression-by">Set up features for linear regression by</a></li>
  <li><a href="#compare-full-and-gc-features" id="toc-compare-full-and-gc-features" class="nav-link" data-scroll-target="#compare-full-and-gc-features">Compare full and gc features</a></li>
  </ul></li>
  <li><a href="#b---what-affects-hexose-export-from-the-guard-cell" id="toc-b---what-affects-hexose-export-from-the-guard-cell" class="nav-link" data-scroll-target="#b---what-affects-hexose-export-from-the-guard-cell">7b - What affects hexose export from the guard cell?</a>
  <ul class="collapse">
  <li><a href="#generate-hexose-export-df" id="toc-generate-hexose-export-df" class="nav-link" data-scroll-target="#generate-hexose-export-df">Generate hexose export df</a></li>
  <li><a href="#fit-model-to-hexose-export" id="toc-fit-model-to-hexose-export" class="nav-link" data-scroll-target="#fit-model-to-hexose-export">Fit model to hexose export</a></li>
  <li><a href="#create-a-reponse-for-total-photons-into-the-gc-irrespective-of-blue-or-white-light" id="toc-create-a-reponse-for-total-photons-into-the-gc-irrespective-of-blue-or-white-light" class="nav-link" data-scroll-target="#create-a-reponse-for-total-photons-into-the-gc-irrespective-of-blue-or-white-light">Create a reponse for total photons into the GC, irrespective of blue or white light</a></li>
  <li><a href="#are-there-any-solutions-that-are-below-0" id="toc-are-there-any-solutions-that-are-below-0" class="nav-link" data-scroll-target="#are-there-any-solutions-that-are-below-0">Are there any solutions that are below 0?</a></li>
  </ul></li>
  <li><a href="#at-our-predicted-level-of-osmolarity-and-other-guard-cell-parameters-what-would-fqfm.r_ch-need-to-be-for-guard-cell-to-act-as-a-sink" id="toc-at-our-predicted-level-of-osmolarity-and-other-guard-cell-parameters-what-would-fqfm.r_ch-need-to-be-for-guard-cell-to-act-as-a-sink" class="nav-link" data-scroll-target="#at-our-predicted-level-of-osmolarity-and-other-guard-cell-parameters-what-would-fqfm.r_ch-need-to-be-for-guard-cell-to-act-as-a-sink">At our predicted level of osmolarity and other guard cell parameters, what would FqFm.R_ch need to be for guard cell to act as a sink?</a>
  <ul class="collapse">
  <li><a href="#what-is-the-range-of-photosynthetic-capacities-that-we-use" id="toc-what-is-the-range-of-photosynthetic-capacities-that-we-use" class="nav-link" data-scroll-target="#what-is-the-range-of-photosynthetic-capacities-that-we-use">What is the range of photosynthetic capacities that we use?</a></li>
  </ul></li>
  <li><a href="#c---so-does-the-atpase-have-an-effect-on-starch-if-not-on-hexose-export-very-much" id="toc-c---so-does-the-atpase-have-an-effect-on-starch-if-not-on-hexose-export-very-much" class="nav-link" data-scroll-target="#c---so-does-the-atpase-have-an-effect-on-starch-if-not-on-hexose-export-very-much">7c - So does the ATPase have an effect on starch if not on hexose export very much?</a>
  <ul class="collapse">
  <li><a href="#how-many-solutions-utilise-starch" id="toc-how-many-solutions-utilise-starch" class="nav-link" data-scroll-target="#how-many-solutions-utilise-starch">How many solutions utilise starch?</a></li>
  </ul></li>
  <li><a href="#in-how-many-of-those-solutions-is-the-atpase-constrained" id="toc-in-how-many-of-those-solutions-is-the-atpase-constrained" class="nav-link" data-scroll-target="#in-how-many-of-those-solutions-is-the-atpase-constrained">In how many of those solutions is the ATPase constrained?</a></li>
  <li><a href="#how-many-constrained-solutions-dont-use-starch" id="toc-how-many-constrained-solutions-dont-use-starch" class="nav-link" data-scroll-target="#how-many-constrained-solutions-dont-use-starch">How many constrained solutions don’t use starch?</a>
  <ul class="collapse">
  <li><a href="#how-do-starch-levels-vary-with-whiteblue-light" id="toc-how-do-starch-levels-vary-with-whiteblue-light" class="nav-link" data-scroll-target="#how-do-starch-levels-vary-with-whiteblue-light">How do starch levels vary with white/blue light?</a></li>
  </ul></li>
  <li><a href="#how-is-starch-used" id="toc-how-is-starch-used" class="nav-link" data-scroll-target="#how-is-starch-used">How is starch used?</a></li>
  <li><a href="#d---how-does-glucose-increase-during-opening-vary-with-starch-and-why-isnt-it-totally-linear" id="toc-d---how-does-glucose-increase-during-opening-vary-with-starch-and-why-isnt-it-totally-linear" class="nav-link" data-scroll-target="#d---how-does-glucose-increase-during-opening-vary-with-starch-and-why-isnt-it-totally-linear">7d - How does glucose increase during opening vary with starch, and why isn’t it totally linear?</a></li>
  <li><a href="#combine-subfigures" id="toc-combine-subfigures" class="nav-link" data-scroll-target="#combine-subfigures">Combine subfigures</a></li>
  <li><a href="#extra-analyses-not-included" id="toc-extra-analyses-not-included" class="nav-link" data-scroll-target="#extra-analyses-not-included">Extra analyses not included</a>
  <ul class="collapse">
  <li><a href="#what-is-the-ratio-of-mitochondrial-to-plastidic-atp-synthase" id="toc-what-is-the-ratio-of-mitochondrial-to-plastidic-atp-synthase" class="nav-link" data-scroll-target="#what-is-the-ratio-of-mitochondrial-to-plastidic-atp-synthase">What is the ratio of mitochondrial to plastidic ATP synthase?</a></li>
  </ul></li>
  <li><a href="#almost-all-starch-is-used-for-glucose-and-pep-carboxykinase-reaction-never-runs" id="toc-almost-all-starch-is-used-for-glucose-and-pep-carboxykinase-reaction-never-runs" class="nav-link" data-scroll-target="#almost-all-starch-is-used-for-glucose-and-pep-carboxykinase-reaction-never-runs">Almost all starch is used for glucose, and PEP carboxykinase reaction never runs</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/noahsprent/mmon-gcm/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Analysing the results of the constraint scan</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cobra</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.cm <span class="im">import</span> ScalarMappable</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.colors <span class="im">import</span> Normalize</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.ticker <span class="im">import</span> AutoMinorLocator, MultipleLocator</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mmon_gcm.analysing <span class="im">import</span> get_phase_lengths</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mmon_gcm.supermodel <span class="im">import</span> SuperModel</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error, r2_score</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> OneHotEncoder, StandardScaler</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sns.set_theme()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"ticks"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>palettes <span class="op">=</span> {</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tol_bright"</span>: sns.color_palette([<span class="st">"#4477AA"</span>, <span class="st">"#66CCEE"</span>, <span class="st">"#228833"</span>, <span class="st">"#CCBB44"</span>, <span class="st">"#EE6677"</span>, <span class="st">"#AA3377"</span>, <span class="st">"#BBBBBB"</span>]),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"tol_muted"</span>: sns.color_palette([<span class="st">"#332288"</span>, <span class="st">"#88CCEE"</span>, <span class="st">"#44AA99"</span>, <span class="st">"#117733"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">"#999933"</span>, <span class="st">"#DDCC77"</span>, <span class="st">"#CC6677"</span>, <span class="st">"#882255"</span>, <span class="st">"#AA4499"</span>])</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>sns.set_palette(palettes[<span class="st">"tol_muted"</span>])</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>colours <span class="op">=</span> sns.color_palette()</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'xtick.labelsize'</span>: <span class="st">'large'</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'ytick.labelsize'</span>: <span class="st">'large'</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.labelsize'</span>: <span class="st">'large'</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.titlesize'</span>: <span class="st">'x-large'</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'font.family'</span>: <span class="st">'sans-serif'</span>,</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.spines.right'</span>: <span class="va">False</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">'axes.spines.top'</span>: <span class="va">False</span>,</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">'legend.frameon'</span>: <span class="va">False</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">'savefig.bbox'</span>: <span class="st">'tight'</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">'lines.linewidth'</span>: <span class="fl">2.5</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.figsize'</span>: [<span class="dv">5</span>, <span class="fl">3.75</span>],</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">'figure.dpi'</span>: <span class="dv">150</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update(params)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_bounds_in_model(constraints):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    super_model <span class="op">=</span> SuperModel(constraints)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    volumes <span class="op">=</span> super_model.get_volumes(per_guard_cell<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    closed_volume <span class="op">=</span> volumes[<span class="dv">0</span>]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    open_volume <span class="op">=</span> volumes[<span class="dv">1</span>]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    osmolarities <span class="op">=</span> super_model.get_osmolarities()</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    closed_osmolarity <span class="op">=</span> osmolarities[<span class="dv">0</span>]</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    open_osmolarity <span class="op">=</span> osmolarities[<span class="dv">1</span>]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    photons <span class="op">=</span> super_model.get_photons(<span class="dv">150</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    gc_photons <span class="op">=</span> photons[<span class="dv">0</span>]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    gc_atpase_upper_bound <span class="op">=</span> super_model.get_atpase_constraint_value(constraints.loc[<span class="st">"ATPase"</span>])</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">"V_closed"</span>: closed_volume,</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"V_open"</span>: open_volume,</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Os_closed"</span>: closed_osmolarity,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Os_open"</span>: open_osmolarity,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Photons"</span>: gc_photons,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>            <span class="st">"ATPase"</span>: gc_atpase_upper_bound}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="importing-results-and-constraints" class="level2">
<h2 class="anchored" data-anchor-id="importing-results-and-constraints">Importing results and constraints</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import results files</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>blue_results <span class="op">=</span> pd.read_csv(<span class="st">"../outputs/constraint_scan/constraint_scan_results_blue.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>white_results <span class="op">=</span> pd.read_csv(<span class="st">"../outputs/constraint_scan/constraint_scan_results_white.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>scan_results <span class="op">=</span> pd.concat([white_results, blue_results])</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>scan_results <span class="op">=</span> scan_results.reset_index().drop(<span class="st">"index"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># remove solutions which were not feasible</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>infeasible_solutions <span class="op">=</span> scan_results[scan_results.isna().<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>feasible_solutions <span class="op">=</span> scan_results.dropna()</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>scan_results <span class="op">=</span> feasible_solutions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert any fluxes that are below 10^-6 to 0</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>scan_results <span class="op">=</span> scan_results.mask(<span class="bu">abs</span>(scan_results) <span class="op">&lt;</span> <span class="fl">0.000001</span>, other<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import constraints files</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>white_constraints <span class="op">=</span> pd.read_csv(<span class="st">"../outputs/constraint_scan/constraints_df.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>white_constraints[<span class="st">"light"</span>] <span class="op">=</span> <span class="st">"white"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>blue_constraints <span class="op">=</span> pd.read_csv(<span class="st">"../outputs/constraint_scan/constraints_df.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>blue_constraints[<span class="st">"light"</span>] <span class="op">=</span> <span class="st">"blue"</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>scan_constraints <span class="op">=</span> pd.concat([white_constraints, blue_constraints])</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>scan_constraints <span class="op">=</span> scan_constraints.reset_index().drop(<span class="st">"index"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># remove infeasible constraints combinations</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>feasible_scan_constraints <span class="op">=</span> scan_constraints.loc[feasible_solutions.index]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>infeasible_scan_constraints <span class="op">=</span> scan_constraints.loc[infeasible_solutions.index]</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>scan_constraints <span class="op">=</span> feasible_scan_constraints</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import constraints that were used in previous paper solutions</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>default_constraints <span class="op">=</span> pd.read_csv(<span class="st">"../inputs/arabidopsis_parameters.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)[<span class="st">"Value"</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>paper_constraints <span class="op">=</span> []</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> []</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> light <span class="kw">in</span> [<span class="st">"white"</span>, <span class="st">"blue"</span>, <span class="st">"nops"</span>]:</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> constraint <span class="kw">in</span> [<span class="st">"unconstrained"</span>, <span class="st">"constrained"</span>]:</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        constraints <span class="op">=</span> default_constraints.copy()</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> constraint <span class="op">==</span> <span class="st">"unconstrained"</span>:</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>            constraints[<span class="st">"ATPase"</span>] <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> constraint <span class="op">==</span> <span class="st">"constrained"</span>:</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>            constraints[<span class="st">"ATPase"</span>] <span class="op">=</span> <span class="fl">7.48</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        constraints[<span class="st">"light"</span>] <span class="op">=</span> light</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        index.append(<span class="ss">f"</span><span class="sc">{</span>light<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>constraint<span class="sc">}</span><span class="ss">_wt"</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        paper_constraints.append(constraints)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>paper_constraints <span class="op">=</span> pd.DataFrame(paper_constraints, index<span class="op">=</span>index)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>paper_constraints <span class="op">=</span> paper_constraints.iloc[<span class="dv">1</span>, :<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>paper_constraints</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>P_abs                  0.9
T_l                0.00017
A_l                    1.0
V_gc_ind               0.0
FqFm                   0.9
R_ch              0.069231
L_air                 0.37
L_epidermis           0.15
Vac_frac             0.751
T                   296.15
R                  0.08205
N_gcs          580000000.0
n                      2.5
m                      0.8
r                      0.0
s                      0.0
C_apo              0.02302
A_closed               1.6
A_open                2.75
ATPase                7.48
Name: white_constrained_wt, dtype: object</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import results for previous simulations in paper</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>paper_solution_files <span class="op">=</span> []</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> light <span class="kw">in</span> [<span class="st">"white"</span>, <span class="st">"blue"</span>, <span class="st">"nops"</span>]:</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> constraint <span class="kw">in</span> [<span class="st">"unconstrained"</span>, <span class="st">"constrained"</span>]:</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        paper_solution_files.append(<span class="ss">f"</span><span class="sc">{</span>light<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>constraint<span class="sc">}</span><span class="ss">_wt.csv"</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>solution_dfs <span class="op">=</span> [pd.read_csv(<span class="ss">f"../outputs/model_solutions/</span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss">"</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                            index_col<span class="op">=</span><span class="dv">0</span>)[<span class="st">"fluxes"</span>] <span class="cf">for</span> file_name <span class="kw">in</span> paper_solution_files]</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>paper_results <span class="op">=</span> pd.concat(solution_dfs, axis<span class="op">=</span><span class="dv">1</span>).T</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>paper_results.index <span class="op">=</span> index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get a reduced get of constraints that are more specific to the guard cell</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints <span class="op">=</span> pd.DataFrame.from_dict(<span class="bu">list</span>(scan_constraints.<span class="bu">apply</span>(get_bounds_in_model, axis<span class="op">=</span><span class="dv">1</span>)))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints[<span class="st">"Os_dif"</span>] <span class="op">=</span> scan_gc_constraints[<span class="st">"Os_open"</span>]<span class="op">-</span>scan_gc_constraints[<span class="st">"Os_closed"</span>]</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints.index <span class="op">=</span> scan_constraints.index</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/nls119/src/mmon-gcm2/mmon_gcm/supermodel.py:23: UserWarning: No fba model added to the Supermodel, fine if that's what you want
  warnings.warn("No fba model added to the Supermodel, fine if that's what you want")</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>V_closed</th>
      <th>V_open</th>
      <th>Os_closed</th>
      <th>Os_open</th>
      <th>Photons</th>
      <th>ATPase</th>
      <th>Os_dif</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000223</td>
      <td>0.000396</td>
      <td>0.043690</td>
      <td>0.146301</td>
      <td>0.179889</td>
      <td>0.000401</td>
      <td>0.102611</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.000352</td>
      <td>0.000513</td>
      <td>0.089882</td>
      <td>0.208754</td>
      <td>0.472789</td>
      <td>0.010845</td>
      <td>0.118871</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.000441</td>
      <td>0.000619</td>
      <td>0.107437</td>
      <td>0.225174</td>
      <td>0.473290</td>
      <td>0.001625</td>
      <td>0.117737</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000302</td>
      <td>0.000630</td>
      <td>0.064496</td>
      <td>0.347008</td>
      <td>0.509358</td>
      <td>0.001168</td>
      <td>0.282512</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.000096</td>
      <td>0.000290</td>
      <td>0.018519</td>
      <td>0.149224</td>
      <td>0.250117</td>
      <td>0.000062</td>
      <td>0.130705</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>paper_gc_constraints <span class="op">=</span> pd.Series(get_bounds_in_model(paper_constraints))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>paper_gc_constraints[<span class="st">"Os_dif"</span>] <span class="op">=</span> paper_gc_constraints[<span class="st">"Os_open"</span>]<span class="op">-</span>paper_gc_constraints[<span class="st">"Os_closed"</span>]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>paper_gc_constraints</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/nls119/src/mmon-gcm2/mmon_gcm/supermodel.py:23: UserWarning: No fba model added to the Supermodel, fine if that's what you want
  warnings.warn("No fba model added to the Supermodel, fine if that's what you want")</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>V_closed     0.000220
V_open       0.000254
Os_closed    0.039359
Os_open      0.054922
Photons      0.091641
ATPase       0.004338
Os_dif       0.015563
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="a---what-contributes-to-phloem-output" class="level2">
<h2 class="anchored" data-anchor-id="a---what-contributes-to-phloem-output">7a - What contributes to phloem output?</h2>
<section id="set-up-features-for-linear-regression-by" class="level3">
<h3 class="anchored" data-anchor-id="set-up-features-for-linear-regression-by">Set up features for linear regression by</h3>
<section id="convert-light-using-onehotencoder" class="level4">
<h4 class="anchored" data-anchor-id="convert-light-using-onehotencoder">Convert light using onehotencoder</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the subject column as a pandas DataFrame</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>light <span class="op">=</span> scan_constraints[[<span class="st">"light"</span>]]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># setting sparse=False means that enc.transform() will return an array</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>enc <span class="op">=</span> OneHotEncoder(sparse_output<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the encoder to the data</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>enc.fit(light)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># encode the data</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>light_enc <span class="op">=</span> enc.transform(light)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>light_columns <span class="op">=</span> pd.DataFrame(light_enc, columns<span class="op">=</span><span class="st">"light_"</span> <span class="op">+</span> enc.categories_[<span class="dv">0</span>])</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>full_features <span class="op">=</span> scan_constraints.drop(<span class="st">"light"</span>, axis<span class="op">=</span><span class="dv">1</span>).join(light_columns)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>gc_features <span class="op">=</span> scan_gc_constraints.join(light_columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="also-create-scaled-versions-of-features" class="level4">
<h4 class="anchored" data-anchor-id="also-create-scaled-versions-of-features">Also create scaled versions of features</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>scaler.fit(full_features)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>full_features_scaled <span class="op">=</span> scaler.transform(full_features)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>scaler.fit(gc_features)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>gc_features_scaled <span class="op">=</span> scaler.transform(gc_features)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="compare-full-and-gc-features" class="level3">
<h3 class="anchored" data-anchor-id="compare-full-and-gc-features">Compare full and gc features</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> scan_results.Phloem_tx_overall</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>lm_full <span class="op">=</span> LinearRegression()</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>lm_full.fit(full_features, response)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>full_pred <span class="op">=</span> lm_full.predict(full_features)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.5f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, full_pred))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.5f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, full_pred))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>lm_gc <span class="op">=</span> LinearRegression()</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>lm_gc.fit(gc_features, response)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>gc_pred <span class="op">=</span> lm_gc.predict(gc_features)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.5f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, gc_pred))</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.5f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, gc_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared error, MSE = 0.00041
Coefficient of determination, r2 = 0.99960
Mean squared error, MSE = 0.85966
Coefficient of determination, r2 = 0.15120</code></pre>
</div>
</div>
<p>So can’t predict phloem output using GC features, but can predict pretty well using the full set</p>
<section id="which-features-are-most-important" class="level4">
<h4 class="anchored" data-anchor-id="which-features-are-most-important">Which features are most important?</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(lm_full.coef_, index<span class="op">=</span>full_features.columns).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>T_l</th>
      <td>-7.716594e-01</td>
    </tr>
    <tr>
      <th>light_blue</th>
      <td>-3.504391e-01</td>
    </tr>
    <tr>
      <th>m</th>
      <td>-9.376244e-04</td>
    </tr>
    <tr>
      <th>A_open</th>
      <td>-1.647888e-04</td>
    </tr>
    <tr>
      <th>Vac_frac</th>
      <td>-1.228209e-04</td>
    </tr>
    <tr>
      <th>n</th>
      <td>-3.861555e-05</td>
    </tr>
    <tr>
      <th>FqFm</th>
      <td>-1.762768e-05</td>
    </tr>
    <tr>
      <th>V_gc_ind</th>
      <td>-9.025010e-10</td>
    </tr>
    <tr>
      <th>s</th>
      <td>-4.246077e-11</td>
    </tr>
    <tr>
      <th>N_gcs</th>
      <td>-1.013508e-12</td>
    </tr>
    <tr>
      <th>R</th>
      <td>-1.636531e-13</td>
    </tr>
    <tr>
      <th>A_l</th>
      <td>6.923333e-13</td>
    </tr>
    <tr>
      <th>r</th>
      <td>3.359222e-12</td>
    </tr>
    <tr>
      <th>T</th>
      <td>1.134554e-06</td>
    </tr>
    <tr>
      <th>ATPase</th>
      <td>6.590579e-06</td>
    </tr>
    <tr>
      <th>L_air</th>
      <td>1.577355e-05</td>
    </tr>
    <tr>
      <th>A_closed</th>
      <td>1.014129e-04</td>
    </tr>
    <tr>
      <th>L_epidermis</th>
      <td>1.088898e-04</td>
    </tr>
    <tr>
      <th>R_ch</th>
      <td>3.235657e-04</td>
    </tr>
    <tr>
      <th>C_apo</th>
      <td>1.648781e-03</td>
    </tr>
    <tr>
      <th>light_white</th>
      <td>3.504391e-01</td>
    </tr>
    <tr>
      <th>P_abs</th>
      <td>1.816986e+01</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Lots of unimportant features so we can use lasso regression to see which ones we really need</p>
</section>
<section id="try-different-alphas-for-lasso-to-see-r2" class="level4">
<h4 class="anchored" data-anchor-id="try-different-alphas-for-lasso-to-see-r2">Try different alphas for lasso to see r2</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Lasso</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> np.linspace(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">10</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>r2s <span class="op">=</span> []</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> alpha <span class="kw">in</span> alphas:</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    lasso <span class="op">=</span> Lasso(alpha<span class="op">=</span>alpha)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    lasso.fit(full_features, response)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>    lasso_pred <span class="op">=</span> lasso.predict(full_features)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    r2s.append(r2_score(response, lasso_pred))</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>pd.Series(r2s, index<span class="op">=</span>alphas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.01    0.962348
0.02    0.850602
0.03    0.664360
0.04    0.403621
0.05    0.118469
0.06    0.113857
0.07    0.108407
0.08    0.102119
0.09    0.094992
0.10    0.087026
dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Lasso</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> np.linspace(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="dv">10</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>r2s <span class="op">=</span> []</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> alpha <span class="kw">in</span> alphas:</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    lasso <span class="op">=</span> Lasso(alpha<span class="op">=</span>alpha)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    lasso.fit(full_features, response)</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    lasso_pred <span class="op">=</span> lasso.predict(full_features)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    r2s.append(r2_score(response, lasso_pred))</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>pd.Series(r2s, index<span class="op">=</span>alphas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.001    0.999224
0.002    0.998106
0.003    0.996244
0.004    0.993637
0.005    0.990284
0.006    0.986187
0.007    0.981345
0.008    0.975757
0.009    0.969425
0.010    0.962348
dtype: float64</code></pre>
</div>
</div>
<p>Lets take 0.03 as it’s highest that rounds to 0.999</p>
</section>
<section id="lasso-with-alpha-0.003" class="level4">
<h4 class="anchored" data-anchor-id="lasso-with-alpha-0.003">Lasso with alpha = 0.003</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>lasso <span class="op">=</span> Lasso(alpha<span class="op">=</span><span class="fl">0.003</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>lasso.fit(full_features, response)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>lasso_pred <span class="op">=</span> lasso.predict(full_features)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>lass_coefs <span class="op">=</span> pd.DataFrame(lasso.coef_, index<span class="op">=</span>full_features.columns).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># display coefficients that aren't 0</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>lass_coefs[<span class="bu">abs</span>(lass_coefs.loc[:, <span class="dv">0</span>]) <span class="op">&gt;</span> <span class="fl">0.00001</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>light_blue</th>
      <td>-0.688878</td>
    </tr>
    <tr>
      <th>A_open</th>
      <td>-0.001152</td>
    </tr>
    <tr>
      <th>ATPase</th>
      <td>-0.000150</td>
    </tr>
    <tr>
      <th>T</th>
      <td>0.000204</td>
    </tr>
    <tr>
      <th>P_abs</th>
      <td>17.048822</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>P_abs and light are by far the largest coefficients</p>
</section>
<section id="try-scaled-as-well" class="level4">
<h4 class="anchored" data-anchor-id="try-scaled-as-well">Try scaled as well</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Lasso</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>alphas <span class="op">=</span> np.linspace(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">10</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>r2s <span class="op">=</span> []</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> alpha <span class="kw">in</span> alphas:</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    lasso <span class="op">=</span> Lasso(alpha<span class="op">=</span>alpha)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    lasso.fit(full_features_scaled, response)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    lasso_pred <span class="op">=</span> lasso.predict(full_features_scaled)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    r2s.append(r2_score(response, lasso_pred))</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>pd.Series(r2s, index<span class="op">=</span>alphas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.01    0.999399
0.02    0.998806
0.03    0.997819
0.04    0.996437
0.05    0.994659
0.06    0.992487
0.07    0.989920
0.08    0.986958
0.09    0.983601
0.10    0.979849
dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>lasso <span class="op">=</span> Lasso(alpha<span class="op">=</span><span class="fl">0.01</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>lasso.fit(full_features_scaled, response)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>lasso_pred <span class="op">=</span> lasso.predict(full_features_scaled)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>lass_coefs <span class="op">=</span> pd.DataFrame(lasso.coef_, index<span class="op">=</span>full_features.columns).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"r2 score: </span><span class="sc">{</span>r2_score(response, lasso_pred)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co"># display coefficients that aren't 0</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>lass_coefs[<span class="bu">abs</span>(lass_coefs.loc[:, <span class="dv">0</span>]) <span class="op">&gt;</span> <span class="fl">0.00001</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>r2 score: 0.9993985733606163</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>light_blue</th>
      <td>-0.340439</td>
    </tr>
    <tr>
      <th>P_abs</th>
      <td>0.933180</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>When scaled this is even clearer</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> phloemoutput_subfig(ax):</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> light, colour <span class="kw">in</span> <span class="bu">zip</span>([<span class="st">"white"</span>, <span class="st">"blue"</span>], [sns.color_palette()[<span class="dv">1</span>], sns.color_palette()[<span class="dv">0</span>]]):</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>        constraints_light_df <span class="op">=</span> scan_constraints[scan_constraints.light <span class="op">==</span> light]</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        results_light_df <span class="op">=</span> scan_results[scan_constraints.light <span class="op">==</span> light]</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>        ax.scatter(constraints_light_df.P_abs, results_light_df.Phloem_tx_overall,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                   label<span class="op">=</span>light.capitalize(), color<span class="op">=</span>colour)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    ax.legend(title<span class="op">=</span><span class="st">"Light during opening"</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"$P_</span><span class="sc">{abs}</span><span class="st">$</span><span class="ch">\n</span><span class="st">(Prop. photons absorbed by leaf)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"Phloem output</span><span class="ch">\n</span><span class="st">(mmol$\cdot$m$^{-2}$leaf$\cdot$h$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="fl">13.9</span>, <span class="dv">19</span>)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(<span class="fl">0.797</span>, <span class="dv">1</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">'left'</span>].set_bounds(<span class="dv">14</span>, <span class="dv">19</span>)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">'bottom'</span>].set_bounds(<span class="fl">0.8</span>, <span class="dv">1</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_major_locator(MultipleLocator(<span class="fl">0.1</span>))</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax.xaxis.set_minor_locator(AutoMinorLocator(2))</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_major_locator(MultipleLocator(<span class="dv">1</span>))</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax.yaxis.set_minor_locator(AutoMinorLocator(2))</span></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>    ax.set_aspect(<span class="bu">abs</span>(<span class="dv">1</span><span class="op">-</span><span class="fl">0.8</span>)<span class="op">/</span><span class="bu">abs</span>(<span class="dv">19</span><span class="op">-</span><span class="dv">14</span>))</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ax</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>phloemoutput_subfig(ax)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: xlabel='$P_{abs}$\n(Prop. photons absorbed by leaf)', ylabel='Phloem output\n(mmol$\\cdot$m$^{-2}$leaf$\\cdot$h$^{-1}$)'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-22-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
</section>
<section id="b---what-affects-hexose-export-from-the-guard-cell" class="level2">
<h2 class="anchored" data-anchor-id="b---what-affects-hexose-export-from-the-guard-cell">7b - What affects hexose export from the guard cell?</h2>
<section id="generate-hexose-export-df" class="level3">
<h3 class="anchored" data-anchor-id="generate-hexose-export-df">Generate hexose export df</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>four_stage_GC_model <span class="op">=</span> cobra.io.sbml.read_sbml_model(<span class="st">"../models/4_stage_GC.xml"</span>)  <span class="co"># read model</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># get total flux across all phases</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>net_carbon_dict <span class="op">=</span> {}</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> metabolite <span class="kw">in</span> [<span class="st">"GLC"</span>, <span class="st">"FRU"</span>, <span class="st">"SUCROSE"</span>]:</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    net_metabolite <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, phase_length <span class="kw">in</span> <span class="bu">enumerate</span>(get_phase_lengths(four_stage_GC_model)):</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>        phase_number <span class="op">=</span> i<span class="op">+</span><span class="dv">1</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>        net_metabolite <span class="op">=</span> net_metabolite <span class="op">+</span> <span class="op">\</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>            scan_results.loc[:, <span class="ss">f"</span><span class="sc">{</span>metabolite<span class="sc">}</span><span class="ss">_ae_gc_</span><span class="sc">{</span>phase_number<span class="sc">}</span><span class="ss">"</span>]<span class="op">*</span>phase_length</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    net_carbon_dict[metabolite] <span class="op">=</span> net_metabolite</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>net_carbon_df <span class="op">=</span> pd.DataFrame.from_dict(net_carbon_dict)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="co"># correct for fact that sucrose is two hexoses</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>net_carbon <span class="op">=</span> (net_carbon_df.GLC <span class="op">+</span> net_carbon_df.FRU <span class="op">+</span> net_carbon_df.SUCROSE<span class="op">*</span><span class="dv">2</span>) <span class="op">*</span> <span class="op">-</span><span class="dv">1</span>  <span class="co"># mmol.m2-1</span></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>net_carbon <span class="op">=</span> net_carbon <span class="op">*</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">3</span>  <span class="co"># moles.m2-1</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>carbon_per_gc <span class="op">=</span> net_carbon <span class="op">/</span> scan_constraints.N_gcs  <span class="co"># moles.gc-1</span></span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>carbon_per_gc <span class="op">=</span> carbon_per_gc <span class="op">*</span> <span class="dv">10</span><span class="op">**</span><span class="dv">15</span>  <span class="co"># fmol.gc-1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No objective coefficients in model. Unclear what should be optimized</code></pre>
</div>
</div>
</section>
<section id="fit-model-to-hexose-export" class="level3">
<h3 class="anchored" data-anchor-id="fit-model-to-hexose-export">Fit model to hexose export</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> carbon_per_gc</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> features <span class="kw">in</span> [full_features, gc_features]:</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    lm_1 <span class="op">=</span> LinearRegression()</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    lm_1.fit(features, response)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    pred <span class="op">=</span> lm_1.predict(features)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.2f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, pred))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.2f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared error, MSE = 9919.47
Coefficient of determination, r2 = 0.41
Mean squared error, MSE = 3274.79
Coefficient of determination, r2 = 0.80</code></pre>
</div>
</div>
<p>So hexose export can be better predicted using the gc features compared to all the features. Is this because it’s hexose per gc?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> net_carbon</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> features <span class="kw">in</span> [full_features, gc_features]:</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    lm_1 <span class="op">=</span> LinearRegression()</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    lm_1.fit(features, response)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    pred <span class="op">=</span> lm_1.predict(features)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.2f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, pred))</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.2f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared error, MSE = 0.00
Coefficient of determination, r2 = 0.51
Mean squared error, MSE = 0.00
Coefficient of determination, r2 = 1.00</code></pre>
</div>
</div>
<p>Seems so, as we’re confusing things by introducing the N_gcs division into the response</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> net_carbon</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="op">=</span> LinearRegression()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>lm_1.fit(gc_features, response)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> lm_1.predict(gc_features)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>lm_coefs <span class="op">=</span> pd.DataFrame(lm_1.coef_, index<span class="op">=</span>gc_features.columns).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>lm_coefs[<span class="bu">abs</span>(lm_coefs.loc[:, <span class="dv">0</span>]) <span class="op">&gt;</span> <span class="fl">0.00001</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>V_closed</th>
      <td>-0.009206</td>
    </tr>
    <tr>
      <th>Os_dif</th>
      <td>-0.000030</td>
    </tr>
    <tr>
      <th>Os_closed</th>
      <td>0.000025</td>
    </tr>
    <tr>
      <th>ATPase</th>
      <td>0.000059</td>
    </tr>
    <tr>
      <th>Photons</th>
      <td>0.000233</td>
    </tr>
    <tr>
      <th>V_open</th>
      <td>0.003493</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Mainly different light colours as well as osmolarity. What if we correct for light colour?</p>
</section>
<section id="create-a-reponse-for-total-photons-into-the-gc-irrespective-of-blue-or-white-light" class="level3">
<h3 class="anchored" data-anchor-id="create-a-reponse-for-total-photons-into-the-gc-irrespective-of-blue-or-white-light">Create a reponse for total photons into the GC, irrespective of blue or white light</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>photon_influx <span class="op">=</span> scan_results.loc[:, <span class="st">"Photon_tx_gc_3"</span>]</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>photon_hours <span class="op">=</span> scan_constraints.loc[:, <span class="st">"light"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">12</span> <span class="cf">if</span> x <span class="op">==</span> <span class="st">"white"</span> <span class="cf">else</span> <span class="fl">11.5</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>total_photons_per_day <span class="op">=</span> photon_influx <span class="op">*</span> photon_hours</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> net_carbon</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> np.array([total_photons_per_day]).T</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="op">=</span> LinearRegression()</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>lm_1.fit(features, response)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> lm_1.predict(features)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, pred))</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, pred))</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(lm_1.coef_, index<span class="op">=</span>[<span class="st">"Photons per day"</span>]).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared error, MSE = 0.000000
Coefficient of determination, r2 = 0.999035</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Photons per day</th>
      <td>0.00002</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> net_carbon</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> np.array([total_photons_per_day, gc_features.Os_dif]).T</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="op">=</span> LinearRegression()</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>lm_1.fit(features, response)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> lm_1.predict(features)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, pred))</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, pred))</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(lm_1.coef_, index<span class="op">=</span>[<span class="st">"Photons per day"</span>, <span class="st">"Os dif"</span>]).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared error, MSE = 0.000000
Coefficient of determination, r2 = 0.999911</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Os dif</th>
      <td>-0.00003</td>
    </tr>
    <tr>
      <th>Photons per day</th>
      <td>0.00002</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Pretty good R2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> net_carbon</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> np.array(gc_features.ATPase).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="op">=</span> LinearRegression()</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>lm_1.fit(features, response)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> lm_1.predict(features)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, pred))</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, pred))</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(lm_1.coef_, index<span class="op">=</span>[<span class="st">"ATPase"</span>]).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared error, MSE = 0.000000
Coefficient of determination, r2 = 0.075506</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ATPase</th>
      <td>0.00689</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>ATPase can’t really predict hexose export, at least not by itself</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> photons_vs_carbon_export_subfig(ax):</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    max_os_dif <span class="op">=</span> scan_gc_constraints.Os_dif.<span class="bu">max</span>().<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    norm <span class="op">=</span> Normalize(vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span>max_os_dif)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    mappable <span class="op">=</span> ScalarMappable(norm<span class="op">=</span>norm, cmap<span class="op">=</span>sns.color_palette(<span class="st">"crest"</span>, as_cmap<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    net_carbon_mmol <span class="op">=</span> net_carbon <span class="op">*</span> <span class="dv">10</span> <span class="op">**</span> <span class="dv">3</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    ax.scatter(total_photons_per_day, net_carbon_mmol, c<span class="op">=</span>scan_gc_constraints.Os_dif,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>               norm<span class="op">=</span>norm, s<span class="op">=</span><span class="dv">10</span>, cmap<span class="op">=</span>sns.color_palette(<span class="st">"crest"</span>, as_cmap<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    cbaxes <span class="op">=</span> ax.inset_axes([<span class="fl">0.1</span>, <span class="fl">0.93</span>, <span class="fl">0.40</span>, <span class="fl">0.05</span>])</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    cbar <span class="op">=</span> plt.colorbar(mappable, cax<span class="op">=</span>cbaxes, ticks<span class="op">=</span>[<span class="dv">0</span>, max_os_dif], orientation<span class="op">=</span><span class="st">'horizontal'</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    cbar.set_label(<span class="st">"Osmolarity increase</span><span class="ch">\n</span><span class="st">(mmol$\cdot$m$^{-2}\cdot$d$^{-1}$)"</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>    inset_ax <span class="op">=</span> ax.inset_axes([<span class="fl">0.7</span>, <span class="fl">0.15</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>])</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    inset_ax.scatter(total_photons_per_day, net_carbon_mmol, c<span class="op">=</span>scan_gc_constraints.Os_dif,</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>                     s<span class="op">=</span><span class="dv">1</span>, cmap<span class="op">=</span>sns.color_palette(<span class="st">"crest"</span>, as_cmap<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    inset_ax.set_xlim([<span class="op">-</span><span class="fl">0.3</span><span class="op">/</span><span class="dv">10</span>, <span class="dv">2</span>])</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    inset_ax.set_ylim([<span class="op">-</span><span class="fl">0.02</span><span class="op">/</span><span class="dv">5</span>, <span class="fl">0.04</span>])</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>    inset_ax.tick_params(labelsize<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    inset_ax.spines[<span class="st">'left'</span>].set_bounds(<span class="dv">0</span>, <span class="fl">0.04</span>)</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    inset_ax.spines[<span class="st">'bottom'</span>].set_bounds(<span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>    inset_ax.yaxis.set_major_locator(MultipleLocator(<span class="fl">0.04</span>))</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>    inset_ax.yaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    inset_ax.xaxis.set_major_locator(MultipleLocator(<span class="dv">2</span>))</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    inset_ax.xaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim([<span class="op">-</span><span class="fl">0.5</span>, <span class="dv">40</span>])</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim([<span class="op">-</span><span class="fl">0.02</span>, <span class="fl">0.75</span>])</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">'left'</span>].set_bounds(<span class="dv">0</span>, <span class="fl">0.75</span>)</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">'bottom'</span>].set_bounds(<span class="dv">0</span>, <span class="dv">40</span>)</span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_major_locator(MultipleLocator(<span class="dv">20</span>))</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_major_locator(MultipleLocator(<span class="fl">0.25</span>))</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>    ax.set_aspect(<span class="bu">abs</span>(<span class="dv">40</span><span class="op">-</span><span class="dv">0</span>)<span class="op">/</span><span class="bu">abs</span>(<span class="fl">0.75</span><span class="op">-</span><span class="dv">0</span>))</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Photons per day into GC</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="vs">r"(mmol$\cdot$m$^{-2}\cdot$d$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"Net hexose export flux from GC</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="vs">r"(mmol$\cdot$m$^{-2}\cdot$h$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ax</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>photons_vs_carbon_export_subfig(ax)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: xlabel='Photons per day into GC\n(mmol$\\cdot$m$^{-2}\\cdot$d$^{-1}$)', ylabel='Net hexose export flux from GC\n(mmol$\\cdot$m$^{-2}\\cdot$h$^{-1}$)'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-31-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="are-there-any-solutions-that-are-below-0" class="level3">
<h3 class="anchored" data-anchor-id="are-there-any-solutions-that-are-below-0">Are there any solutions that are below 0?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>(net_carbon <span class="op">&lt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>2</code></pre>
</div>
</div>
<p>What’s interesting about them?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>scan_constraints.loc[net_carbon <span class="op">&lt;</span> <span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>P_abs</th>
      <th>T_l</th>
      <th>A_l</th>
      <th>V_gc_ind</th>
      <th>FqFm</th>
      <th>R_ch</th>
      <th>L_air</th>
      <th>L_epidermis</th>
      <th>Vac_frac</th>
      <th>T</th>
      <th>...</th>
      <th>N_gcs</th>
      <th>n</th>
      <th>m</th>
      <th>r</th>
      <th>s</th>
      <th>C_apo</th>
      <th>A_closed</th>
      <th>A_open</th>
      <th>ATPase</th>
      <th>light</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>180</th>
      <td>0.905621</td>
      <td>0.000238</td>
      <td>1.0</td>
      <td>5.504346e-13</td>
      <td>0.851331</td>
      <td>0.042463</td>
      <td>0.229569</td>
      <td>0.166053</td>
      <td>0.804005</td>
      <td>297.456238</td>
      <td>...</td>
      <td>6.273035e+08</td>
      <td>1.96254</td>
      <td>0.80448</td>
      <td>6.905245e-14</td>
      <td>1.886476e-13</td>
      <td>0.028729</td>
      <td>1.953838</td>
      <td>11.38203</td>
      <td>8.971524</td>
      <td>white</td>
    </tr>
    <tr>
      <th>1152</th>
      <td>0.905621</td>
      <td>0.000238</td>
      <td>1.0</td>
      <td>5.504346e-13</td>
      <td>0.851331</td>
      <td>0.042463</td>
      <td>0.229569</td>
      <td>0.166053</td>
      <td>0.804005</td>
      <td>297.456238</td>
      <td>...</td>
      <td>6.273035e+08</td>
      <td>1.96254</td>
      <td>0.80448</td>
      <td>6.905245e-14</td>
      <td>1.886476e-13</td>
      <td>0.028729</td>
      <td>1.953838</td>
      <td>11.38203</td>
      <td>8.971524</td>
      <td>blue</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints.loc[net_carbon <span class="op">&lt;</span> <span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>V_closed</th>
      <th>V_open</th>
      <th>Os_closed</th>
      <th>Os_open</th>
      <th>Photons</th>
      <th>ATPase</th>
      <th>Os_dif</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>180</th>
      <td>0.000203</td>
      <td>0.000611</td>
      <td>0.035224</td>
      <td>0.296097</td>
      <td>0.039867</td>
      <td>0.005628</td>
      <td>0.260872</td>
    </tr>
    <tr>
      <th>1152</th>
      <td>0.000203</td>
      <td>0.000611</td>
      <td>0.035224</td>
      <td>0.296097</td>
      <td>0.039867</td>
      <td>0.005628</td>
      <td>0.260872</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Ok they are the same just with different light colours. Is it the photon/od_dif ratio?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints.loc[<span class="dv">180</span>, <span class="st">"Photons"</span>] <span class="op">/</span> scan_gc_constraints.loc[<span class="dv">180</span>, <span class="st">"Os_dif"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.15282224853377138</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>(scan_gc_constraints.loc[:, <span class="st">"Photons"</span>]<span class="op">/</span>scan_gc_constraints.loc[:, <span class="st">"Os_dif"</span>]).<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.15282224853377138</code></pre>
</div>
</div>
<p>Yes, it has the lowest photon:od_diff ratio of any combination</p>
</section>
</section>
<section id="at-our-predicted-level-of-osmolarity-and-other-guard-cell-parameters-what-would-fqfm.r_ch-need-to-be-for-guard-cell-to-act-as-a-sink" class="level2">
<h2 class="anchored" data-anchor-id="at-our-predicted-level-of-osmolarity-and-other-guard-cell-parameters-what-would-fqfm.r_ch-need-to-be-for-guard-cell-to-act-as-a-sink">At our predicted level of osmolarity and other guard cell parameters, what would FqFm.R_ch need to be for guard cell to act as a sink?</h2>
<p><span class="math inline">\(e = FqFm \cdot R_{ch}\)</span> &lt;- We want to know e, that is the capacity of guard cell vs mesophyll. Function of efficiency and number of chloroplasts</p>
<p><span class="math inline">\(P_{gc} = e \cdot v\_prop_{gc} \cdot P\)</span></p>
<p><span class="math inline">\(e = \frac{P_{gc}}{v\_prop_{gc} \cdot P}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> <span class="dv">150</span> <span class="op">*</span> paper_constraints.P_abs</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>P <span class="op">=</span> P <span class="op">*</span> <span class="dv">10</span> <span class="op">**</span> <span class="op">-</span><span class="dv">3</span> <span class="op">*</span> <span class="dv">60</span> <span class="op">*</span> <span class="dv">60</span>  <span class="co"># umolessec-1 -&gt; mmolhr-1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>V_l <span class="op">=</span> paper_constraints.T_l <span class="op">*</span> paper_constraints.A_l  <span class="co"># volume of leaf is area x thickness</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>V_l <span class="op">=</span> V_l <span class="op">*</span> <span class="dv">10</span> <span class="op">**</span> <span class="dv">3</span>  <span class="co"># (Total leaf volume) m3 -&gt; dm3 = 10**3</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>V_gc <span class="op">=</span> paper_constraints.V_gc_ind <span class="op">*</span> paper_constraints.N_gcs  <span class="co"># total volume of gc in leaf</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="co"># volume of meosphyll is leaf that isn't epidermis or air</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>V_me <span class="op">=</span> V_l <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> paper_constraints.L_epidermis) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> paper_constraints.L_air)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>v_prop_gc <span class="op">=</span> V_gc <span class="op">/</span> V_me  <span class="co"># volume of gc is negligable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> net_carbon</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> np.array([total_photons_per_day, gc_features.Os_dif]).T</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>lm_1 <span class="op">=</span> LinearRegression()</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>lm_1.fit(features, response)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>pred <span class="op">=</span> lm_1.predict(features)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean squared error, MSE = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> mean_squared_error(response, pred))</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coefficient of determination, r2 = </span><span class="sc">%.6f</span><span class="st">"</span> <span class="op">%</span> r2_score(response, pred))</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Intercept: </span><span class="sc">{</span>lm_1<span class="sc">.</span>intercept_<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(lm_1.coef_, index<span class="op">=</span>[<span class="st">"Photons per day"</span>, <span class="st">"Os dif"</span>]).sort_values(by<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean squared error, MSE = 0.000000
Coefficient of determination, r2 = 0.999911
Intercept: -6.79617736739377e-08</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Os dif</th>
      <td>-0.00003</td>
    </tr>
    <tr>
      <th>Photons per day</th>
      <td>0.00002</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>$ C_{net} = -3^{-5}Os_{dif} + 2^{-5}P_{day} - 6.80 ^{-8}$</p>
<p>$ 0 = -3^{-5} + 2^{-5}P_{day} - 6.80 ^{-8}$</p>
<p>$ = P_{day}$</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>os_dif_coef <span class="op">=</span> lm_1.coef_[<span class="dv">1</span>]</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>photons_per_day_coef <span class="op">=</span> lm_1.coef_[<span class="dv">0</span>]</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>os_in_selected_scenarios <span class="op">=</span> paper_gc_constraints.Os_dif</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>intercept <span class="op">=</span> lm_1.intercept_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>photons_needed <span class="op">=</span> (intercept <span class="op">-</span> os_dif_coef<span class="op">*</span>os_in_selected_scenarios)<span class="op">/</span>photons_per_day_coef</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>photons_needed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.020218242888203602</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>total_photons_per_day.<span class="bu">min</span>()<span class="op">/</span>photons_needed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>14.958540346092619</code></pre>
</div>
</div>
<p>So at that osmolarity for the guard cell to act as sink tissue the total level of photons coming in would have to be 15x lower than we see in any of our scenarios, which will be for blue light</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>photon_influx <span class="op">=</span> photons_needed<span class="op">/</span><span class="fl">11.5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><span class="math inline">\(e = \frac{P_{gc}}{v\_prop_{gc} \cdot P}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>e <span class="op">=</span> photon_influx<span class="op">/</span>(v_prop_gc<span class="op">*</span>P)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>e<span class="op">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.11953527728193179</code></pre>
</div>
</div>
<p>So the capacity for photosynthesis in the guard cell only needs to be 0.1% of that of the mesophyll to act as a source tissue</p>
<section id="what-is-the-range-of-photosynthetic-capacities-that-we-use" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-range-of-photosynthetic-capacities-that-we-use">What is the range of photosynthetic capacities that we use?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>capacity_percentages <span class="op">=</span> (scan_constraints.FqFm <span class="op">*</span> scan_constraints.R_ch)<span class="op">*</span><span class="dv">100</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"High: </span><span class="sc">{</span>capacity_percentages<span class="sc">.</span><span class="bu">max</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Low: </span><span class="sc">{</span>capacity_percentages<span class="sc">.</span><span class="bu">min</span>()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>High: 16.398489377751467
Low: 2.8086635016180743</code></pre>
</div>
</div>
</section>
</section>
<section id="c---so-does-the-atpase-have-an-effect-on-starch-if-not-on-hexose-export-very-much" class="level2">
<h2 class="anchored" data-anchor-id="c---so-does-the-atpase-have-an-effect-on-starch-if-not-on-hexose-export-very-much">7c - So does the ATPase have an effect on starch if not on hexose export very much?</h2>
<section id="how-many-solutions-utilise-starch" class="level3">
<h3 class="anchored" data-anchor-id="how-many-solutions-utilise-starch">How many solutions utilise starch?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>starch <span class="op">=</span> scan_results.STARCH_p_gc_Linker_1 <span class="op">-</span> scan_results.STARCH_p_gc_Linker_2</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>(starch <span class="op">&gt;</span> <span class="dv">0</span>)<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss"> or </span><span class="sc">{</span>(starch <span class="op">&gt;</span> <span class="dv">0</span>)<span class="sc">.</span><span class="bu">sum</span>()<span class="op">/</span><span class="bu">len</span>(starch) <span class="op">*</span> <span class="dv">100</span><span class="sc">:.0f}</span><span class="ss">%"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1891 or 97%</code></pre>
</div>
</div>
</section>
</section>
<section id="in-how-many-of-those-solutions-is-the-atpase-constrained" class="level2">
<h2 class="anchored" data-anchor-id="in-how-many-of-those-solutions-is-the-atpase-constrained">In how many of those solutions is the ATPase constrained?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>atpase_constrained <span class="op">=</span> (<span class="bu">abs</span>(scan_gc_constraints.ATPase<span class="op">-</span>scan_results.PROTON_ATPase_c_gc_2) <span class="op">&lt;</span> <span class="fl">0.000001</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>(atpase_constrained <span class="op">&amp;</span> starch <span class="op">&gt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1890</code></pre>
</div>
</div>
<p>So there is one solution which doesn’t</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints[(<span class="op">~</span>atpase_constrained <span class="op">&amp;</span> starch <span class="op">&gt;</span> <span class="dv">0</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>V_closed</th>
      <th>V_open</th>
      <th>Os_closed</th>
      <th>Os_open</th>
      <th>Photons</th>
      <th>ATPase</th>
      <th>Os_dif</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1685</th>
      <td>0.000254</td>
      <td>0.000316</td>
      <td>0.050405</td>
      <td>0.075048</td>
      <td>1.393555</td>
      <td>0.01318</td>
      <td>0.024642</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>(scan_gc_constraints.loc[<span class="dv">1685</span>] <span class="op">-</span> scan_gc_constraints.mean())<span class="op">/</span>scan_gc_constraints.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>V_closed     0.111731
V_open      -0.602100
Os_closed   -0.024406
Os_open     -0.918384
Photons      1.760322
ATPase       1.728109
Os_dif      -1.023596
dtype: float64</code></pre>
</div>
</div>
<p>High photons, high ATPase, low osmolarity dif</p>
</section>
<section id="how-many-constrained-solutions-dont-use-starch" class="level2">
<h2 class="anchored" data-anchor-id="how-many-constrained-solutions-dont-use-starch">How many constrained solutions don’t use starch?</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>(atpase_constrained <span class="op">&amp;</span> (starch <span class="op">==</span> <span class="dv">0</span>)).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>scan_gc_constraints[(atpase_constrained <span class="op">&amp;</span> (starch <span class="op">==</span> <span class="dv">0</span>))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>V_closed</th>
      <th>V_open</th>
      <th>Os_closed</th>
      <th>Os_open</th>
      <th>Photons</th>
      <th>ATPase</th>
      <th>Os_dif</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1315</th>
      <td>0.000356</td>
      <td>0.000376</td>
      <td>0.073848</td>
      <td>0.082492</td>
      <td>0.806864</td>
      <td>0.004604</td>
      <td>0.008644</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>(scan_gc_constraints.loc[<span class="dv">1315</span>] <span class="op">-</span> scan_gc_constraints.mean())<span class="op">/</span>scan_gc_constraints.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>V_closed     0.970232
V_open      -0.337247
Os_closed    0.787662
Os_open     -0.858245
Photons      0.509296
ATPase      -0.255409
Os_dif      -1.168544
dtype: float64</code></pre>
</div>
</div>
<p>Osmolarity difference is low, photons are high, atpase is low. Closed osmolarity is high, forcing the use of something else?</p>
<p>Increase per GC allows comparison with literature values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>starch_per_gc <span class="op">=</span> starch <span class="op">*</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">3</span> <span class="op">/</span> scan_constraints.N_gcs <span class="op">*</span> <span class="dv">10</span><span class="op">**</span><span class="dv">15</span>  <span class="co"># fmol.gc-1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>horrer_starch_level <span class="op">=</span> <span class="dv">184</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>os_increase_per_gc <span class="op">=</span> scan_gc_constraints.Os_dif <span class="op">*</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">3</span> <span class="op">/</span> scan_constraints.N_gcs <span class="op">*</span> <span class="dv">10</span><span class="op">**</span><span class="dv">15</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>protons_moved_per_gc <span class="op">=</span> scan_results.PROTON_ATPase_c_gc_2 <span class="op">*</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">3</span> <span class="op">/</span> scan_constraints.N_gcs <span class="op">*</span> <span class="dv">10</span><span class="op">**</span><span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>protons_moved_per_gc.<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>16.995468262384303</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> starch_vs_os_subfig(ax):</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>    dot_size <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>    norm <span class="op">=</span> Normalize(vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">15</span>)</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>    mappable <span class="op">=</span> ScalarMappable(norm<span class="op">=</span>norm, cmap<span class="op">=</span>sns.color_palette(<span class="st">"crest"</span>, as_cmap<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    ax.plot([<span class="dv">0</span>, <span class="dv">600</span>], [<span class="dv">0</span>, <span class="dv">600</span>], c<span class="op">=</span><span class="st">"grey"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, clip_on<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>    sc <span class="op">=</span> ax.scatter(os_increase_per_gc, starch_per_gc, s<span class="op">=</span>dot_size, c<span class="op">=</span>protons_moved_per_gc,</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>                    norm<span class="op">=</span>norm, cmap<span class="op">=</span>sns.color_palette(<span class="st">"crest"</span>, as_cmap<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>    cbaxes <span class="op">=</span> ax.inset_axes([<span class="fl">0.15</span>, <span class="fl">0.93</span>, <span class="fl">0.40</span>, <span class="fl">0.05</span>])</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>    cbar <span class="op">=</span> plt.colorbar(mappable, cax<span class="op">=</span>cbaxes, ticks<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">15</span>], orientation<span class="op">=</span><span class="st">'horizontal'</span>)</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>    cbar.set_label(<span class="st">"Total H$^+$ export</span><span class="ch">\n</span><span class="st">(fmol$\cdot$GC$^{-1}$)"</span>, size<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>    y_max <span class="op">=</span> <span class="dv">600</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>    y_min <span class="op">=</span> <span class="op">-</span><span class="dv">20</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>    x_max <span class="op">=</span> <span class="dv">600</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>    x_min <span class="op">=</span> <span class="op">-</span><span class="dv">20</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(y_min, y_max)</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(x_min, x_max)</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">'left'</span>].set_bounds(<span class="dv">0</span>, y_max)</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">'bottom'</span>].set_bounds(<span class="dv">0</span>, x_max)</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_major_locator(MultipleLocator(<span class="dv">200</span>))</span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_major_locator(MultipleLocator(<span class="dv">200</span>))</span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>    ax.set_aspect(<span class="dv">1</span>)</span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Osmolarity increase (fmol$\cdot$GC$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="vs">r"Starch degradation (fmol$\cdot$GC$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ax.hlines(-155, xmin=0.15, xmax=0.99, clip_on=False, linewidth=1, color='.15')</span></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>    ax.hlines(<span class="dv">184</span>, xmin<span class="op">=</span><span class="dv">0</span>, xmax<span class="op">=</span>x_max, linewidth<span class="op">=</span><span class="dv">1</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, color<span class="op">=</span>sns.color_palette()[<span class="dv">6</span>])</span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a>    ax.text(x_max, <span class="dv">175</span>, <span class="st">"Horrer et al. (2016)"</span>, ha<span class="op">=</span><span class="st">"right"</span>, va<span class="op">=</span><span class="st">"top"</span>, size<span class="op">=</span><span class="st">"x-small"</span>, color<span class="op">=</span>sns.color_palette()[<span class="dv">6</span>])</span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a>    paper_scenarios_colour <span class="op">=</span> sns.color_palette()[<span class="dv">2</span>]</span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a>    ax.vlines(<span class="fl">26.83</span>, ymin<span class="op">=</span><span class="dv">0</span>, ymax<span class="op">=</span><span class="dv">110</span>, linewidth<span class="op">=</span><span class="dv">1</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, color<span class="op">=</span>paper_scenarios_colour)</span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a>    ax.text(<span class="dv">50</span>, <span class="dv">120</span>, <span class="st">"Paper</span><span class="ch">\n</span><span class="st">scenarios"</span>, ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"bottom"</span>, size<span class="op">=</span><span class="st">"x-small"</span>, color<span class="op">=</span>paper_scenarios_colour)</span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ax</span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-43"><a href="#cb86-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-44"><a href="#cb86-44" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb86-45"><a href="#cb86-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-46"><a href="#cb86-46" aria-hidden="true" tabindex="-1"></a>starch_vs_os_subfig(ax)</span>
<span id="cb86-47"><a href="#cb86-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-48"><a href="#cb86-48" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/constraint_scan/atpase_vs_starch.svg"</span>)</span>
<span id="cb86-49"><a href="#cb86-49" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/constraint_scan/atpase_vs_starch.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-57-output-1.png" class="img-fluid"></p>
</div>
</div>
<section id="how-do-starch-levels-vary-with-whiteblue-light" class="level3">
<h3 class="anchored" data-anchor-id="how-do-starch-levels-vary-with-whiteblue-light">How do starch levels vary with white/blue light?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>blue_higher <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>white_higher <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>same_starch <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>len_light <span class="op">=</span> <span class="bu">int</span>(<span class="bu">len</span>(scan_constraints)<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(len_light):</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> os_increase_per_gc[i]</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    y_white <span class="op">=</span> starch_per_gc[i]</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    y_blue <span class="op">=</span> starch_per_gc[i<span class="op">+</span>len_light]</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> y_blue <span class="op">&gt;</span> y_white:  <span class="co"># blue higher</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>        colour <span class="op">=</span> colours[<span class="dv">0</span>]</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>        blue_higher <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> y_blue <span class="op">&lt;</span> y_white:</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>        colour <span class="op">=</span> colours[<span class="dv">1</span>]</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>        white_higher <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>        same_starch <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>        colour <span class="op">=</span> <span class="st">"black"</span></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>    ax.arrow(x, y_white, <span class="dv">0</span>, y_blue<span class="op">-</span>y_white, color<span class="op">=</span>colour, length_includes_head<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>             width<span class="op">=</span><span class="dv">4</span>, head_width<span class="op">=</span><span class="dv">10</span>, head_length<span class="op">=</span><span class="dv">4</span>, linewidth<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-58-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Blue higher: </span><span class="sc">{</span>blue_higher<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"White higher: </span><span class="sc">{</span>white_higher<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Same starch: </span><span class="sc">{</span>same_starch<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Blue higher: 949
White higher: 0
Same starch: 23</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>starch_differences <span class="op">=</span> ((scan_results[scan_constraints.light <span class="op">==</span> <span class="st">"blue"</span>].reset_index()) <span class="op">-</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>                      (scan_results[scan_constraints.light <span class="op">==</span> <span class="st">"white"</span>].reset_index())).STARCH_p_gc_Linker_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>(starch_differences <span class="op">&gt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>949</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>scan_results[scan_constraints.light <span class="op">==</span> <span class="st">"blue"</span>].reset_index()[(starch_differences <span class="op">==</span> <span class="dv">0</span>)].STARCH_p_gc_Linker_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>10     0.0
38     0.0
80     0.0
104    0.0
126    0.0
128    0.0
150    0.0
231    0.0
239    0.0
280    0.0
292    0.0
313    0.0
343    0.0
374    0.0
438    0.0
453    0.0
531    0.0
612    0.0
674    0.0
853    0.0
876    0.0
905    0.0
922    0.0
Name: STARCH_p_gc_Linker_1, dtype: float64</code></pre>
</div>
</div>
<p>Starch is only equal when it’s 0</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>high_starch <span class="op">=</span> scan_results[starch_per_gc <span class="op">&gt;</span> horrer_starch_level]</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(high_starch))</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(((scan_constraints.loc[high_starch.index, <span class="st">"light"</span>]</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>      <span class="op">==</span> <span class="st">"white"</span>).<span class="bu">sum</span>()<span class="op">/</span>(<span class="bu">len</span>(scan_results)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">0</span>))</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(((scan_constraints.loc[high_starch.index, <span class="st">"light"</span>]</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>      <span class="op">==</span> <span class="st">"blue"</span>).<span class="bu">sum</span>()<span class="op">/</span>(<span class="bu">len</span>(scan_results)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>840
43.0
44.0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>selected_scenarios_max_starch <span class="op">=</span> (</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    paper_results.loc[:, <span class="st">"STARCH_p_gc_Linker_1"</span>]<span class="op">-</span>paper_results.loc[:, <span class="st">"STARCH_p_gc_Linker_2"</span>]).<span class="bu">max</span>()</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>selected_scenarios_max_starch <span class="op">=</span> selected_scenarios_max_starch <span class="op">*</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">3</span> <span class="op">/</span> paper_constraints.N_gcs <span class="op">*</span> <span class="dv">10</span><span class="op">**</span><span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>higher_than_scenarios_starch <span class="op">=</span> scan_results[starch_per_gc <span class="op">&gt;</span> selected_scenarios_max_starch]</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(higher_than_scenarios_starch))</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(((scan_constraints.loc[higher_than_scenarios_starch.index, <span class="st">"light"</span>]</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>      <span class="op">==</span> <span class="st">"white"</span>).<span class="bu">sum</span>()<span class="op">/</span>(<span class="bu">len</span>(scan_results)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">0</span>))</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(((scan_constraints.loc[higher_than_scenarios_starch.index, <span class="st">"light"</span>]</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>      <span class="op">==</span> <span class="st">"blue"</span>).<span class="bu">sum</span>()<span class="op">/</span>(<span class="bu">len</span>(scan_results)<span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1824
93.0
95.0</code></pre>
</div>
</div>
</section>
</section>
<section id="how-is-starch-used" class="level2">
<h2 class="anchored" data-anchor-id="how-is-starch-used">How is starch used?</h2>
<p>What proportion of white light solutions that degrade starch use it for osmoticum?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>(((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"white"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (scan_results.RXN_2141_p_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>()) <span class="op">/</span> <span class="op">\</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    ((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"white"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>()<span class="op">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>100.0</code></pre>
</div>
</div>
<p>What proportion of white light solutions that degrade starch use it for energy?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>(((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"white"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  ).<span class="bu">sum</span>())<span class="op">/</span>((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"white"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>()<span class="op">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>2.8662420382165608</code></pre>
</div>
</div>
<p>In the solutions that use it for energy, what is the average % used for energy?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>(((scan_results[(((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"white"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)))].MALTODEG_RXN_c_gc_2) <span class="op">/</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a> starch[((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"white"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>))]) <span class="op">*</span> <span class="dv">100</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>2.018286419537275</code></pre>
</div>
</div>
<p>What proportion of blue light solutions that degrade starch use it for osmoticum?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>(((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (scan_results.RXN_2141_p_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>()) <span class="op">/</span> <span class="op">\</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>    ((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>()<span class="op">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>99.89462592202318</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>() <span class="op">-</span> <span class="op">\</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    (((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (scan_results.RXN_2141_p_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>1</code></pre>
</div>
</div>
<p>Only one solution doesn’t</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>scan_constraints[((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> <span class="op">~</span>(scan_results.RXN_2141_p_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>P_abs</th>
      <th>T_l</th>
      <th>A_l</th>
      <th>V_gc_ind</th>
      <th>FqFm</th>
      <th>R_ch</th>
      <th>L_air</th>
      <th>L_epidermis</th>
      <th>Vac_frac</th>
      <th>T</th>
      <th>...</th>
      <th>N_gcs</th>
      <th>n</th>
      <th>m</th>
      <th>r</th>
      <th>s</th>
      <th>C_apo</th>
      <th>A_closed</th>
      <th>A_open</th>
      <th>ATPase</th>
      <th>light</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1685</th>
      <td>0.821423</td>
      <td>0.000237</td>
      <td>1.0</td>
      <td>3.854387e-12</td>
      <td>0.790419</td>
      <td>0.17526</td>
      <td>0.229149</td>
      <td>0.2216</td>
      <td>0.899394</td>
      <td>283.991986</td>
      <td>...</td>
      <td>8.359438e+08</td>
      <td>1.749547</td>
      <td>0.84542</td>
      <td>6.715197e-14</td>
      <td>1.344834e-13</td>
      <td>0.031261</td>
      <td>2.529549</td>
      <td>3.62111</td>
      <td>15.767152</td>
      <td>blue</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 21 columns</p>
</div>
</div>
</div>
<p>1685 is solution without constrained ATPase</p>
<p>What proportion of blue light solutions that degrade starch use it for energy?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>(((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  ).<span class="bu">sum</span>())<span class="op">/</span>((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>()<span class="op">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>97.36564805057955</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> <span class="op">~</span>(scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>25</code></pre>
</div>
</div>
<p>25 solutions that use starch in blue light don’t use the energy pathway</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>(((scan_results[((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>))].MALTODEG_RXN_c_gc_2) <span class="op">/</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a> starch[((scan_constraints[<span class="st">"light"</span>] <span class="op">==</span> <span class="st">"blue"</span>) <span class="op">&amp;</span> (starch <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>))]) <span class="op">*</span> <span class="dv">100</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>4.619191722016749</code></pre>
</div>
</div>
<p>Average of 5% of starch degraded was used for energy</p>
</section>
<section id="d---how-does-glucose-increase-during-opening-vary-with-starch-and-why-isnt-it-totally-linear" class="level2">
<h2 class="anchored" data-anchor-id="d---how-does-glucose-increase-during-opening-vary-with-starch-and-why-isnt-it-totally-linear">7d - How does glucose increase during opening vary with starch, and why isn’t it totally linear?</h2>
<p>Is sucrose degaded in the cytoplasm in any solutions?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>(scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][<span class="st">"RXN_1461_c_gc_2"</span>] <span class="op">&gt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0</code></pre>
</div>
</div>
<p>No</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>sucrose_degraded_v <span class="op">=</span> scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][<span class="st">"RXN_1461_v_gc_2"</span>] <span class="op">&gt;</span> <span class="fl">0.000001</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>no_sucrose_degraded_v <span class="op">=</span> scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][<span class="st">"RXN_1461_v_gc_2"</span>] <span class="op">&lt;</span> <span class="fl">0.000001</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>glucose_import_into_vacuole <span class="op">=</span> scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][<span class="st">"GLC_PROTON_rev_cv_gc_2"</span>] <span class="op">&gt;</span> <span class="fl">0.000001</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>no_glucose_import_into_vacuole <span class="op">=</span> scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][<span class="st">"GLC_PROTON_rev_cv_gc_2"</span>] <span class="op">&lt;</span> <span class="fl">0.000001</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>sucrose_deg_and_glc_import <span class="op">=</span> (sucrose_degraded_v <span class="op">&amp;</span> glucose_import_into_vacuole)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>sucrose_deg_no_glc_import <span class="op">=</span> (sucrose_degraded_v <span class="op">&amp;</span> no_glucose_import_into_vacuole)</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>no_sucrose_deg_glc_import <span class="op">=</span> (no_sucrose_degraded_v <span class="op">&amp;</span> glucose_import_into_vacuole)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>no_sucrose_deg_no_glc_import <span class="op">=</span> (no_sucrose_degraded_v <span class="op">&amp;</span> no_glucose_import_into_vacuole)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>conditions <span class="op">=</span> [sucrose_deg_and_glc_import, sucrose_deg_no_glc_import,</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>              no_sucrose_deg_glc_import, no_sucrose_deg_no_glc_import]</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">"+ S.d. + G.i."</span>, <span class="st">"+ S.d - G.i."</span>, <span class="st">"- S.d + G.i."</span>, <span class="st">"- S.d - G.i."</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> condition, label <span class="kw">in</span> <span class="bu">zip</span>(conditions, labels):</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>label<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Length: </span><span class="sc">{</span>(condition)<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss"> (</span><span class="sc">{</span>((condition).<span class="bu">sum</span>()<span class="op">/</span><span class="bu">len</span>(scan_constraints[starch <span class="op">&gt;</span> <span class="dv">0</span>]) <span class="op">*</span> <span class="dv">100</span>)<span class="sc">.</span><span class="bu">round</span>(<span class="dv">1</span>)<span class="sc">}</span><span class="ss">%)"</span>)</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    starch_proportion <span class="op">=</span> ((scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].STARCH_p_gc_Linker_1 <span class="op">/</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>                         scan_gc_constraints.loc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].Os_dif)<span class="op">*</span><span class="dv">100</span>).median()</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Starch median % of osmolarity: </span><span class="sc">{</span>starch_proportion<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>    starch_proportion <span class="op">=</span> ((scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].STARCH_p_gc_Linker_1 <span class="op">/</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>                         scan_gc_constraints.loc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].Os_dif)<span class="op">*</span><span class="dv">100</span>).mean()</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Starch mean % of osmolarity: </span><span class="sc">{</span>starch_proportion<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>    starch_proportion <span class="op">=</span> ((scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].STARCH_p_gc_Linker_1 <span class="op">/</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>                         scan_gc_constraints.loc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].Os_dif)<span class="op">*</span><span class="dv">100</span>).<span class="bu">max</span>()</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Starch max % of osmolarity: </span><span class="sc">{</span>starch_proportion<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    starch_proportion <span class="op">=</span> ((scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].STARCH_p_gc_Linker_1 <span class="op">/</span></span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>                         scan_gc_constraints.loc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition].Os_dif)<span class="op">*</span><span class="dv">100</span>).<span class="bu">min</span>()</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Starch min % of osmolarity: </span><span class="sc">{</span>starch_proportion<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>+ S.d. + G.i.:
Length: 962 (50.9%)
Starch median % of osmolarity: 79.21003879220572
Starch mean % of osmolarity: 78.82409377347064
Starch max % of osmolarity: 100.92816549076942
Starch min % of osmolarity: 43.44248513983288
+ S.d - G.i.:
Length: 3 (0.2%)
Starch median % of osmolarity: 48.05105335942245
Starch mean % of osmolarity: 49.40105341585774
Starch max % of osmolarity: 52.31384439881553
Starch min % of osmolarity: 47.838262489335236
- S.d + G.i.:
Length: 822 (43.5%)
Starch median % of osmolarity: 85.04872218180918
Starch mean % of osmolarity: 81.8724710052484
Starch max % of osmolarity: 100.86764024051335
Starch min % of osmolarity: 34.687666050849344
- S.d - G.i.:
Length: 104 (5.5%)
Starch median % of osmolarity: 30.960905103662995
Starch mean % of osmolarity: 31.84584462456143
Starch max % of osmolarity: 84.97624241427523
Starch min % of osmolarity: 0.3001445678386764</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>glc_increase <span class="op">=</span> (scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>].GLC_total_pseudolinker_2 <span class="op">-</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>                scan_results[starch <span class="op">&gt;</span> <span class="dv">0</span>].GLC_total_pseudolinker_1)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>glc_increase_per_gc <span class="op">=</span> glc_increase<span class="op">*</span><span class="dv">10</span><span class="op">**-</span><span class="dv">3</span><span class="op">/</span>scan_constraints.N_gcs<span class="op">*</span><span class="dv">10</span><span class="op">**</span><span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> glucose_vs_starch_subfig(ax):</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">600</span>]</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">600</span>]</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>    size <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, y, c<span class="op">=</span><span class="st">"grey"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, clip_on<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>    conditions <span class="op">=</span> [sucrose_deg_and_glc_import, sucrose_deg_no_glc_import,</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>                  no_sucrose_deg_glc_import, no_sucrose_deg_no_glc_import]</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>    colours <span class="op">=</span> [sns.color_palette()[<span class="dv">2</span>], sns.color_palette()[<span class="dv">3</span>], sns.color_palette()[<span class="dv">4</span>], sns.color_palette()[<span class="dv">8</span>]]</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"+ S.d. + G.i."</span>, <span class="st">"+ S.d - G.i."</span>, <span class="st">"- S.d + G.i."</span>, <span class="st">"- S.d - G.i."</span>]</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>    glucose_increase_max <span class="op">=</span> glc_increase_per_gc.<span class="bu">max</span>()</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> condition, colour, label <span class="kw">in</span> <span class="bu">zip</span>(conditions, colours, labels):</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>        ax.scatter(starch_per_gc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition], glc_increase_per_gc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition],</span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>                   color<span class="op">=</span>colour, s<span class="op">=</span>size, label<span class="op">=</span>label, linewidths<span class="op">=</span><span class="dv">0</span>, clip_on<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Starch degradation</span><span class="ch">\n</span><span class="st">"</span> <span class="vs">r"(fmol$\cdot$GC$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"Increase in glucose (fmol$\cdot$GC$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a>    y_max <span class="op">=</span> glucose_increase_max</span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a>    x_max <span class="op">=</span> <span class="dv">600</span></span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a>    major_increment <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="va">None</span>, y_max)</span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(<span class="va">None</span>, x_max)</span>
<span id="cb125-29"><a href="#cb125-29" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">'left'</span>].set_bounds(<span class="dv">0</span>, y_max)</span>
<span id="cb125-30"><a href="#cb125-30" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">'bottom'</span>].set_bounds(<span class="dv">0</span>, x_max)</span>
<span id="cb125-31"><a href="#cb125-31" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_major_locator(MultipleLocator(major_increment))</span>
<span id="cb125-32"><a href="#cb125-32" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb125-33"><a href="#cb125-33" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_major_locator(MultipleLocator(major_increment))</span>
<span id="cb125-34"><a href="#cb125-34" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb125-35"><a href="#cb125-35" aria-hidden="true" tabindex="-1"></a>    ax.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb125-36"><a href="#cb125-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-37"><a href="#cb125-37" aria-hidden="true" tabindex="-1"></a>    ax.vlines(<span class="dv">184</span>, ymin<span class="op">=</span><span class="dv">0</span>, ymax<span class="op">=</span><span class="dv">570</span>, linewidth<span class="op">=</span><span class="dv">1</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, color<span class="op">=</span>sns.color_palette()[<span class="dv">6</span>])</span>
<span id="cb125-38"><a href="#cb125-38" aria-hidden="true" tabindex="-1"></a>    ax.text(<span class="dv">184</span>, <span class="dv">570</span>, <span class="st">"Horrer et al. (2016)"</span>, ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"bottom"</span>, size<span class="op">=</span><span class="st">"x-small"</span>, color<span class="op">=</span>sns.color_palette()[<span class="dv">6</span>])</span>
<span id="cb125-39"><a href="#cb125-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-40"><a href="#cb125-40" aria-hidden="true" tabindex="-1"></a>    ax.legend(loc<span class="op">=</span><span class="st">"lower right"</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">0</span>), handletextpad<span class="op">=</span><span class="dv">0</span>, fontsize<span class="op">=</span><span class="st">"x-small"</span>)</span>
<span id="cb125-41"><a href="#cb125-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-42"><a href="#cb125-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ax</span>
<span id="cb125-43"><a href="#cb125-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-44"><a href="#cb125-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-45"><a href="#cb125-45" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb125-46"><a href="#cb125-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-47"><a href="#cb125-47" aria-hidden="true" tabindex="-1"></a>glucose_vs_starch_subfig(ax)</span>
<span id="cb125-48"><a href="#cb125-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-49"><a href="#cb125-49" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/constraint_scan/starch_vs_glucose.svg"</span>)</span>
<span id="cb125-50"><a href="#cb125-50" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/constraint_scan/starch_vs_glucose.png"</span>, dpi<span class="op">=</span><span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-81-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> glucose_vs_starch_subfig(ax):</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">600</span>]</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">600</span>]</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>    size <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>    ax.plot(x, y, c<span class="op">=</span><span class="st">"grey"</span>, alpha<span class="op">=</span><span class="fl">0.5</span>, clip_on<span class="op">=</span><span class="va">False</span>, linewidth<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>    conditions <span class="op">=</span> [sucrose_deg_and_glc_import,</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>                  no_sucrose_deg_glc_import, no_sucrose_deg_no_glc_import, sucrose_deg_no_glc_import]</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>    colours <span class="op">=</span> [sns.color_palette()[<span class="dv">2</span>], sns.color_palette()[<span class="dv">3</span>], sns.color_palette()[<span class="dv">4</span>], sns.color_palette()[<span class="dv">8</span>]]</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"+ S.d. + G.i."</span>, <span class="st">"- S.d + G.i."</span>, <span class="st">"- S.d - G.i."</span>, <span class="st">"+ S.d - G.i."</span>]</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>    glucose_increase_max <span class="op">=</span> glc_increase_per_gc.<span class="bu">max</span>()</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> condition, colour, label <span class="kw">in</span> <span class="bu">zip</span>(conditions, colours, labels):</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>        ax.scatter(starch_per_gc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition], glc_increase_per_gc[starch <span class="op">&gt;</span> <span class="dv">0</span>][condition],</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>                   color<span class="op">=</span>colour, s<span class="op">=</span>size, label<span class="op">=</span>label, linewidths<span class="op">=</span><span class="dv">0</span>, clip_on<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">"Starch degradation</span><span class="ch">\n</span><span class="st">"</span> <span class="vs">r"(fmol$\cdot$GC$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">"Increase in glucose (fmol$\cdot$GC$^{-1}$)"</span>, size<span class="op">=</span><span class="st">"medium"</span>)</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>    y_max <span class="op">=</span> glucose_increase_max</span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a>    x_max <span class="op">=</span> <span class="dv">600</span></span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>    major_increment <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="va">None</span>, y_max)</span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(<span class="va">None</span>, x_max)</span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">'left'</span>].set_bounds(<span class="dv">0</span>, y_max)</span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">'bottom'</span>].set_bounds(<span class="dv">0</span>, x_max)</span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_major_locator(MultipleLocator(major_increment))</span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>    ax.xaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_major_locator(MultipleLocator(major_increment))</span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a>    ax.yaxis.set_minor_locator(AutoMinorLocator(<span class="dv">2</span>))</span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a>    ax.set_aspect(<span class="st">'equal'</span>)</span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-37"><a href="#cb126-37" aria-hidden="true" tabindex="-1"></a>    ax.vlines(<span class="dv">184</span>, ymin<span class="op">=</span><span class="dv">0</span>, ymax<span class="op">=</span><span class="dv">570</span>, linewidth<span class="op">=</span><span class="dv">1</span>, linestyle<span class="op">=</span><span class="st">"--"</span>, color<span class="op">=</span>sns.color_palette()[<span class="dv">6</span>])</span>
<span id="cb126-38"><a href="#cb126-38" aria-hidden="true" tabindex="-1"></a>    ax.text(<span class="dv">184</span>, <span class="dv">570</span>, <span class="st">"Horrer et al. (2016)"</span>, ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"bottom"</span>, size<span class="op">=</span><span class="st">"x-small"</span>, color<span class="op">=</span>sns.color_palette()[<span class="dv">6</span>])</span>
<span id="cb126-39"><a href="#cb126-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-40"><a href="#cb126-40" aria-hidden="true" tabindex="-1"></a>    ax.legend(loc<span class="op">=</span><span class="st">"lower right"</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">0</span>), handletextpad<span class="op">=</span><span class="dv">0</span>, fontsize<span class="op">=</span><span class="st">"x-small"</span>)</span>
<span id="cb126-41"><a href="#cb126-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-42"><a href="#cb126-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ax</span>
<span id="cb126-43"><a href="#cb126-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-44"><a href="#cb126-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-45"><a href="#cb126-45" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb126-46"><a href="#cb126-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-47"><a href="#cb126-47" aria-hidden="true" tabindex="-1"></a>glucose_vs_starch_subfig(ax)</span>
<span id="cb126-48"><a href="#cb126-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-49"><a href="#cb126-49" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/constraint_scan/starch_vs_glucose.svg"</span>)</span>
<span id="cb126-50"><a href="#cb126-50" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/constraint_scan/starch_vs_glucose.png"</span>, dpi<span class="op">=</span><span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-82-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="combine-subfigures" class="level2">
<h2 class="anchored" data-anchor-id="combine-subfigures">Combine subfigures</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.5</span>, wspace<span class="op">=</span><span class="fl">0.35</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>phloemoutput_subfig(axs[<span class="dv">0</span>][<span class="dv">0</span>])</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>photons_vs_carbon_export_subfig(axs[<span class="dv">0</span>][<span class="dv">1</span>])</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>starch_vs_os_subfig(axs[<span class="dv">1</span>][<span class="dv">0</span>])</span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>glucose_vs_starch_subfig(axs[<span class="dv">1</span>][<span class="dv">1</span>])</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>][<span class="dv">1</span>].get_legend().remove()</span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ax, letter <span class="kw">in</span> <span class="bu">zip</span>([axs[<span class="dv">0</span>][<span class="dv">0</span>], axs[<span class="dv">0</span>][<span class="dv">1</span>], axs[<span class="dv">1</span>][<span class="dv">0</span>], axs[<span class="dv">1</span>][<span class="dv">1</span>]], [<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>]):</span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a>    ax.text(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">1.06</span>, letter, transform<span class="op">=</span>ax.transAxes,</span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>            size<span class="op">=</span><span class="dv">20</span>, weight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/constraint_scan/constraint_scan_analysis_plot.svg"</span>, transparent<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/constraint_scan/constraint_scan_analysis_plot.png"</span>, transparent<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-83-output-1.png" class="img-fluid"></p>
</div>
</div>
<hr>
</section>
<section id="extra-analyses-not-included" class="level2">
<h2 class="anchored" data-anchor-id="extra-analyses-not-included">Extra analyses not included</h2>
<section id="what-is-the-ratio-of-mitochondrial-to-plastidic-atp-synthase" class="level3">
<h3 class="anchored" data-anchor-id="what-is-the-ratio-of-mitochondrial-to-plastidic-atp-synthase">What is the ratio of mitochondrial to plastidic ATP synthase?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>))</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].hist(scan_results.Plastidial_ATP_Synthase_p_gc_2[scan_constraints.light <span class="op">==</span> <span class="st">"white"</span>] <span class="op">/</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>            scan_results.Mitochondrial_ATP_Synthase_m_gc_2[scan_constraints.light <span class="op">==</span> <span class="st">"white"</span>], bins<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_title(<span class="st">"Opening in white light"</span>)</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">0</span>].set_xlabel(<span class="st">"Plastidial ATP Synthase</span><span class="ch">\n</span><span class="st">Mitochondrial ATP Synthase"</span>)</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].hist(scan_results.Plastidial_ATP_Synthase_p_gc_3<span class="op">/</span>scan_results.Mitochondrial_ATP_Synthase_m_gc_3, bins<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_title(<span class="st">"Day in both light types"</span>)</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>axs[<span class="dv">1</span>].set_xlabel(<span class="st">"Plastidial ATP Synthase</span><span class="ch">\n</span><span class="st">Mitochondrial ATP Synthase"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0.5, 0, 'Plastidial ATP Synthase\nMitochondrial ATP Synthase')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-84-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, figsize<span class="op">=</span>(<span class="dv">5</span>, <span class="dv">4</span>))</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>plastidial_atp_max <span class="op">=</span> scan_results.loc[:, [</span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Plastidial_ATP_Synthase_p_gc_3"</span>, <span class="st">"Plastidial_ATP_Synthase_p_gc_2"</span>]].<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>mitochondial_atp_max <span class="op">=</span> scan_results.loc[:, [</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mitochondrial_ATP_Synthase_m_gc_3"</span>, <span class="st">"Mitochondrial_ATP_Synthase_m_gc_2"</span>]].<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> light <span class="kw">in</span> [<span class="st">"blue"</span>, <span class="st">"white"</span>]:</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a>    ax.hist(plastidial_atp_max[scan_constraints.light <span class="op">==</span> light] <span class="op">/</span></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>            mitochondial_atp_max[scan_constraints.light <span class="op">==</span> light], histtype<span class="op">=</span><span class="st">"step"</span>, label<span class="op">=</span>light)</span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">"Max plastidial ATP Synthase</span><span class="ch">\n</span><span class="st">Max mitochondrial ATP Synthase"</span>)</span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a>ax.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;matplotlib.legend.Legend&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-85-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>ax.plot([<span class="dv">0</span>, <span class="fl">0.3</span>], [<span class="dv">0</span>, <span class="fl">0.3</span>], c<span class="op">=</span><span class="st">"grey"</span>, zorder<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>ax.scatter(plastidial_atp_max, mitochondial_atp_max, s<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;matplotlib.collections.PathCollection&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-86-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>(plastidial_atp_max<span class="op">/</span>mitochondial_atp_max).<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.08544687640486812</code></pre>
</div>
</div>
</section>
</section>
<section id="almost-all-starch-is-used-for-glucose-and-pep-carboxykinase-reaction-never-runs" class="level2">
<h2 class="anchored" data-anchor-id="almost-all-starch-is-used-for-glucose-and-pep-carboxykinase-reaction-never-runs">Almost all starch is used for glucose, and PEP carboxykinase reaction never runs</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>(scan_results.PEPCARBOX_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>(scan_results.PEPDEPHOS_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>984</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>((scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (scan_results.PEPDEPHOS_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>951</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>((scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (scan_results.PYRUVDEH_RXN_m_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>951</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>((scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (scan_results.ISOCITRATE_DEHYDROGENASE_NAD_RXN_m_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>951</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>(scan_results[(scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)].MALTODEG_RXN_c_gc_2<span class="op">/</span><span class="dv">2</span> <span class="op">-</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a> scan_results[(scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)].PEPDEPHOS_RXN_c_gc_2).hist(bins<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-93-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>(scan_results[(scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)].MALTODEG_RXN_c_gc_2<span class="op">/</span><span class="dv">2</span> <span class="op">-</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a> scan_results[(scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)].PYRUVDEH_RXN_m_gc_2).hist(bins<span class="op">=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="3.3_analyse_constraint_scan_files/figure-html/cell-94-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>scan_results[(scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)].MALTODEG_RXN_c_gc_2 <span class="op">-</span> <span class="op">\</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>    scan_results[(scan_results.MALTODEG_RXN_c_gc_2 <span class="op">&gt;</span> <span class="dv">0</span>)].ISOCITRATE_DEHYDROGENASE_NAD_RXN_m_gc_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>25      0.000994
32      0.000602
58      0.000030
140     0.002853
148     0.002621
          ...   
1939   -0.003483
1940    0.003833
1941   -0.001579
1942   -0.000820
1943   -0.003544
Length: 951, dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>(scan_results.MAL_total_pseudolinker_2 <span class="op">&gt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>78</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>scan_constraints[((scan_results.MAL_total_pseudolinker_2 <span class="op">-</span> scan_results.MAL_total_pseudolinker_1) <span class="op">&gt;</span> <span class="dv">0</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>P_abs</th>
      <th>T_l</th>
      <th>A_l</th>
      <th>V_gc_ind</th>
      <th>FqFm</th>
      <th>R_ch</th>
      <th>L_air</th>
      <th>L_epidermis</th>
      <th>Vac_frac</th>
      <th>T</th>
      <th>...</th>
      <th>N_gcs</th>
      <th>n</th>
      <th>m</th>
      <th>r</th>
      <th>s</th>
      <th>C_apo</th>
      <th>A_closed</th>
      <th>A_open</th>
      <th>ATPase</th>
      <th>light</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1384</th>
      <td>0.856283</td>
      <td>0.000233</td>
      <td>1.0</td>
      <td>3.557774e-12</td>
      <td>0.829166</td>
      <td>0.09021</td>
      <td>0.325547</td>
      <td>0.178134</td>
      <td>0.821274</td>
      <td>290.830057</td>
      <td>...</td>
      <td>2.209913e+08</td>
      <td>2.157369</td>
      <td>0.845391</td>
      <td>7.202105e-14</td>
      <td>1.351502e-13</td>
      <td>0.031031</td>
      <td>3.986023</td>
      <td>10.771568</td>
      <td>0.018741</td>
      <td>blue</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 21 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>starch[<span class="dv">1384</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.0774719542034296</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>(scan_constraints.loc[<span class="dv">1384</span>]<span class="op">-</span>scan_constraints.mean())<span class="op">/</span>scan_constraints.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_1954444/1907229730.py:1: FutureWarning: The default value of numeric_only in DataFrame.mean is deprecated. In a future version, it will default to False. In addition, specifying 'numeric_only=None' is deprecated. Select only valid columns or specify the value of numeric_only to silence this warning.
  (scan_constraints.loc[1384]-scan_constraints.mean())/scan_constraints.std()
/tmp/ipykernel_1954444/1907229730.py:1: FutureWarning: The default value of numeric_only in DataFrame.std is deprecated. In a future version, it will default to False. In addition, specifying 'numeric_only=None' is deprecated. Select only valid columns or specify the value of numeric_only to silence this warning.
  (scan_constraints.loc[1384]-scan_constraints.mean())/scan_constraints.std()</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>ATPase        -1.727007
A_closed       1.766129
A_l                 NaN
A_open         1.255356
C_apo          0.225023
FqFm          -0.498871
L_air          0.896352
L_epidermis    0.197816
N_gcs         -1.572157
P_abs         -0.835521
R              0.999743
R_ch          -0.440596
T              0.043976
T_l            1.367673
V_gc_ind       1.214546
Vac_frac      -0.104569
light               NaN
m             -0.946882
n              0.543079
r              0.814312
s             -1.123443
dtype: object</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>scan_constraints.loc[<span class="dv">1384</span>].ATPase</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.0187406648439282</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>scan_constraints.mean().ATPase</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_1954444/856568451.py:1: FutureWarning: The default value of numeric_only in DataFrame.mean is deprecated. In a future version, it will default to False. In addition, specifying 'numeric_only=None' is deprecated. Select only valid columns or specify the value of numeric_only to silence this warning.
  scan_constraints.mean().ATPase</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>8.503141757759833</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>atpase_constrained[<span class="dv">1384</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>scan_results.loc[<span class="dv">1384</span>].MALTODEG_RXN_c_gc_2 <span class="op">/</span> starch[<span class="dv">1384</span>] <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>6.022598590391629</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>scan_results.loc[<span class="dv">1384</span>].RXN_2141_p_gc_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.072806129381625</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>scan_results.loc[<span class="dv">1384</span>].MALATE_DEH_RXN_m_gc_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.0062190610980747</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>scan_results.loc[<span class="dv">1384</span>].ISOCITRATE_DEHYDROGENASE_NAD_RXN_m_gc_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.0031105060888218</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>(scan_gc_constraints.loc[<span class="dv">1384</span>]<span class="op">-</span>scan_gc_constraints.mean())<span class="op">/</span>scan_gc_constraints.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>V_closed    -1.252034
V_open      -1.102307
Os_closed   -0.921524
Os_open     -0.706567
Photons     -0.761435
ATPase      -1.319215
Os_dif      -0.551403
dtype: float64</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./3.2_run_constraint_scan.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Running Constraint Scan</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./4.1_generate_alternative_flux_modes_matrix.html" class="pagination-link">
        <span class="nav-page-text">Alternative Flux Modes</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>