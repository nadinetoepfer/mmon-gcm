<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>mmon-gcm - Is H+ATPase limiting?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./1.5_convert_horrer_starch_level.html" rel="next">
<link href="./1.2_defining_parameters.html" rel="prev">
<link href="./favicon.svg" rel="icon" type="image/svg+xml">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="mmon-gcm - Is H+ATPase limiting?">
<meta property="og:description" content="Jezek et al.&nbsp;(2019) wrote a follow-up OnGuard paper, where they added a constraint-relaxation-recovery mechanism into the model. The justification for this was:">
<meta property="og:site-name" content="mmon-gcm">
<meta name="twitter:title" content="mmon-gcm - Is H+ATPase limiting?">
<meta name="twitter:description" content="Jezek et al.&nbsp;(2019) wrote a follow-up OnGuard paper, where they added a constraint-relaxation-recovery mechanism into the model. The justification for this was:">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">mmon-gcm</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Is H+ATPase limiting?</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./logo.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">MMON-GCM</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Building model and defining parameters</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.0_generating_linkers.html" class="sidebar-item-text sidebar-link">Generating table for linkers/osmolytes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.1_buildingmodel.html" class="sidebar-item-text sidebar-link">Building model</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.2_defining_parameters.html" class="sidebar-item-text sidebar-link">Finding parameters</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.3_atpase_constraint.html" class="sidebar-item-text sidebar-link active">Is H+ATPase limiting?</a>
  </div>
</li>
          <li class="sidebar-item">
  1.4_flutschconcentrations.ipynb
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.5_convert_horrer_starch_level.html" class="sidebar-item-text sidebar-link">Starch amount estimation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Solving and analysing specific scenarios for paper</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.1_solvingmodel.html" class="sidebar-item-text sidebar-link">Solving guard cell models for different parameters</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.2_analysingsolutions.html" class="sidebar-item-text sidebar-link">Analysing solutions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.3_flux_map_values.html" class="sidebar-item-text sidebar-link">Calculating line widths for flux maps</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Running constraints scan</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.1_generate_constraints_df.html" class="sidebar-item-text sidebar-link">Constraint scan</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.2_run_constraint_scan.html" class="sidebar-item-text sidebar-link">Running Constraint Scan</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.3_analyse_constraint_scan.html" class="sidebar-item-text sidebar-link">Analysing the results of the constraint scan</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Running and analysing alternative flux modes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4.1_generate_alternative_flux_modes_matrix.html" class="sidebar-item-text sidebar-link">Alternative Flux Modes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4.2_run_alternative_flux_modes.html" class="sidebar-item-text sidebar-link">Run alternative flux modes simulations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4.3_analyse_alternative_flux_modes.html" class="sidebar-item-text sidebar-link">Analysing alternative flux modes</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  prep_plant_cell.ipynb
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">functions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/alternativemodes.html" class="sidebar-item-text sidebar-link">alternativemodes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/analysing.html" class="sidebar-item-text sidebar-link">Analysing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/buildingediting.html" class="sidebar-item-text sidebar-link">buildingediting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/constraintscan.html" class="sidebar-item-text sidebar-link">constraintscan</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/helper.html" class="sidebar-item-text sidebar-link">Helper functions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/osmolyteconstraints.html" class="sidebar-item-text sidebar-link">osmolyteconstraints</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/solving.html" class="sidebar-item-text sidebar-link">solving</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#calculating-h-atpase-flux-in-the-model-in-fmolesgch-1" id="toc-calculating-h-atpase-flux-in-the-model-in-fmolesgch-1" class="nav-link" data-scroll-target="#calculating-h-atpase-flux-in-the-model-in-fmolesgch-1">Calculating H+-ATPase flux in the model in fmoles/gc/h-1</a></li>
  <li><a href="#comparing-with-flutsch" id="toc-comparing-with-flutsch" class="nav-link" data-scroll-target="#comparing-with-flutsch">Comparing with Flutsch</a></li>
  <li><a href="#comparing-with-papanatsiou-et-al-2019" id="toc-comparing-with-papanatsiou-et-al-2019" class="nav-link" data-scroll-target="#comparing-with-papanatsiou-et-al-2019">Comparing with Papanatsiou et al 2019</a></li>
  <li><a href="#comparing-with-onguard" id="toc-comparing-with-onguard" class="nav-link" data-scroll-target="#comparing-with-onguard">Comparing with OnGuard</a></li>
  <li><a href="#stomatal-aperture-sanity-check" id="toc-stomatal-aperture-sanity-check" class="nav-link" data-scroll-target="#stomatal-aperture-sanity-check">Stomatal aperture sanity check</a>
  <ul class="collapse">
  <li><a href="#osmolarity-sanity-check" id="toc-osmolarity-sanity-check" class="nav-link" data-scroll-target="#osmolarity-sanity-check">Osmolarity sanity check</a></li>
  <li><a href="#h-atpase-flux" id="toc-h-atpase-flux" class="nav-link" data-scroll-target="#h-atpase-flux">H<span class="math inline">\(^+\)</span>-ATPase flux</a></li>
  </ul></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/noahsprent/mmon-gcm/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Is H+ATPase limiting?</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<p>Jezek et al.&nbsp;(2019) wrote a follow-up OnGuard paper, where they added a constraint-relaxation-recovery mechanism into the model. The justification for this was:</p>
<blockquote class="blockquote">
<p>No physiologically reasonable manipulation of model parameters defining the H+‐ATPase, the K+ and Cl− (anion) channels, their populations at the plasma membrane, or of other transporters participating in guard cell solute accumulation, could bring the model‐predicted stomatal opening substantially closer to the experimentally observed kinetics.</p>
</blockquote>
<p>They therefore added a the CRR mechanism into the model which was able to reconcile the kinetics of stomatal conductance experimentally and in the model.</p>
<p>Despite this, they also say in the discussion:</p>
<blockquote class="blockquote">
<p>Of course, other mechanisms may also accommodate the accelerated stomatal kinetics. For example, there is a substantial body of evidence supporting carbon flow from starch or fructans to sucrose or malate during stomatal opening, and reverse flows during stomatal closure (Dittrich &amp; Raschke, 1977; Outlaw, 2003; Santelia &amp; Lawson,2016; Santelia &amp; Lunn, 2017), especially under low light (Horrer et al., 2016).</p>
</blockquote>
<p>Flutsch et al (2020) investigated the kinetics of stomatal opening in amy3bam1 and aha1 knockouts. The amy3bam1 mutant cannot degrade starch and the aha1 mutant can’t pump protons out of the guard cell, which drives K+/Mal/Cl uptake into the guard cell. It also is part of the starch signaling pathway. They found that there was no impact on the H+-ATPase or kinetics of K+/Cl- uptake in the amy3bam1 knockout, suggesting that starch is not degraded to power the H+-ATPase pump, but rather it is a source of osmoticum in the form of glucose. However, the amy3bam1 mutants had slower opening kinetics.</p>
<p>This would be consistent with a H+-ATPase that is not able to provide osmoticum at a sufficient rate for opening. It is saturated regardless of whether or not starch is available. As our model does not degrade starch, instead meeting all the osmotic requirements of opening using K+/Cl- uptake, we wanted to see what would happen if we added a constraint on the rate of the H+-ATPase. This notebook explores the experimental rate of the H+-ATPase that Flutsch et al (2020) estimated and compares it to the rate in the model that is required for the Guard Cell to open, in order to see whether adding a constraint would affect the model.</p>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cobra</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mmon_gcm.supermodel <span class="im">import</span> SuperModel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>four_stage_GC_model <span class="op">=</span> cobra.io.sbml.read_sbml_model(<span class="st">"../models/4_stage_GC.xml"</span>)  <span class="co"># read model</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No objective coefficients in model. Unclear what should be optimized</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>solution <span class="op">=</span> pd.read_csv(<span class="st">"../outputs/model_solutions/blue_unconstrained_starchko.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>parameters_df <span class="op">=</span> pd.read_csv(<span class="st">"../inputs/arabidopsis_parameters.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculating-h-atpase-flux-in-the-model-in-fmolesgch-1" class="level2">
<h2 class="anchored" data-anchor-id="calculating-h-atpase-flux-in-the-model-in-fmolesgch-1">Calculating H+-ATPase flux in the model in fmoles/gc/h-1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>atpase_flux <span class="op">=</span> solution.loc[<span class="st">"PROTON_ATPase_c_gc_2"</span>, <span class="st">"fluxes"</span>]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"ATPase flux is </span><span class="sc">{</span>atpase_flux<span class="sc">}</span><span class="ss"> mmoles m-2 leaf h-1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ATPase flux is 0.00812887978917 mmoles m-2 leaf h-1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>n_gcs <span class="op">=</span> parameters_df.loc[<span class="st">"N_gcs"</span>, <span class="st">"Value"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>flux_per_gc_moles <span class="op">=</span> atpase_flux <span class="op">/</span> n_gcs <span class="op">*</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>flux_per_gc_fmoles <span class="op">=</span> flux_per_gc_moles <span class="op">*</span> <span class="dv">10</span><span class="op">**</span><span class="dv">15</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>flux_per_gc_fmoles_rounded <span class="op">=</span> flux_per_gc_fmoles.<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Rate of H+-ATPase is </span><span class="sc">{</span>flux_per_gc_fmoles_rounded<span class="sc">}</span><span class="ss"> fmoles gc-1 h-1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rate of H+-ATPase is 14.0 fmoles gc-1 h-1</code></pre>
</div>
</div>
</section>
<section id="comparing-with-flutsch" class="level2">
<h2 class="anchored" data-anchor-id="comparing-with-flutsch">Comparing with Flutsch</h2>
<p>According to their Supplemental file 1, Flutsch et al say that guard cells can provide 17 fmoles H+ h-1 (0.017 pmoles).</p>
</section>
<section id="comparing-with-papanatsiou-et-al-2019" class="level2">
<h2 class="anchored" data-anchor-id="comparing-with-papanatsiou-et-al-2019">Comparing with Papanatsiou et al 2019</h2>
<p>(From supplementary methods of Papanatsiou et al., 2019:) &gt;“Between the fully closed and fully open state of the stoma, the osmotic content of an Arabidopsis guard cell rises by approximately 200 to 300 mM on a cell volume basis (5). Roughly half of this osmotic content is made up of K+ transported across the plasma membrane and translates to approximately 70 fmol of K+ per guard cell.”<br>
5 - Engineer, C. B. et al.&nbsp;(2016) ‘CO2 Sensing and CO2 Regulation of Stomatal Conductance: Advances and Open Questions’, Trends in Plant Science. Elsevier Ltd, 21(1), pp.&nbsp;16–30. doi: 10.1016/j.tplants.2015.08.014.</p>
<p>But there is nothing in the Engineer paper that references this…</p>
</section>
<section id="comparing-with-onguard" class="level2">
<h2 class="anchored" data-anchor-id="comparing-with-onguard">Comparing with OnGuard</h2>
<p>I ran the default model that comes with OnGuard version 3 ‘RCA5-wt-191120-wt’ using the Summer 2022 release of OnGuard. Modifying it by unticking the ‘CRR’ box. I ran it for 24 hours and exported the results as a csv:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import csv and tidy up</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>onguard_df <span class="op">=</span> pd.read_csv(<span class="st">"../inputs/RCA5-wt-191120-wt-001.csv"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>onguard_df <span class="op">=</span> onguard_df.set_index(<span class="st">"Time /hr"</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>onguard_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Time /s</th>
      <th>Time /min</th>
      <th>Time /d</th>
      <th>Vpm /mV</th>
      <th>Vtp /mV</th>
      <th>VT /pL</th>
      <th>Vac %-age</th>
      <th>SA /um</th>
      <th>TP /atm</th>
      <th>Unnamed: 10</th>
      <th>...</th>
      <th>VPD/KPa</th>
      <th>Unnamed: 140</th>
      <th>CRR Value</th>
      <th>CRR Recovery</th>
      <th>Unnamed: 143</th>
      <th>Ciso(0) /mM</th>
      <th>'Mott' (*1000)</th>
      <th>Ciso' /mM</th>
      <th>Osm[Cyt] /mM</th>
      <th>Unnamed: 148</th>
    </tr>
    <tr>
      <th>Time /hr</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.00000</th>
      <td>0.0</td>
      <td>0.00000</td>
      <td>0.00000</td>
      <td>-62.1</td>
      <td>-35.5</td>
      <td>0.381</td>
      <td>79.172</td>
      <td>1.629</td>
      <td>4.303</td>
      <td>NaN</td>
      <td>...</td>
      <td>-0.943</td>
      <td>NaN</td>
      <td>1</td>
      <td>2.630280e-25</td>
      <td>NaN</td>
      <td>23.1003</td>
      <td>5.73262</td>
      <td>28.8329</td>
      <td>204.713</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.00639</th>
      <td>23.0</td>
      <td>0.38342</td>
      <td>0.00027</td>
      <td>-62.9</td>
      <td>-35.5</td>
      <td>0.381</td>
      <td>79.162</td>
      <td>1.629</td>
      <td>4.303</td>
      <td>NaN</td>
      <td>...</td>
      <td>-0.943</td>
      <td>NaN</td>
      <td>1</td>
      <td>2.630280e-25</td>
      <td>NaN</td>
      <td>23.0992</td>
      <td>5.73783</td>
      <td>28.8370</td>
      <td>204.752</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.01306</th>
      <td>47.0</td>
      <td>0.78353</td>
      <td>0.00054</td>
      <td>-63.7</td>
      <td>-35.4</td>
      <td>0.381</td>
      <td>79.161</td>
      <td>1.629</td>
      <td>4.303</td>
      <td>NaN</td>
      <td>...</td>
      <td>-0.943</td>
      <td>NaN</td>
      <td>1</td>
      <td>2.630280e-25</td>
      <td>NaN</td>
      <td>23.0991</td>
      <td>5.73811</td>
      <td>28.8372</td>
      <td>204.793</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.01881</th>
      <td>67.7</td>
      <td>1.12838</td>
      <td>0.00078</td>
      <td>-64.3</td>
      <td>-35.4</td>
      <td>0.381</td>
      <td>79.164</td>
      <td>1.629</td>
      <td>4.303</td>
      <td>NaN</td>
      <td>...</td>
      <td>-0.943</td>
      <td>NaN</td>
      <td>1</td>
      <td>2.630280e-25</td>
      <td>NaN</td>
      <td>23.0990</td>
      <td>5.73851</td>
      <td>28.8375</td>
      <td>204.829</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>0.02486</th>
      <td>89.5</td>
      <td>1.49185</td>
      <td>0.00104</td>
      <td>-64.9</td>
      <td>-35.4</td>
      <td>0.381</td>
      <td>79.168</td>
      <td>1.629</td>
      <td>4.303</td>
      <td>NaN</td>
      <td>...</td>
      <td>-0.943</td>
      <td>NaN</td>
      <td>1</td>
      <td>2.630280e-25</td>
      <td>NaN</td>
      <td>23.0990</td>
      <td>5.73911</td>
      <td>28.8381</td>
      <td>204.867</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>23.97191</th>
      <td>86298.9</td>
      <td>1438.31476</td>
      <td>0.99883</td>
      <td>-59.9</td>
      <td>-36.4</td>
      <td>0.380</td>
      <td>79.641</td>
      <td>1.609</td>
      <td>4.287</td>
      <td>NaN</td>
      <td>...</td>
      <td>-0.943</td>
      <td>NaN</td>
      <td>1</td>
      <td>2.630280e-25</td>
      <td>NaN</td>
      <td>23.1004</td>
      <td>5.66717</td>
      <td>28.7675</td>
      <td>204.079</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23.97842</th>
      <td>86322.3</td>
      <td>1438.70519</td>
      <td>0.99910</td>
      <td>-59.9</td>
      <td>-36.4</td>
      <td>0.380</td>
      <td>79.642</td>
      <td>1.609</td>
      <td>4.287</td>
      <td>NaN</td>
      <td>...</td>
      <td>-0.943</td>
      <td>NaN</td>
      <td>1</td>
      <td>2.630280e-25</td>
      <td>NaN</td>
      <td>23.1004</td>
      <td>5.66763</td>
      <td>28.7680</td>
      <td>204.084</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23.98431</th>
      <td>86343.5</td>
      <td>1439.05839</td>
      <td>0.99935</td>
      <td>-60.0</td>
      <td>-36.4</td>
      <td>0.380</td>
      <td>79.642</td>
      <td>1.609</td>
      <td>4.287</td>
      <td>NaN</td>
      <td>...</td>
      <td>-0.943</td>
      <td>NaN</td>
      <td>1</td>
      <td>2.630280e-25</td>
      <td>NaN</td>
      <td>23.1004</td>
      <td>5.66814</td>
      <td>28.7685</td>
      <td>204.089</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23.99081</th>
      <td>86366.9</td>
      <td>1439.44890</td>
      <td>0.99962</td>
      <td>-59.9</td>
      <td>-36.4</td>
      <td>0.380</td>
      <td>79.643</td>
      <td>1.609</td>
      <td>4.287</td>
      <td>NaN</td>
      <td>...</td>
      <td>-0.943</td>
      <td>NaN</td>
      <td>1</td>
      <td>2.630280e-25</td>
      <td>NaN</td>
      <td>23.1004</td>
      <td>5.66859</td>
      <td>28.7690</td>
      <td>204.094</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>23.99670</th>
      <td>86388.1</td>
      <td>1439.80211</td>
      <td>0.99986</td>
      <td>-60.0</td>
      <td>-36.4</td>
      <td>0.380</td>
      <td>79.643</td>
      <td>1.609</td>
      <td>4.287</td>
      <td>NaN</td>
      <td>...</td>
      <td>-0.943</td>
      <td>NaN</td>
      <td>1</td>
      <td>2.630280e-25</td>
      <td>NaN</td>
      <td>23.1004</td>
      <td>5.66910</td>
      <td>28.7695</td>
      <td>204.099</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>3905 rows × 148 columns</p>
</div>
</div>
</div>
<p>Where did their original kinetics for the H+-ATPase come from?</p>
<p>From Hills et al (2012):</p>
<blockquote class="blockquote">
<p>H+-ATPase: The parameters are fully constrained by experimental analysis of the Vicia guard cell H+-ATPase (Blatt 1987a; Blatt 1988a; Blatt and Clint 1989; Clint and Blatt 1989) and equivalent analysis of the Chara H+-ATPase (Blatt et al.&nbsp;1990a), the latter providing expansion to a 4-state carrier cycle to describe its pH dependence explicitly. The model incorporates [Ca2+]i sensitivity as an inhibitory ligand (Ki, 400 nM and nh, 3 to give &gt;90% inhibition at 1 μM [Ca2+]i; see Kinoshita, et al.&nbsp;(1995) and light as a stimulatory ligand [K1/2, 50 μmol m-2 s-1 and nh, 1, 20-fold enhancement over dark activity; see Goh, et al.&nbsp;(1995) and Kinoshita and Shimazaki (Kinoshita and Shimazaki 1999)].</p>
</blockquote>
<blockquote class="blockquote">
<p>4-State H+-ATPase [3000000 units] (4-State ‘Slayman’ Pump) #‘H’ Stoichiometry = +1; binds at 4-&gt;1 (in) and 3-&gt;2 (ex); K12 = 2000, K23 = 50000, K34 = 500, K41 = 2e+09, K21 = 100, K32 = 1e+08, K43 = 10, K14 = 200; Light-Sensitive: Yes: L1⁄2 = 50 μEinsteins, Fmin = 5% Ligand-Gates: Ca-inhibited (cytosol): Kd= 2.5e-07, Hill= 3;</p>
</blockquote>
</section>
<section id="stomatal-aperture-sanity-check" class="level2">
<h2 class="anchored" data-anchor-id="stomatal-aperture-sanity-check">Stomatal aperture sanity check</h2>
<p>First, a sanity check on the stomatal aperture:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>onguard_df[<span class="st">"SA /um"</span>].plot(ylabel<span class="op">=</span><span class="st">"Aperture (µm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: xlabel='Time /hr', ylabel='Aperture (µm)'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="1.3_atpase_constraint_files/figure-html/cell-11-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>onguard_df[onguard_df.index <span class="op">&lt;</span> <span class="dv">1</span>][<span class="st">"SA /um"</span>].plot(ylabel<span class="op">=</span><span class="st">"Aperture (µm)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: xlabel='Time /hr', ylabel='Aperture (µm)'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="1.3_atpase_constraint_files/figure-html/cell-12-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Our aperture is 1.6-2.75, so pretty similar over half an hour to what they are seeing over one hour</p>
<section id="osmolarity-sanity-check" class="level3">
<h3 class="anchored" data-anchor-id="osmolarity-sanity-check">Osmolarity sanity check</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>cyt_df <span class="op">=</span> onguard_df.<span class="bu">filter</span>(regex<span class="op">=</span><span class="st">"mM"</span>).<span class="bu">filter</span>(regex<span class="op">=</span><span class="st">"Cyt"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>vac_df <span class="op">=</span> onguard_df.<span class="bu">filter</span>(regex<span class="op">=</span><span class="st">"mM"</span>).<span class="bu">filter</span>(regex<span class="op">=</span><span class="st">"Vac"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> just_inside_brackets(string_to_be_pruned):</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> string_to_be_pruned.split(<span class="st">"]"</span>)[<span class="dv">0</span>][<span class="dv">1</span>:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>vac_df.columns <span class="op">=</span> [just_inside_brackets(col) <span class="op">+</span> <span class="st">" mM"</span> <span class="cf">for</span> col <span class="kw">in</span> vac_df.columns]</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>cyt_df.columns <span class="op">=</span> [just_inside_brackets(col) <span class="op">+</span> <span class="st">" mM"</span> <span class="cf">for</span> col <span class="kw">in</span> cyt_df.columns]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>vac_frac <span class="op">=</span> <span class="fl">79.2589</span> <span class="op">/</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>total_df <span class="op">=</span> vac_df <span class="op">*</span> vac_frac <span class="op">+</span> cyt_df <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> vac_frac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>total_df[onguard_df.index <span class="op">&lt;</span> <span class="dv">1</span>].<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>).plot(ylabel<span class="op">=</span><span class="st">"Total osmolytes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: xlabel='Time /hr', ylabel='Total osmolytes'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="1.3_atpase_constraint_files/figure-html/cell-18-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>Our osmolarities go from 178mM to 215mM for the same aperture range, so there’s something not quite right somewhere maybe…</p>
</section>
<section id="h-atpase-flux" class="level3">
<h3 class="anchored" data-anchor-id="h-atpase-flux">H<span class="math inline">\(^+\)</span>-ATPase flux</h3>
<p>Now, let’s see what the H+-ATPase flux is doing:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the flux of the H+-ATPase in units of fmoles/h</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>atpase_h <span class="op">=</span> onguard_df[<span class="st">"HATP[H]"</span>] <span class="op">*</span> <span class="dv">3600</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>atpase_h.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: xlabel='Time /hr'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="1.3_atpase_constraint_files/figure-html/cell-19-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>The flux through the H+-ATPASe increases over the first hour or so, but we are only interested in the first half an hour ish:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>linreg <span class="op">=</span> stats.linregress(x<span class="op">=</span>onguard_df[onguard_df.index <span class="op">&lt;</span> <span class="fl">0.5</span>].index, y<span class="op">=</span>atpase_h[onguard_df.index <span class="op">&lt;</span> <span class="fl">0.5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>plt.plot(onguard_df[onguard_df.index <span class="op">&lt;</span> <span class="dv">1</span>].index, atpase_h[onguard_df.index <span class="op">&lt;</span> <span class="dv">1</span>])</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>plt.plot(onguard_df[onguard_df.index <span class="op">&lt;</span> <span class="fl">0.5</span>].index,</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>         (onguard_df[onguard_df.index <span class="op">&lt;</span> <span class="fl">0.5</span>].index) <span class="op">*</span> linreg.slope <span class="op">+</span> linreg.intercept)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"H+-ATPase flux (fmol/h)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Text(0, 0.5, 'H+-ATPase flux (fmol/h)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="1.3_atpase_constraint_files/figure-html/cell-21-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>As the increase in flux through the H+-ATPase looks pretty linear from 0 to 0.5 hours, we can take the average over this time period and use it as our constraint</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>atpase_h[onguard_df.index <span class="op">&lt;</span> <span class="fl">0.5</span>].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>7.499933868292683</code></pre>
</div>
</div>
</section>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>So even though the Flutsch value is higher (17 fmoles/h), it looks like this value from the OnGuard model might be a good value to use as our constraint, as it will about half the H+-ATPase rate for us (7.5 fmoles/h vs 13.9 fmoles/h).</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./1.2_defining_parameters.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Finding parameters</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./1.5_convert_horrer_starch_level.html" class="pagination-link">
        <span class="nav-page-text">Starch amount estimation</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>