<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>mmon-gcm - Analysing solutions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./2.3_flux_map_values.html" rel="next">
<link href="./2.1_solvingmodel.html" rel="prev">
<link href="./favicon.svg" rel="icon" type="image/svg+xml">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="mmon-gcm - Analysing solutions">
<meta property="og:description" content="All gc osmolytes">
<meta property="og:site-name" content="mmon-gcm">
<meta name="twitter:title" content="mmon-gcm - Analysing solutions">
<meta name="twitter:description" content="All gc osmolytes">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">mmon-gcm</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Analysing solutions</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./logo.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">MMON-GCM</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Building model and defining parameters</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.0_generating_linkers.html" class="sidebar-item-text sidebar-link">Generating table for linkers/osmolytes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.1_buildingmodel.html" class="sidebar-item-text sidebar-link">Building model</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.2_defining_parameters.html" class="sidebar-item-text sidebar-link">Finding parameters</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.3_atpase_constraint.html" class="sidebar-item-text sidebar-link">Is H+ATPase limiting?</a>
  </div>
</li>
          <li class="sidebar-item">
  1.4_flutschconcentrations.ipynb
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.5_convert_horrer_starch_level.html" class="sidebar-item-text sidebar-link">Starch amount estimation</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Solving and analysing specific scenarios for paper</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.1_solvingmodel.html" class="sidebar-item-text sidebar-link">Solving guard cell models for different parameters</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.2_analysingsolutions.html" class="sidebar-item-text sidebar-link active">Analysing solutions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.3_flux_map_values.html" class="sidebar-item-text sidebar-link">Calculating line widths for flux maps</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Running constraints scan</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.1_generate_constraints_df.html" class="sidebar-item-text sidebar-link">Constraint scan</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.2_run_constraint_scan.html" class="sidebar-item-text sidebar-link">Running Constraint Scan</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.3_analyse_constraint_scan.html" class="sidebar-item-text sidebar-link">Analysing the results of the constraint scan</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Running and analysing alternative flux modes</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4.1_generate_alternative_flux_modes_matrix.html" class="sidebar-item-text sidebar-link">Alternative Flux Modes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4.2_run_alternative_flux_modes.html" class="sidebar-item-text sidebar-link">Run alternative flux modes simulations</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4.3_analyse_alternative_flux_modes.html" class="sidebar-item-text sidebar-link">Analysing alternative flux modes</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  prep_plant_cell.ipynb
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">functions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/alternativemodes.html" class="sidebar-item-text sidebar-link">alternativemodes</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/analysing.html" class="sidebar-item-text sidebar-link">Analysing</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/buildingediting.html" class="sidebar-item-text sidebar-link">buildingediting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/constraintscan.html" class="sidebar-item-text sidebar-link">constraintscan</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/helper.html" class="sidebar-item-text sidebar-link">Helper functions</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/osmolyteconstraints.html" class="sidebar-item-text sidebar-link">osmolyteconstraints</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./functions/solving.html" class="sidebar-item-text sidebar-link">solving</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#import-solutions-and-set-up-dataframes" id="toc-import-solutions-and-set-up-dataframes" class="nav-link" data-scroll-target="#import-solutions-and-set-up-dataframes">Import solutions and set up dataframes</a>
  <ul class="collapse">
  <li><a href="#check-were-in-a-good-range-for-the-solver" id="toc-check-were-in-a-good-range-for-the-solver" class="nav-link" data-scroll-target="#check-were-in-a-good-range-for-the-solver">Check we’re in a good range for the solver</a></li>
  </ul></li>
  <li><a href="#plotting-linker-fluxes" id="toc-plotting-linker-fluxes" class="nav-link" data-scroll-target="#plotting-linker-fluxes">Plotting Linker fluxes</a></li>
  <li><a href="#plotting-before-and-after-opening" id="toc-plotting-before-and-after-opening" class="nav-link" data-scroll-target="#plotting-before-and-after-opening">Plotting before and after opening</a></li>
  <li><a href="#flux-maps" id="toc-flux-maps" class="nav-link" data-scroll-target="#flux-maps">Flux maps</a></li>
  <li><a href="#bits-and-bobs-for-paper" id="toc-bits-and-bobs-for-paper" class="nav-link" data-scroll-target="#bits-and-bobs-for-paper">Bits and bobs for paper</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/noahsprent/mmon-gcm/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Analysing solutions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> itertools</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xml.etree.ElementTree <span class="im">as</span> ET</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cobra</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.patches <span class="im">as</span> mpatches</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> SVG</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.ticker <span class="im">import</span> MultipleLocator</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mmon_gcm.analysing <span class="im">import</span> get_escher_map</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mmon_gcm.supermodel <span class="im">import</span> SuperModel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sns.set_theme()</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>sns.set_style(<span class="st">"ticks"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>sns.set_palette(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    sns.color_palette(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        [</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#332288"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#88CCEE"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#44AA99"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#117733"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#999933"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#DDCC77"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#CC6677"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#882255"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>            <span class="st">"#AA4499"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>colours <span class="op">=</span> sns.color_palette()</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"xtick.labelsize"</span>: <span class="st">"large"</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ytick.labelsize"</span>: <span class="st">"large"</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"axes.labelsize"</span>: <span class="st">"large"</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"axes.titlesize"</span>: <span class="st">"x-large"</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"axes.labelweight"</span>: <span class="st">"bold"</span>,</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"axes.titleweight"</span>: <span class="st">"bold"</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"font.weight"</span>: <span class="st">"bold"</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"axes.spines.right"</span>: <span class="va">False</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"axes.spines.top"</span>: <span class="va">False</span>,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"legend.frameon"</span>: <span class="va">False</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>plt.rcParams.update(params)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_multiphase_fluxes(df, reaction):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    reaction_phased <span class="op">=</span> [<span class="ss">f"</span><span class="sc">{</span>reaction<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>)]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    selected_df <span class="op">=</span> df.loc[reaction_phased, <span class="st">"fluxes"</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> selected_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_phases_to_times(df, phase_times<span class="op">=</span>[<span class="dv">6</span>, <span class="fl">6.5</span>, <span class="dv">18</span>, <span class="dv">24</span>]):</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    df.index <span class="op">=</span> pd.MultiIndex.from_tuples(</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        [(row[<span class="dv">0</span>], phase_times[row[<span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span>]) <span class="cf">for</span> row <span class="kw">in</span> df.index], names<span class="op">=</span>df.index.names</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.reorder_levels([<span class="st">"Phase"</span>, <span class="st">"Reaction"</span>]).sort_index()</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.append(pd.concat([df.loc[<span class="dv">24</span>]], keys<span class="op">=</span>[<span class="dv">0</span>]))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.sort_index()</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> df.reorder_levels([<span class="st">"Reaction"</span>, <span class="st">"Phase"</span>]).sort_index()</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> select_volume_based_on_id(reaction_id, SuperModel):</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    total_gc_volume <span class="op">=</span> SuperModel.get_volumes(per_guard_cell<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"total"</span> <span class="kw">in</span> reaction_id:</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        phase_volumes <span class="op">=</span> total_gc_volume <span class="op">=</span> SuperModel.get_volumes(per_guard_cell<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">"v_gc"</span> <span class="kw">in</span> reaction_id:</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        phase_volumes <span class="op">=</span> total_gc_volume <span class="op">=</span> (</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>            SuperModel.get_volumes(per_guard_cell<span class="op">=</span><span class="va">False</span>) <span class="op">*</span> SuperModel.Vac_frac</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">"c_gc"</span> <span class="kw">in</span> reaction_id:</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        phase_volumes <span class="op">=</span> total_gc_volume <span class="op">=</span> SuperModel.get_volumes(</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>            per_guard_cell<span class="op">=</span><span class="va">False</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>        ) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> SuperModel.Vac_frac)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="st">"p_gc"</span> <span class="kw">in</span> reaction_id:</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        phase_volumes <span class="op">=</span> [<span class="dv">1</span>] <span class="op">*</span> <span class="dv">4</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="ss">f"Don't know how to deal with </span><span class="sc">{</span>reaction_id<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> phase_volumes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_conc(row, SuperModel, phases_in_df<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">6</span>, <span class="fl">6.5</span>, <span class="dv">18</span>, <span class="dv">24</span>]):</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    phase <span class="op">=</span> row.name[<span class="dv">1</span>]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    phase_conversion_dict <span class="op">=</span> {</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>        phases_in_df[<span class="dv">0</span>]: <span class="dv">4</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>        phases_in_df[<span class="dv">1</span>]: <span class="dv">1</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>        phases_in_df[<span class="dv">2</span>]: <span class="dv">2</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>        phases_in_df[<span class="dv">3</span>]: <span class="dv">3</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>        phases_in_df[<span class="dv">4</span>]: <span class="dv">4</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    phase_volumes <span class="op">=</span> select_volume_based_on_id(row.name[<span class="dv">0</span>], SuperModel)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>    volume_for_phase <span class="op">=</span> phase_volumes[phase_conversion_dict[phase] <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> row <span class="op">/</span> volume_for_phase</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_metabolite_df(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    solutions_df, concentrations<span class="op">=</span><span class="va">True</span>, total_mets<span class="op">=</span><span class="va">None</span>, SuperModel<span class="op">=</span><span class="va">None</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> total_mets <span class="op">==</span> <span class="va">None</span>:</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        total_mets <span class="op">=</span> [<span class="st">"SUCROSE"</span>, <span class="st">"GLC"</span>, <span class="st">"MAL"</span>, <span class="st">"FRU"</span>, <span class="st">"K"</span>, <span class="st">"Cl"</span>, <span class="st">"CIT"</span>]</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    total_mets_reactions <span class="op">=</span> [met <span class="op">+</span> <span class="st">"_total_pseudolinker"</span> <span class="cf">for</span> met <span class="kw">in</span> total_mets] <span class="op">+</span> [</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">"STARCH_p_gc_Linker"</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    total_mets_reactions_phased <span class="op">=</span> [</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>reaction<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>) <span class="cf">for</span> reaction <span class="kw">in</span> total_mets_reactions</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    met_df <span class="op">=</span> (solutions_df.loc[total_mets_reactions]).copy()</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># change index to phase times instead of tags</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    met_df <span class="op">=</span> convert_phases_to_times(met_df)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> concentrations <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        met_df <span class="op">=</span> met_df.<span class="bu">apply</span>(convert_to_conc, args<span class="op">=</span>([SuperModel]), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    met_df <span class="op">=</span> met_df.reorder_levels([<span class="st">"Phase"</span>, <span class="st">"Reaction"</span>]).sort_index()</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    met_df.index <span class="op">=</span> pd.MultiIndex.from_tuples(</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>        [(index[<span class="dv">0</span>], index[<span class="dv">1</span>].split(<span class="st">"_"</span>)[<span class="dv">0</span>]) <span class="cf">for</span> index <span class="kw">in</span> met_df.index],</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        names<span class="op">=</span>met_df.index.names,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> met_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_closed_open_values(met_df_mm, light, atpase):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    open_closed_dict <span class="op">=</span> {}</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> genotype <span class="kw">in</span> [<span class="st">"wt"</span>, <span class="st">"starchko"</span>]:</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        open_closed_dict[genotype] <span class="op">=</span> {}</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>        open_closed_dict[genotype][<span class="st">"closed"</span>] <span class="op">=</span> met_df_mm.loc[</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>            <span class="op">~</span>(met_df_mm.index <span class="op">==</span> (<span class="dv">6</span>, <span class="st">"STARCH"</span>))</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        ].loc[<span class="dv">6</span>, (light, atpase, genotype, <span class="st">"fluxes"</span>)]</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        open_closed_dict[genotype][<span class="st">"open"</span>] <span class="op">=</span> met_df_mm.loc[</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">~</span>(met_df_mm.index <span class="op">==</span> (<span class="fl">6.5</span>, <span class="st">"STARCH"</span>))</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>        ].loc[<span class="fl">6.5</span>, (light, atpase, genotype, <span class="st">"fluxes"</span>)]</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> open_closed_dict</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_closed_open_values(met_df_mm, light, atpase):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    open_closed_dict <span class="op">=</span> {}</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> genotype <span class="kw">in</span> [<span class="st">"wt"</span>, <span class="st">"starchko"</span>]:</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        open_closed_dict[genotype] <span class="op">=</span> {}</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        open_closed_dict[genotype][<span class="st">"closed"</span>] <span class="op">=</span> met_df_mm.loc[</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>            <span class="dv">6</span>, (light, atpase, genotype, <span class="st">"fluxes"</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>        open_closed_dict[genotype][<span class="st">"open"</span>] <span class="op">=</span> met_df_mm.loc[</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>            <span class="fl">6.5</span>, (light, atpase, genotype, <span class="st">"fluxes"</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> open_closed_dict</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_totals_plot(specific_met_df):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    colours <span class="op">=</span> [<span class="st">"#999999ff"</span>, <span class="st">"#ff7043ff"</span>]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    mpl.rcParams[<span class="st">"hatch.linewidth"</span>] <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">4</span>), gridspec_kw<span class="op">=</span>{<span class="st">"width_ratios"</span>: [<span class="dv">7</span>, <span class="dv">1</span>]})</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    closed_metabolite_df <span class="op">=</span> specific_met_df.loc[<span class="fl">6.0</span>].drop(<span class="st">"STARCH"</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    open_metabolite_df <span class="op">=</span> specific_met_df.loc[<span class="fl">6.5</span>].drop(<span class="st">"STARCH"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot wt</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].bar(</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        np.array(<span class="bu">range</span>(<span class="bu">len</span>(closed_metabolite_df))) <span class="op">*</span> <span class="dv">2</span> <span class="op">-</span> <span class="fl">0.05</span>,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>        closed_metabolite_df[<span class="st">"wt"</span>],</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>colours[<span class="dv">0</span>],</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=-</span><span class="fl">0.3</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        align<span class="op">=</span><span class="st">"edge"</span>,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span>colours[<span class="dv">0</span>],</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].bar(</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>        np.array(<span class="bu">range</span>(<span class="bu">len</span>(open_metabolite_df))) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">0.05</span>,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        open_metabolite_df[<span class="st">"wt"</span>],</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>colours[<span class="dv">1</span>],</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>        align<span class="op">=</span><span class="st">"edge"</span>,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span>colours[<span class="dv">1</span>],</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].bar(</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>        np.array(<span class="bu">range</span>(<span class="bu">len</span>(closed_metabolite_df))) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> <span class="fl">0.05</span>,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        closed_metabolite_df[<span class="st">"starchko"</span>],</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>colours[<span class="dv">0</span>],</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=-</span><span class="fl">0.3</span>,</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>        align<span class="op">=</span><span class="st">"edge"</span>,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span><span class="st">"white"</span>,</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>        hatch<span class="op">=</span><span class="st">"//"</span>,</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].bar(</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>        np.array(<span class="bu">range</span>(<span class="bu">len</span>(closed_metabolite_df))) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> <span class="fl">0.05</span>,</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>        open_metabolite_df[<span class="st">"starchko"</span>],</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>colours[<span class="dv">1</span>],</span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>        align<span class="op">=</span><span class="st">"edge"</span>,</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span><span class="st">"white"</span>,</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>        hatch<span class="op">=</span><span class="st">"//"</span>,</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].bar(</span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>        np.array(<span class="bu">range</span>(<span class="bu">len</span>(closed_metabolite_df))) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">-</span> <span class="fl">0.05</span>,</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>        closed_metabolite_df[<span class="st">"starchko"</span>],</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"none"</span>,</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=-</span><span class="fl">0.3</span>,</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>        align<span class="op">=</span><span class="st">"edge"</span>,</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span>colours[<span class="dv">0</span>],</span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].bar(</span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>        np.array(<span class="bu">range</span>(<span class="bu">len</span>(closed_metabolite_df))) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">+</span> <span class="fl">0.05</span>,</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>        open_metabolite_df[<span class="st">"starchko"</span>],</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span><span class="st">"none"</span>,</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>        align<span class="op">=</span><span class="st">"edge"</span>,</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span>colours[<span class="dv">1</span>],</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>    x_ticks_pad <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].tick_params(axis<span class="op">=</span><span class="st">"x"</span>, which<span class="op">=</span><span class="st">"both"</span>, bottom<span class="op">=</span><span class="va">False</span>, pad<span class="op">=</span>x_ticks_pad)</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].tick_params(axis<span class="op">=</span><span class="st">"x"</span>, which<span class="op">=</span><span class="st">"both"</span>, bottom<span class="op">=</span><span class="va">False</span>, pad<span class="op">=</span>x_ticks_pad)</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>    starch_closed <span class="op">=</span> specific_met_df.loc[(<span class="fl">6.0</span>, <span class="st">"STARCH"</span>)]</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>    starch_open <span class="op">=</span> specific_met_df.loc[(<span class="fl">6.5</span>, <span class="st">"STARCH"</span>)]</span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].bar(</span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>        <span class="op">-</span><span class="fl">0.05</span>,</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>        starch_closed[<span class="st">"wt"</span>],</span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=-</span><span class="fl">0.3</span>,</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>        align<span class="op">=</span><span class="st">"edge"</span>,</span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span>colours[<span class="dv">0</span>],</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>colours[<span class="dv">0</span>],</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].bar(</span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>        <span class="fl">0.05</span>,</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>        starch_open[<span class="st">"wt"</span>],</span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>        align<span class="op">=</span><span class="st">"edge"</span>,</span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span>colours[<span class="dv">1</span>],</span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>colours[<span class="dv">1</span>],</span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].bar(</span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span> <span class="op">-</span> <span class="fl">0.05</span>,</span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>        starch_closed[<span class="st">"starchko"</span>],</span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=-</span><span class="fl">0.3</span>,</span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>        align<span class="op">=</span><span class="st">"edge"</span>,</span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span>colours[<span class="dv">0</span>],</span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>colours[<span class="dv">0</span>],</span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>        hatch<span class="op">=</span><span class="st">"//"</span>,</span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].bar(</span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a>        <span class="dv">1</span> <span class="op">+</span> <span class="fl">0.05</span>,</span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>        starch_open[<span class="st">"starchko"</span>],</span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a>        width<span class="op">=</span><span class="fl">0.3</span>,</span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a>        align<span class="op">=</span><span class="st">"edge"</span>,</span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a>        edgecolor<span class="op">=</span>colours[<span class="dv">1</span>],</span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a>        color<span class="op">=</span>colours[<span class="dv">1</span>],</span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a>        hatch<span class="op">=</span><span class="st">"//"</span>,</span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a>    main_x_tick_labels <span class="op">=</span> [</span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a>        name[<span class="dv">0</span>] <span class="op">+</span> name[<span class="dv">1</span>:<span class="dv">3</span>].lower() <span class="cf">for</span> name <span class="kw">in</span> open_metabolite_df.index</span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a>    main_x_tick_labels_superscripted <span class="op">=</span> []</span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> label <span class="kw">in</span> main_x_tick_labels:</span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> label <span class="op">==</span> <span class="st">"K"</span>:</span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a>            new_label <span class="op">=</span> <span class="vs">r"K$^+$"</span></span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> label <span class="op">==</span> <span class="st">"Cl"</span>:</span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a>            new_label <span class="op">=</span> <span class="vs">r"Cl$^-$"</span></span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a>            new_label <span class="op">=</span> label</span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a>        main_x_tick_labels_superscripted.append(new_label)</span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a>    main_x_tick_labels <span class="op">=</span> main_x_tick_labels_superscripted</span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a>    main_x_ticks <span class="op">=</span> np.array(<span class="bu">range</span>(<span class="bu">len</span>(closed_metabolite_df))) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">0.5</span></span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a>    ax0_y_max <span class="op">=</span> <span class="dv">60</span></span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].set_xticks(main_x_ticks)</span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].set_xticklabels(main_x_tick_labels)</span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].set_ylim(<span class="op">-</span><span class="fl">0.1</span>, ax0_y_max)</span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].set_xlim(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">13.5</span>)</span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].set_ylabel(<span class="vs">r"Osmolyte concentration (mM)"</span>)</span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">0</span>].yaxis.set_major_locator(MultipleLocator(<span class="dv">10</span>))</span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a>    <span class="co"># axs[0].yaxis.set_minor_locator(AutoMinorLocator(2))</span></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x_loc <span class="kw">in</span> [(x <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">1.5</span> <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(closed_metabolite_df))]:</span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a>        axs[<span class="dv">0</span>].hlines(</span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span><span class="fl">3.7</span>, x_loc <span class="op">+</span> <span class="fl">0.1</span>, x_loc <span class="op">+</span> <span class="fl">1.9</span>, clip_on<span class="op">=</span><span class="va">False</span>, color<span class="op">=</span><span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.9</span></span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> offset, label <span class="kw">in</span> <span class="bu">zip</span>([<span class="fl">0.5</span>, <span class="fl">1.5</span>], [<span class="st">"WT"</span>, <span class="st">"KO"</span>]):</span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a>            axs[<span class="dv">0</span>].text(</span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a>                x_loc <span class="op">+</span> offset, <span class="op">-</span><span class="dv">2</span>, label, ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"center"</span>, size<span class="op">=</span><span class="st">"small"</span></span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a>    starch_x_tick_labels <span class="op">=</span> [<span class="st">"Starch"</span>]</span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a>    starch_x_ticks <span class="op">=</span> [<span class="fl">0.5</span>]</span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a>    ax1_y_max <span class="op">=</span> <span class="dv">14</span></span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].set_xticks(starch_x_ticks)</span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].set_xticklabels(starch_x_tick_labels)</span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].set_ylim(<span class="op">-</span><span class="fl">0.1</span> <span class="op">*</span> ax1_y_max <span class="op">/</span> ax0_y_max, ax1_y_max)</span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].yaxis.set_label_position(<span class="st">"right"</span>)</span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].yaxis.tick_right()</span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].yaxis.set_major_locator(MultipleLocator(<span class="dv">2</span>))</span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a>    <span class="co"># axs[1].yaxis.set_minor_locator(AutoMinorLocator(2))</span></span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].spines[<span class="st">"right"</span>].set_visible(<span class="va">True</span>)</span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].spines[<span class="st">"left"</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb10-157"><a href="#cb10-157" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>].set_ylabel(<span class="vs">r"Amount (fmol$\cdot$GC$^{-1}$)"</span>)</span>
<span id="cb10-158"><a href="#cb10-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-159"><a href="#cb10-159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x_loc <span class="kw">in</span> [(x <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">1.5</span> <span class="cf">for</span> x <span class="kw">in</span> [<span class="dv">0</span>]]:</span>
<span id="cb10-160"><a href="#cb10-160" aria-hidden="true" tabindex="-1"></a>        axs[<span class="dv">1</span>].hlines(</span>
<span id="cb10-161"><a href="#cb10-161" aria-hidden="true" tabindex="-1"></a>            <span class="op">-</span><span class="fl">3.7</span> <span class="op">*</span> ax1_y_max <span class="op">/</span> ax0_y_max,</span>
<span id="cb10-162"><a href="#cb10-162" aria-hidden="true" tabindex="-1"></a>            x_loc <span class="op">+</span> <span class="fl">0.1</span>,</span>
<span id="cb10-163"><a href="#cb10-163" aria-hidden="true" tabindex="-1"></a>            x_loc <span class="op">+</span> <span class="dv">2</span>,</span>
<span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a>            clip_on<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span><span class="st">"black"</span>,</span>
<span id="cb10-166"><a href="#cb10-166" aria-hidden="true" tabindex="-1"></a>            alpha<span class="op">=</span><span class="fl">0.9</span>,</span>
<span id="cb10-167"><a href="#cb10-167" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb10-168"><a href="#cb10-168" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> offset, label <span class="kw">in</span> <span class="bu">zip</span>([<span class="fl">0.5</span>, <span class="fl">1.5</span>], [<span class="st">"WT"</span>, <span class="st">"KO"</span>]):</span>
<span id="cb10-169"><a href="#cb10-169" aria-hidden="true" tabindex="-1"></a>            axs[<span class="dv">1</span>].text(</span>
<span id="cb10-170"><a href="#cb10-170" aria-hidden="true" tabindex="-1"></a>                x_loc <span class="op">+</span> offset,</span>
<span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a>                <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> ax1_y_max <span class="op">/</span> ax0_y_max,</span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a>                label,</span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a>                ha<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a>                va<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a>                size<span class="op">=</span><span class="st">"small"</span>,</span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-178"><a href="#cb10-178" aria-hidden="true" tabindex="-1"></a>    colors <span class="op">=</span> {<span class="st">"EoN"</span>: <span class="st">"#999999ff"</span>, <span class="st">"30 mins"</span>: <span class="st">"#ff7043ff"</span>}</span>
<span id="cb10-179"><a href="#cb10-179" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> <span class="bu">list</span>(colors.keys())</span>
<span id="cb10-180"><a href="#cb10-180" aria-hidden="true" tabindex="-1"></a>    handles <span class="op">=</span> [plt.Rectangle((<span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">1</span>, <span class="dv">1</span>, color<span class="op">=</span>colors[label]) <span class="cf">for</span> label <span class="kw">in</span> labels]</span>
<span id="cb10-181"><a href="#cb10-181" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plt.legend(handles, labels)</span></span>
<span id="cb10-182"><a href="#cb10-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-183"><a href="#cb10-183" aria-hidden="true" tabindex="-1"></a>    plt.subplots_adjust(wspace<span class="op">=</span><span class="fl">0.05</span>)</span>
<span id="cb10-184"><a href="#cb10-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-185"><a href="#cb10-185" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> getgcdiagram(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    modeldf,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    modelname,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    condition_label,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    genotype_label,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    scale_height,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    minimal<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    flipped<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    display_svg<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    debug<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    brokenaxis<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>    aspser<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>    save_png<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> minimal <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> aspser <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>            tree <span class="op">=</span> ET.parse(<span class="st">"../inputs/fluxmap_template_aspserminimal.svg"</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>            root <span class="op">=</span> tree.getroot</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>            tree <span class="op">=</span> ET.parse(<span class="st">"../inputs/fluxmap_template_minimal.svg"</span>)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>            root <span class="op">=</span> tree.getroot</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>        tree <span class="op">=</span> ET.parse(<span class="st">"../inputs/fluxmap_template.svg"</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>        root <span class="op">=</span> updatetextnames(tree, condition_label, genotype_label, debug<span class="op">=</span>debug)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># get the background and the flipped background, and set the opacity of the wrong one to 0</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    background <span class="op">=</span> getelement(</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>        tree,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>        condition_label<span class="op">=</span>condition_label,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>        genotype_label<span class="op">=</span>genotype_label,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>        compartment_label<span class="op">=</span><span class="st">"Background"</span>,</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>        debug<span class="op">=</span>debug,</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    background_flipped <span class="op">=</span> getelement(</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>        tree,</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>        condition_label<span class="op">=</span>condition_label,</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>        genotype_label<span class="op">=</span>genotype_label,</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>        compartment_label<span class="op">=</span><span class="st">"Background_flipped"</span>,</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>        debug<span class="op">=</span>debug,</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> flipped <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>        updateelementopacity(background, <span class="dv">0</span>)</span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>        updateelementopacity(background_flipped, <span class="dv">1</span>)</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>        updateelementopacity(background, <span class="dv">1</span>)</span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>        updateelementopacity(background_flipped, <span class="dv">0</span>)</span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> minimal <span class="kw">is</span> <span class="kw">not</span> <span class="va">True</span>:</span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>        <span class="co"># get the scale bar, either keep the hatched or don't, and set the height to the scale conc specified</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> phase_label <span class="kw">in</span> [<span class="st">"EoN"</span>, <span class="st">"30"</span>, <span class="st">"EoN_hatched"</span>, <span class="st">"30_hatched"</span>]:</span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>            scale_bar_element <span class="op">=</span> getelement(</span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>                tree,</span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>                condition_label<span class="op">=</span>condition_label,</span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>                genotype_label<span class="op">=</span>genotype_label,</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>                compartment_label<span class="op">=</span><span class="st">"other"</span>,</span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>                metabolite_label<span class="op">=</span><span class="st">"scale"</span>,</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>                phase_label<span class="op">=</span>phase_label,</span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>                debug<span class="op">=</span>debug,</span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">"hatched"</span> <span class="kw">in</span> phase_label:</span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>                updateelementopacity(scale_bar_element, <span class="bu">int</span>(flipped))</span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>                updateelementopacity(scale_bar_element, <span class="bu">int</span>(<span class="kw">not</span> flipped))</span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>            updateelementheight(scale_bar_element, scale_height)</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> modeldf.iterrows():</span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>        compartment_label <span class="op">=</span> row[<span class="dv">0</span>][<span class="dv">1</span>]</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>        metabolite_label <span class="op">=</span> row[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-72"><a href="#cb11-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> debug <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb11-73"><a href="#cb11-73" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(row[<span class="dv">0</span>], row[<span class="dv">1</span>])</span>
<span id="cb11-74"><a href="#cb11-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-75"><a href="#cb11-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb11-76"><a href="#cb11-76" aria-hidden="true" tabindex="-1"></a>            eon_element <span class="op">=</span> getelement(</span>
<span id="cb11-77"><a href="#cb11-77" aria-hidden="true" tabindex="-1"></a>                tree,</span>
<span id="cb11-78"><a href="#cb11-78" aria-hidden="true" tabindex="-1"></a>                condition_label<span class="op">=</span>condition_label,</span>
<span id="cb11-79"><a href="#cb11-79" aria-hidden="true" tabindex="-1"></a>                genotype_label<span class="op">=</span>genotype_label,</span>
<span id="cb11-80"><a href="#cb11-80" aria-hidden="true" tabindex="-1"></a>                compartment_label<span class="op">=</span>compartment_label,</span>
<span id="cb11-81"><a href="#cb11-81" aria-hidden="true" tabindex="-1"></a>                metabolite_label<span class="op">=</span>metabolite_label,</span>
<span id="cb11-82"><a href="#cb11-82" aria-hidden="true" tabindex="-1"></a>                phase_label<span class="op">=</span><span class="st">"EoN"</span>,</span>
<span id="cb11-83"><a href="#cb11-83" aria-hidden="true" tabindex="-1"></a>                debug<span class="op">=</span>debug,</span>
<span id="cb11-84"><a href="#cb11-84" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb11-85"><a href="#cb11-85" aria-hidden="true" tabindex="-1"></a>            thirty_element <span class="op">=</span> getelement(</span>
<span id="cb11-86"><a href="#cb11-86" aria-hidden="true" tabindex="-1"></a>                tree,</span>
<span id="cb11-87"><a href="#cb11-87" aria-hidden="true" tabindex="-1"></a>                condition_label<span class="op">=</span>condition_label,</span>
<span id="cb11-88"><a href="#cb11-88" aria-hidden="true" tabindex="-1"></a>                genotype_label<span class="op">=</span>genotype_label,</span>
<span id="cb11-89"><a href="#cb11-89" aria-hidden="true" tabindex="-1"></a>                compartment_label<span class="op">=</span>compartment_label,</span>
<span id="cb11-90"><a href="#cb11-90" aria-hidden="true" tabindex="-1"></a>                metabolite_label<span class="op">=</span>metabolite_label,</span>
<span id="cb11-91"><a href="#cb11-91" aria-hidden="true" tabindex="-1"></a>                phase_label<span class="op">=</span><span class="st">"30"</span>,</span>
<span id="cb11-92"><a href="#cb11-92" aria-hidden="true" tabindex="-1"></a>                debug<span class="op">=</span>debug,</span>
<span id="cb11-93"><a href="#cb11-93" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb11-94"><a href="#cb11-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-95"><a href="#cb11-95" aria-hidden="true" tabindex="-1"></a>            eon_element_hatched <span class="op">=</span> getelement(</span>
<span id="cb11-96"><a href="#cb11-96" aria-hidden="true" tabindex="-1"></a>                tree,</span>
<span id="cb11-97"><a href="#cb11-97" aria-hidden="true" tabindex="-1"></a>                condition_label<span class="op">=</span>condition_label,</span>
<span id="cb11-98"><a href="#cb11-98" aria-hidden="true" tabindex="-1"></a>                genotype_label<span class="op">=</span>genotype_label,</span>
<span id="cb11-99"><a href="#cb11-99" aria-hidden="true" tabindex="-1"></a>                compartment_label<span class="op">=</span>compartment_label,</span>
<span id="cb11-100"><a href="#cb11-100" aria-hidden="true" tabindex="-1"></a>                metabolite_label<span class="op">=</span>metabolite_label,</span>
<span id="cb11-101"><a href="#cb11-101" aria-hidden="true" tabindex="-1"></a>                phase_label<span class="op">=</span><span class="st">"EoN_hatched"</span>,</span>
<span id="cb11-102"><a href="#cb11-102" aria-hidden="true" tabindex="-1"></a>                debug<span class="op">=</span>debug,</span>
<span id="cb11-103"><a href="#cb11-103" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb11-104"><a href="#cb11-104" aria-hidden="true" tabindex="-1"></a>            thirty_element_hatched <span class="op">=</span> getelement(</span>
<span id="cb11-105"><a href="#cb11-105" aria-hidden="true" tabindex="-1"></a>                tree,</span>
<span id="cb11-106"><a href="#cb11-106" aria-hidden="true" tabindex="-1"></a>                condition_label<span class="op">=</span>condition_label,</span>
<span id="cb11-107"><a href="#cb11-107" aria-hidden="true" tabindex="-1"></a>                genotype_label<span class="op">=</span>genotype_label,</span>
<span id="cb11-108"><a href="#cb11-108" aria-hidden="true" tabindex="-1"></a>                compartment_label<span class="op">=</span>compartment_label,</span>
<span id="cb11-109"><a href="#cb11-109" aria-hidden="true" tabindex="-1"></a>                metabolite_label<span class="op">=</span>metabolite_label,</span>
<span id="cb11-110"><a href="#cb11-110" aria-hidden="true" tabindex="-1"></a>                phase_label<span class="op">=</span><span class="st">"30_hatched"</span>,</span>
<span id="cb11-111"><a href="#cb11-111" aria-hidden="true" tabindex="-1"></a>                debug<span class="op">=</span>debug,</span>
<span id="cb11-112"><a href="#cb11-112" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb11-113"><a href="#cb11-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-114"><a href="#cb11-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> flipped <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb11-115"><a href="#cb11-115" aria-hidden="true" tabindex="-1"></a>                updateelementopacity(eon_element, <span class="dv">0</span>)</span>
<span id="cb11-116"><a href="#cb11-116" aria-hidden="true" tabindex="-1"></a>                updateelementopacity(eon_element_hatched, <span class="dv">1</span>)</span>
<span id="cb11-117"><a href="#cb11-117" aria-hidden="true" tabindex="-1"></a>                updateelementopacity(thirty_element, <span class="dv">0</span>)</span>
<span id="cb11-118"><a href="#cb11-118" aria-hidden="true" tabindex="-1"></a>                updateelementopacity(thirty_element_hatched, <span class="dv">1</span>)</span>
<span id="cb11-119"><a href="#cb11-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb11-120"><a href="#cb11-120" aria-hidden="true" tabindex="-1"></a>                updateelementopacity(eon_element, <span class="dv">1</span>)</span>
<span id="cb11-121"><a href="#cb11-121" aria-hidden="true" tabindex="-1"></a>                updateelementopacity(eon_element_hatched, <span class="dv">0</span>)</span>
<span id="cb11-122"><a href="#cb11-122" aria-hidden="true" tabindex="-1"></a>                updateelementopacity(thirty_element, <span class="dv">1</span>)</span>
<span id="cb11-123"><a href="#cb11-123" aria-hidden="true" tabindex="-1"></a>                updateelementopacity(thirty_element_hatched, <span class="dv">0</span>)</span>
<span id="cb11-124"><a href="#cb11-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-125"><a href="#cb11-125" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> row[<span class="dv">1</span>][<span class="st">"EoN"</span>] <span class="op">&lt;=</span> <span class="fl">0.0001</span>:</span>
<span id="cb11-126"><a href="#cb11-126" aria-hidden="true" tabindex="-1"></a>                updateelementheight(eon_element, <span class="fl">0.5</span>)</span>
<span id="cb11-127"><a href="#cb11-127" aria-hidden="true" tabindex="-1"></a>                updateelementheight(eon_element_hatched, <span class="fl">0.5</span>)</span>
<span id="cb11-128"><a href="#cb11-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb11-129"><a href="#cb11-129" aria-hidden="true" tabindex="-1"></a>                updateelementheight(eon_element, row[<span class="dv">1</span>][<span class="st">"EoN"</span>])</span>
<span id="cb11-130"><a href="#cb11-130" aria-hidden="true" tabindex="-1"></a>                updateelementheight(eon_element_hatched, row[<span class="dv">1</span>][<span class="st">"EoN"</span>])</span>
<span id="cb11-131"><a href="#cb11-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-132"><a href="#cb11-132" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> row[<span class="dv">1</span>][<span class="st">"30 mins"</span>] <span class="op">&lt;=</span> <span class="fl">0.0001</span>:</span>
<span id="cb11-133"><a href="#cb11-133" aria-hidden="true" tabindex="-1"></a>                updateelementheight(thirty_element, <span class="fl">0.5</span>)</span>
<span id="cb11-134"><a href="#cb11-134" aria-hidden="true" tabindex="-1"></a>                updateelementheight(thirty_element_hatched, <span class="fl">0.5</span>)</span>
<span id="cb11-135"><a href="#cb11-135" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb11-136"><a href="#cb11-136" aria-hidden="true" tabindex="-1"></a>                updateelementheight(thirty_element, row[<span class="dv">1</span>][<span class="st">"30 mins"</span>])</span>
<span id="cb11-137"><a href="#cb11-137" aria-hidden="true" tabindex="-1"></a>                updateelementheight(thirty_element_hatched, row[<span class="dv">1</span>][<span class="st">"30 mins"</span>])</span>
<span id="cb11-138"><a href="#cb11-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-139"><a href="#cb11-139" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">AttributeError</span>:</span>
<span id="cb11-140"><a href="#cb11-140" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>row[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> not in template"</span>)</span>
<span id="cb11-141"><a href="#cb11-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-142"><a href="#cb11-142" aria-hidden="true" tabindex="-1"></a>    svgpath <span class="op">=</span> <span class="ss">f"../outputs/flux_maps/</span><span class="sc">{</span>modelname<span class="sc">}</span><span class="ss">.svg"</span></span>
<span id="cb11-143"><a href="#cb11-143" aria-hidden="true" tabindex="-1"></a>    tree.write(svgpath, encoding<span class="op">=</span><span class="st">"UTF-8"</span>, xml_declaration<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb11-144"><a href="#cb11-144" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> display_svg <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb11-145"><a href="#cb11-145" aria-hidden="true" tabindex="-1"></a>        display(SVG(svgpath))</span>
<span id="cb11-146"><a href="#cb11-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-147"><a href="#cb11-147" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> svgpath</span>
<span id="cb11-148"><a href="#cb11-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-149"><a href="#cb11-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-150"><a href="#cb11-150" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> getelement(</span>
<span id="cb11-151"><a href="#cb11-151" aria-hidden="true" tabindex="-1"></a>    tree,</span>
<span id="cb11-152"><a href="#cb11-152" aria-hidden="true" tabindex="-1"></a>    condition_label,</span>
<span id="cb11-153"><a href="#cb11-153" aria-hidden="true" tabindex="-1"></a>    genotype_label<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb11-154"><a href="#cb11-154" aria-hidden="true" tabindex="-1"></a>    compartment_label<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb11-155"><a href="#cb11-155" aria-hidden="true" tabindex="-1"></a>    metabolite_label<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb11-156"><a href="#cb11-156" aria-hidden="true" tabindex="-1"></a>    phase_label<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb11-157"><a href="#cb11-157" aria-hidden="true" tabindex="-1"></a>    debug<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb11-158"><a href="#cb11-158" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb11-159"><a href="#cb11-159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> debug <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb11-160"><a href="#cb11-160" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(</span>
<span id="cb11-161"><a href="#cb11-161" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Trying: "</span>,</span>
<span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a>            condition_label,</span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a>            genotype_label,</span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a>            compartment_label,</span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a>            metabolite_label,</span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a>            phase_label,</span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> tree.getroot()</span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> debug <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"Got root"</span>, end<span class="op">=</span><span class="st">" "</span>)</span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> condition <span class="kw">in</span> root.findall(<span class="st">"{http://www.w3.org/2000/svg}g"</span>):</span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (</span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a>            condition.get(<span class="st">"{http://www.inkscape.org/namespaces/inkscape}label"</span>)</span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a>            <span class="op">==</span> <span class="st">"condition"</span></span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a>        ):</span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> debug <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(condition_label, end<span class="op">=</span><span class="st">" "</span>)</span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> genotype_label <span class="op">==</span> <span class="va">None</span>:</span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> conditon</span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> genotype <span class="kw">in</span> condition:</span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> (</span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a>                        genotype.get(</span>
<span id="cb11-184"><a href="#cb11-184" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"{http://www.inkscape.org/namespaces/inkscape}label"</span></span>
<span id="cb11-185"><a href="#cb11-185" aria-hidden="true" tabindex="-1"></a>                        )</span>
<span id="cb11-186"><a href="#cb11-186" aria-hidden="true" tabindex="-1"></a>                        <span class="op">==</span> <span class="st">"genotype"</span></span>
<span id="cb11-187"><a href="#cb11-187" aria-hidden="true" tabindex="-1"></a>                    ):</span>
<span id="cb11-188"><a href="#cb11-188" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> debug <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb11-189"><a href="#cb11-189" aria-hidden="true" tabindex="-1"></a>                            <span class="bu">print</span>(genotype_label, end<span class="op">=</span><span class="st">" "</span>)</span>
<span id="cb11-190"><a href="#cb11-190" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> compartment_label <span class="op">==</span> <span class="va">None</span>:</span>
<span id="cb11-191"><a href="#cb11-191" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">return</span> genotype</span>
<span id="cb11-192"><a href="#cb11-192" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">else</span>:</span>
<span id="cb11-193"><a href="#cb11-193" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">for</span> compartment <span class="kw">in</span> genotype:</span>
<span id="cb11-194"><a href="#cb11-194" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> (</span>
<span id="cb11-195"><a href="#cb11-195" aria-hidden="true" tabindex="-1"></a>                                    compartment.get(</span>
<span id="cb11-196"><a href="#cb11-196" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">"{http://www.inkscape.org/namespaces/inkscape}label"</span></span>
<span id="cb11-197"><a href="#cb11-197" aria-hidden="true" tabindex="-1"></a>                                    )</span>
<span id="cb11-198"><a href="#cb11-198" aria-hidden="true" tabindex="-1"></a>                                    <span class="op">==</span> compartment_label</span>
<span id="cb11-199"><a href="#cb11-199" aria-hidden="true" tabindex="-1"></a>                                ):</span>
<span id="cb11-200"><a href="#cb11-200" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">if</span> debug <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb11-201"><a href="#cb11-201" aria-hidden="true" tabindex="-1"></a>                                        <span class="bu">print</span>(compartment_label, end<span class="op">=</span><span class="st">" "</span>)</span>
<span id="cb11-202"><a href="#cb11-202" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">if</span> metabolite_label <span class="op">==</span> <span class="va">None</span>:</span>
<span id="cb11-203"><a href="#cb11-203" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">return</span> compartment</span>
<span id="cb11-204"><a href="#cb11-204" aria-hidden="true" tabindex="-1"></a>                                    <span class="cf">else</span>:</span>
<span id="cb11-205"><a href="#cb11-205" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">for</span> metabolite <span class="kw">in</span> compartment:</span>
<span id="cb11-206"><a href="#cb11-206" aria-hidden="true" tabindex="-1"></a>                                            <span class="cf">if</span> (</span>
<span id="cb11-207"><a href="#cb11-207" aria-hidden="true" tabindex="-1"></a>                                                metabolite.get(</span>
<span id="cb11-208"><a href="#cb11-208" aria-hidden="true" tabindex="-1"></a>                                                    <span class="st">"{http://www.inkscape.org/namespaces/inkscape}label"</span></span>
<span id="cb11-209"><a href="#cb11-209" aria-hidden="true" tabindex="-1"></a>                                                )</span>
<span id="cb11-210"><a href="#cb11-210" aria-hidden="true" tabindex="-1"></a>                                                <span class="op">==</span> metabolite_label</span>
<span id="cb11-211"><a href="#cb11-211" aria-hidden="true" tabindex="-1"></a>                                            ):</span>
<span id="cb11-212"><a href="#cb11-212" aria-hidden="true" tabindex="-1"></a>                                                <span class="cf">if</span> debug <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb11-213"><a href="#cb11-213" aria-hidden="true" tabindex="-1"></a>                                                    <span class="bu">print</span>(metabolite_label, end<span class="op">=</span><span class="st">" "</span>)</span>
<span id="cb11-214"><a href="#cb11-214" aria-hidden="true" tabindex="-1"></a>                                                <span class="cf">if</span> phase_label <span class="op">==</span> <span class="va">None</span>:</span>
<span id="cb11-215"><a href="#cb11-215" aria-hidden="true" tabindex="-1"></a>                                                    <span class="cf">return</span> metabolite</span>
<span id="cb11-216"><a href="#cb11-216" aria-hidden="true" tabindex="-1"></a>                                                <span class="cf">else</span>:</span>
<span id="cb11-217"><a href="#cb11-217" aria-hidden="true" tabindex="-1"></a>                                                    <span class="cf">for</span> phase <span class="kw">in</span> metabolite:</span>
<span id="cb11-218"><a href="#cb11-218" aria-hidden="true" tabindex="-1"></a>                                                        <span class="cf">if</span> (</span>
<span id="cb11-219"><a href="#cb11-219" aria-hidden="true" tabindex="-1"></a>                                                            phase.get(</span>
<span id="cb11-220"><a href="#cb11-220" aria-hidden="true" tabindex="-1"></a>                                                                <span class="st">"{http://www.inkscape.org/namespaces/inkscape}label"</span></span>
<span id="cb11-221"><a href="#cb11-221" aria-hidden="true" tabindex="-1"></a>                                                            )</span>
<span id="cb11-222"><a href="#cb11-222" aria-hidden="true" tabindex="-1"></a>                                                            <span class="op">==</span> phase_label</span>
<span id="cb11-223"><a href="#cb11-223" aria-hidden="true" tabindex="-1"></a>                                                        ):</span>
<span id="cb11-224"><a href="#cb11-224" aria-hidden="true" tabindex="-1"></a>                                                            <span class="cf">return</span> phase</span>
<span id="cb11-225"><a href="#cb11-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-226"><a href="#cb11-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-227"><a href="#cb11-227" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> updateelementopacity(element, opacity):</span>
<span id="cb11-228"><a href="#cb11-228" aria-hidden="true" tabindex="-1"></a>    style_attribs <span class="op">=</span> element.attrib[<span class="st">"style"</span>].split(<span class="st">";"</span>)</span>
<span id="cb11-229"><a href="#cb11-229" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, style <span class="kw">in</span> <span class="bu">enumerate</span>(style_attribs):</span>
<span id="cb11-230"><a href="#cb11-230" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> re.match(<span class="vs">r"^opacity"</span>, style):</span>
<span id="cb11-231"><a href="#cb11-231" aria-hidden="true" tabindex="-1"></a>            <span class="kw">del</span> style_attribs[i]</span>
<span id="cb11-232"><a href="#cb11-232" aria-hidden="true" tabindex="-1"></a>    style_attribs.append(<span class="st">"opacity:"</span> <span class="op">+</span> <span class="bu">str</span>(opacity))</span>
<span id="cb11-233"><a href="#cb11-233" aria-hidden="true" tabindex="-1"></a>    element.attrib[<span class="st">"style"</span>] <span class="op">=</span> <span class="st">";"</span>.join(style_attribs)</span>
<span id="cb11-234"><a href="#cb11-234" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> element</span>
<span id="cb11-235"><a href="#cb11-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-236"><a href="#cb11-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-237"><a href="#cb11-237" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> updateelementheight(element, height):</span>
<span id="cb11-238"><a href="#cb11-238" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb11-239"><a href="#cb11-239" aria-hidden="true" tabindex="-1"></a>        element.attrib[<span class="st">"height"</span>]</span>
<span id="cb11-240"><a href="#cb11-240" aria-hidden="true" tabindex="-1"></a>        element.attrib[<span class="st">"height"</span>] <span class="op">=</span> <span class="bu">str</span>(height)</span>
<span id="cb11-241"><a href="#cb11-241" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb11-242"><a href="#cb11-242" aria-hidden="true" tabindex="-1"></a>        element.attrib[<span class="st">"d"</span>] <span class="op">=</span> (</span>
<span id="cb11-243"><a href="#cb11-243" aria-hidden="true" tabindex="-1"></a>            element.attrib[<span class="st">"d"</span>].split(<span class="st">"v"</span>)[<span class="dv">0</span>]</span>
<span id="cb11-244"><a href="#cb11-244" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> <span class="st">"v -"</span></span>
<span id="cb11-245"><a href="#cb11-245" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> <span class="bu">str</span>(height)</span>
<span id="cb11-246"><a href="#cb11-246" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> <span class="st">" h"</span></span>
<span id="cb11-247"><a href="#cb11-247" aria-hidden="true" tabindex="-1"></a>            <span class="op">+</span> element.attrib[<span class="st">"d"</span>].split(<span class="st">"h"</span>)[<span class="dv">1</span>]</span>
<span id="cb11-248"><a href="#cb11-248" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb11-249"><a href="#cb11-249" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> element</span>
<span id="cb11-250"><a href="#cb11-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-251"><a href="#cb11-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-252"><a href="#cb11-252" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> updatetextnames(tree, condition_label, genotype_label, debug<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb11-253"><a href="#cb11-253" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> tree.getroot()</span>
<span id="cb11-254"><a href="#cb11-254" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> condition <span class="kw">in</span> root.findall(<span class="st">"{http://www.w3.org/2000/svg}g"</span>):</span>
<span id="cb11-255"><a href="#cb11-255" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (</span>
<span id="cb11-256"><a href="#cb11-256" aria-hidden="true" tabindex="-1"></a>            condition.get(<span class="st">"{http://www.inkscape.org/namespaces/inkscape}label"</span>)</span>
<span id="cb11-257"><a href="#cb11-257" aria-hidden="true" tabindex="-1"></a>            <span class="op">==</span> <span class="st">"condition"</span></span>
<span id="cb11-258"><a href="#cb11-258" aria-hidden="true" tabindex="-1"></a>        ):</span>
<span id="cb11-259"><a href="#cb11-259" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> genotype <span class="kw">in</span> condition:</span>
<span id="cb11-260"><a href="#cb11-260" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (</span>
<span id="cb11-261"><a href="#cb11-261" aria-hidden="true" tabindex="-1"></a>                    genotype.get(<span class="st">"{http://www.inkscape.org/namespaces/inkscape}label"</span>)</span>
<span id="cb11-262"><a href="#cb11-262" aria-hidden="true" tabindex="-1"></a>                    <span class="op">==</span> <span class="st">"condition_name"</span></span>
<span id="cb11-263"><a href="#cb11-263" aria-hidden="true" tabindex="-1"></a>                ):</span>
<span id="cb11-264"><a href="#cb11-264" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> tspan <span class="kw">in</span> genotype:</span>
<span id="cb11-265"><a href="#cb11-265" aria-hidden="true" tabindex="-1"></a>                        tspan.text <span class="op">=</span> condition_label</span>
<span id="cb11-266"><a href="#cb11-266" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> debug <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb11-267"><a href="#cb11-267" aria-hidden="true" tabindex="-1"></a>                            <span class="bu">print</span>(<span class="st">"Condition label changed to "</span> <span class="op">+</span> tspan.text)</span>
<span id="cb11-268"><a href="#cb11-268" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> (</span>
<span id="cb11-269"><a href="#cb11-269" aria-hidden="true" tabindex="-1"></a>                    genotype.get(<span class="st">"{http://www.inkscape.org/namespaces/inkscape}label"</span>)</span>
<span id="cb11-270"><a href="#cb11-270" aria-hidden="true" tabindex="-1"></a>                    <span class="op">==</span> <span class="st">"genotype"</span></span>
<span id="cb11-271"><a href="#cb11-271" aria-hidden="true" tabindex="-1"></a>                ):</span>
<span id="cb11-272"><a href="#cb11-272" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> compartment <span class="kw">in</span> genotype:</span>
<span id="cb11-273"><a href="#cb11-273" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> (</span>
<span id="cb11-274"><a href="#cb11-274" aria-hidden="true" tabindex="-1"></a>                            compartment.get(</span>
<span id="cb11-275"><a href="#cb11-275" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"{http://www.inkscape.org/namespaces/inkscape}label"</span></span>
<span id="cb11-276"><a href="#cb11-276" aria-hidden="true" tabindex="-1"></a>                            )</span>
<span id="cb11-277"><a href="#cb11-277" aria-hidden="true" tabindex="-1"></a>                            <span class="op">==</span> <span class="st">"genotype_name"</span></span>
<span id="cb11-278"><a href="#cb11-278" aria-hidden="true" tabindex="-1"></a>                        ):</span>
<span id="cb11-279"><a href="#cb11-279" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">for</span> tspan <span class="kw">in</span> compartment:</span>
<span id="cb11-280"><a href="#cb11-280" aria-hidden="true" tabindex="-1"></a>                                tspan.text <span class="op">=</span> genotype_label</span>
<span id="cb11-281"><a href="#cb11-281" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">if</span> debug <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb11-282"><a href="#cb11-282" aria-hidden="true" tabindex="-1"></a>                                    <span class="bu">print</span>(<span class="st">"Genotype label changed to "</span> <span class="op">+</span> tspan.text)</span>
<span id="cb11-283"><a href="#cb11-283" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">return</span> root</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>parameters_df <span class="op">=</span> pd.read_csv(<span class="st">"../inputs/arabidopsis_parameters.csv"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>four_stage_GC_model <span class="op">=</span> cobra.io.sbml.read_sbml_model(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"../models/4_stage_GC.xml"</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>)  <span class="co"># read model</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>arabidopsis_supermodel <span class="op">=</span> SuperModel(</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    parameters_df.loc[:, <span class="st">"Value"</span>], fba_model<span class="op">=</span>four_stage_GC_model</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>No objective coefficients in model. Unclear what should be optimized
/home/nls119/src/mmon-gcm2/mmon_gcm/supermodel.py:25: FutureWarning: iteritems is deprecated and will be removed in a future version. Use .items instead.
  for parameter, value in parameters.iteritems():</code></pre>
</div>
</div>
</section>
<section id="import-solutions-and-set-up-dataframes" class="level2">
<h2 class="anchored" data-anchor-id="import-solutions-and-set-up-dataframes">Import solutions and set up dataframes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>solutions_dict <span class="op">=</span> {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">file</span>[:<span class="op">-</span><span class="dv">4</span>]: pd.read_csv(<span class="ss">f"../outputs/model_solutions/</span><span class="sc">{</span><span class="bu">file</span><span class="sc">}</span><span class="ss">"</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="bu">file</span> <span class="kw">in</span> os.listdir(<span class="st">"../outputs/model_solutions"</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">file</span>.endswith(<span class="st">".csv"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="check-were-in-a-good-range-for-the-solver" class="level3">
<h3 class="anchored" data-anchor-id="check-were-in-a-good-range-for-the-solver">Check we’re in a good range for the solver</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>maxes <span class="op">=</span> {}</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>mins <span class="op">=</span> {}</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, solution <span class="kw">in</span> solutions_dict.items():</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    maxes[name] <span class="op">=</span> <span class="bu">abs</span>(solution.loc[:, <span class="st">"fluxes"</span>]).<span class="bu">max</span>()</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    mins[name] <span class="op">=</span> <span class="bu">abs</span>(</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        solution.loc[:, <span class="st">"fluxes"</span>][<span class="bu">abs</span>(solution.loc[:, <span class="st">"fluxes"</span>]) <span class="op">&gt;</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">8</span>]</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    ).<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mins</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>{'blue_constrained_starchko': 1.5247677265731132e-05,
 'blue_unconstrained_wt': 2.517235510636032e-07,
 'white_constrained_wt': 3.27322847631833e-05,
 'nops_unconstrained_wt': 0.0001811893409185,
 'nops_constrained_wt': 2.1471018822492425e-05,
 'nops_constrained_starchko': 3.72070755724131e-05,
 'blue_constrained_wt': 2.334144094270074e-05,
 'white_constrained_starchko': 4.4613154721834365e-05,
 'white_unconstrained_starchko': 3.898122362004467e-05,
 'white_unconstrained_wt': 3.898124962407721e-05,
 'blue_unconstrained_starchko': 1.5552293266882112e-08,
 'nops_unconstrained_starchko': 0.0001811893409177}</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="bu">abs</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    solutions_dict[<span class="st">"blue_unconstrained_wt"</span>].loc[:, <span class="st">"fluxes"</span>][</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">abs</span>(solutions_dict[<span class="st">"blue_unconstrained_wt"</span>].loc[:, <span class="st">"fluxes"</span>]) <span class="op">&gt;</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">8</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>).sort_values()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>NITRATE_c_gc_Linker_2                             2.517236e-07
NITRATE_c_gc_Linker_3                             2.517236e-07
NITRATE_c_gc_Linker_4                             2.517236e-07
NITRATE_c_gc_Linker_1                             2.517236e-07
PEPCARBOX_RXN_c_gc_3                              6.941965e-05
                                                      ...     
PLASTOQUINOL_PLASTOCYANIN_REDUCTASE_RXN_p_me_3    1.214771e+02
RXN490_3650_p_me_3                                2.429542e+02
EX_X_Photon_t_me_3                                4.859084e+02
Photon_tx_me_3                                    4.859084e+02
Photon_ep_me_3                                    4.859084e+02
Name: fluxes, Length: 981, dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="bu">abs</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    solutions_dict[<span class="st">"blue_unconstrained_starchko"</span>].loc[:, <span class="st">"fluxes"</span>][</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">abs</span>(solutions_dict[<span class="st">"blue_unconstrained_starchko"</span>].loc[:, <span class="st">"fluxes"</span>]) <span class="op">&gt;</span> <span class="dv">10</span><span class="op">**-</span><span class="dv">8</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>).sort_values()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>NITRATE_c_gc_Linker_1                             1.555229e-08
NITRATE_c_gc_Linker_2                             1.555229e-08
NITRATE_c_gc_Linker_3                             1.555229e-08
NITRATE_c_gc_Linker_4                             1.555229e-08
2PGADEHYDRAT_RXN_p_gc_3                           6.942203e-05
                                                      ...     
PLASTOQUINOL_PLASTOCYANIN_REDUCTASE_RXN_p_me_3    1.214771e+02
RXN490_3650_p_me_3                                2.429542e+02
EX_X_Photon_t_me_3                                4.859084e+02
Photon_tx_me_3                                    4.859084e+02
Photon_ep_me_3                                    4.859084e+02
Name: fluxes, Length: 979, dtype: float64</code></pre>
</div>
</div>
<p>With solver tolerance of 10-8 we treat any fluxes below that value as being effectively 0, and this doesn’t include any fluxes we’re interested in. They’re 10-5 and above, so there is a difference of three orders of magnitude.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>conditions_permutations <span class="op">=</span> [</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"nops"</span>],</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"unconstrained"</span>, <span class="st">"constrained"</span>],</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"wt"</span>, <span class="st">"starchko"</span>],</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"fluxes"</span>, <span class="st">"minimum"</span>, <span class="st">"maximum"</span>],</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>solutions_df_columns <span class="op">=</span> pd.MultiIndex.from_product(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    conditions_permutations, names<span class="op">=</span>[<span class="st">"Light"</span>, <span class="st">"ATPase"</span>, <span class="st">"Starch"</span>, <span class="st">"Solution"</span>]</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>solutions_df <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>solutions_df_columns)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>conditions_list_of_lists <span class="op">=</span> [</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"nops"</span>],</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"unconstrained"</span>, <span class="st">"constrained"</span>],</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    [<span class="st">"wt"</span>, <span class="st">"starchko"</span>],</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>conditions_iterations <span class="op">=</span> <span class="bu">list</span>(itertools.product(<span class="op">*</span>conditions_list_of_lists))</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>cols_to_drop <span class="op">=</span> []</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> conditions <span class="kw">in</span> conditions_iterations:</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    light_condition, atpase_condition, starch_condition <span class="op">=</span> conditions</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>    file_name <span class="op">=</span> <span class="ss">f"../outputs/model_solutions/</span><span class="sc">{</span>light_condition<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>atpase_condition<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>starch_condition<span class="sc">}</span><span class="ss">.csv"</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>        condition_df <span class="op">=</span> pd.read_csv(file_name, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col <span class="kw">in</span> [<span class="st">"fluxes"</span>, <span class="st">"minimum"</span>, <span class="st">"maximum"</span>]:</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>            solutions_df.loc[</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>                :, (light_condition, atpase_condition, starch_condition, col)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>            ] <span class="op">=</span> condition_df.loc[:, col]</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span>:</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>        cols_to_drop.append(conditions)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"File </span><span class="sc">{</span>file_name<span class="sc">}</span><span class="ss"> doesn't exist, skipping"</span>)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>solutions_df_unphased <span class="op">=</span> solutions_df.copy()</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>index_phased <span class="op">=</span> pd.MultiIndex.from_tuples(</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>        (reaction[:<span class="op">-</span><span class="dv">2</span>], <span class="bu">int</span>(reaction[<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> reaction[<span class="op">-</span><span class="dv">1</span>] <span class="kw">in</span> [<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>]</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> (reaction, <span class="va">None</span>)</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> reaction <span class="kw">in</span> solutions_df.index</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>    names<span class="op">=</span>[<span class="st">"Reaction"</span>, <span class="st">"Phase"</span>],</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>solutions_df.index <span class="op">=</span> index_phased</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>solutions_df <span class="op">=</span> solutions_df.drop(cols_to_drop, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/2276567288.py:27: DeprecationWarning: In a future version, `df.iloc[:, i] = newvals` will attempt to set the values inplace instead of always setting a new array. To retain the old behavior, use either `df[df.columns[i]] = newvals` or, if columns are non-unique, `df.isetitem(i, newvals)`
  solutions_df.loc[
/tmp/ipykernel_374830/2276567288.py:27: DeprecationWarning: In a future version, `df.iloc[:, i] = newvals` will attempt to set the values inplace instead of always setting a new array. To retain the old behavior, use either `df[df.columns[i]] = newvals` or, if columns are non-unique, `df.isetitem(i, newvals)`
  solutions_df.loc[
/tmp/ipykernel_374830/2276567288.py:27: DeprecationWarning: In a future version, `df.iloc[:, i] = newvals` will attempt to set the values inplace instead of always setting a new array. To retain the old behavior, use either `df[df.columns[i]] = newvals` or, if columns are non-unique, `df.isetitem(i, newvals)`
  solutions_df.loc[
/tmp/ipykernel_374830/2276567288.py:27: DeprecationWarning: In a future version, `df.iloc[:, i] = newvals` will attempt to set the values inplace instead of always setting a new array. To retain the old behavior, use either `df[df.columns[i]] = newvals` or, if columns are non-unique, `df.isetitem(i, newvals)`
  solutions_df.loc[
/tmp/ipykernel_374830/2276567288.py:27: DeprecationWarning: In a future version, `df.iloc[:, i] = newvals` will attempt to set the values inplace instead of always setting a new array. To retain the old behavior, use either `df[df.columns[i]] = newvals` or, if columns are non-unique, `df.isetitem(i, newvals)`
  solutions_df.loc[
/tmp/ipykernel_374830/2276567288.py:27: DeprecationWarning: In a future version, `df.iloc[:, i] = newvals` will attempt to set the values inplace instead of always setting a new array. To retain the old behavior, use either `df[df.columns[i]] = newvals` or, if columns are non-unique, `df.isetitem(i, newvals)`
  solutions_df.loc[
/tmp/ipykernel_374830/2276567288.py:27: DeprecationWarning: In a future version, `df.iloc[:, i] = newvals` will attempt to set the values inplace instead of always setting a new array. To retain the old behavior, use either `df[df.columns[i]] = newvals` or, if columns are non-unique, `df.isetitem(i, newvals)`
  solutions_df.loc[
/tmp/ipykernel_374830/2276567288.py:27: DeprecationWarning: In a future version, `df.iloc[:, i] = newvals` will attempt to set the values inplace instead of always setting a new array. To retain the old behavior, use either `df[df.columns[i]] = newvals` or, if columns are non-unique, `df.isetitem(i, newvals)`
  solutions_df.loc[
/tmp/ipykernel_374830/2276567288.py:27: DeprecationWarning: In a future version, `df.iloc[:, i] = newvals` will attempt to set the values inplace instead of always setting a new array. To retain the old behavior, use either `df[df.columns[i]] = newvals` or, if columns are non-unique, `df.isetitem(i, newvals)`
  solutions_df.loc[
/tmp/ipykernel_374830/2276567288.py:27: DeprecationWarning: In a future version, `df.iloc[:, i] = newvals` will attempt to set the values inplace instead of always setting a new array. To retain the old behavior, use either `df[df.columns[i]] = newvals` or, if columns are non-unique, `df.isetitem(i, newvals)`
  solutions_df.loc[
/tmp/ipykernel_374830/2276567288.py:27: DeprecationWarning: In a future version, `df.iloc[:, i] = newvals` will attempt to set the values inplace instead of always setting a new array. To retain the old behavior, use either `df[df.columns[i]] = newvals` or, if columns are non-unique, `df.isetitem(i, newvals)`
  solutions_df.loc[
/tmp/ipykernel_374830/2276567288.py:27: DeprecationWarning: In a future version, `df.iloc[:, i] = newvals` will attempt to set the values inplace instead of always setting a new array. To retain the old behavior, use either `df[df.columns[i]] = newvals` or, if columns are non-unique, `df.isetitem(i, newvals)`
  solutions_df.loc[</code></pre>
</div>
</div>
</section>
</section>
<section id="plotting-linker-fluxes" class="level2">
<h2 class="anchored" data-anchor-id="plotting-linker-fluxes">Plotting Linker fluxes</h2>
<p>All gc osmolytes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_linkers_df(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    solutions_df,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    concentrations<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    osmolytes_path<span class="op">=</span><span class="st">"../inputs/osmolytes.csv"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    SuperModel<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    osmolytes <span class="op">=</span> pd.read_csv(osmolytes_path, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    gc_osmolytes <span class="op">=</span> [os <span class="cf">for</span> os <span class="kw">in</span> osmolytes.index <span class="cf">if</span> os[<span class="op">-</span><span class="dv">2</span>:] <span class="op">==</span> <span class="st">"gc"</span>]</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    gc_osmolytes_linker_reactions <span class="op">=</span> [os <span class="op">+</span> <span class="st">"_Linker"</span> <span class="cf">for</span> os <span class="kw">in</span> gc_osmolytes]</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    linkers_df <span class="op">=</span> solutions_df.loc[gc_osmolytes_linker_reactions].copy()</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    linkers_df <span class="op">=</span> convert_phases_to_times(linkers_df)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> concentrations <span class="op">==</span> <span class="va">True</span>:</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>        linkers_df <span class="op">=</span> linkers_df.<span class="bu">apply</span>(convert_to_conc, args<span class="op">=</span>([SuperModel]), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    linkers_df <span class="op">=</span> linkers_df.reorder_levels([<span class="st">"Phase"</span>, <span class="st">"Reaction"</span>]).sort_index()</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    index_key <span class="op">=</span> {<span class="st">"p"</span>: <span class="st">"Chloroplast"</span>, <span class="st">"v"</span>: <span class="st">"Vacuole"</span>, <span class="st">"c"</span>: <span class="st">"Cytoplasm"</span>}</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>    linkers_df.index <span class="op">=</span> pd.MultiIndex.from_tuples(</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>        [</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>                index[<span class="dv">0</span>],</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">"_"</span>.join(index[<span class="dv">1</span>].split(<span class="st">"_"</span>)[:<span class="op">-</span><span class="dv">3</span>]),</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>                index_key[index[<span class="dv">1</span>].split(<span class="st">"_"</span>)[<span class="op">-</span><span class="dv">3</span>]],</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> index <span class="kw">in</span> linkers_df.index</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>        ],</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>        names<span class="op">=</span>linkers_df.index.names <span class="op">+</span> [<span class="st">"Compartment"</span>],</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> linkers_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>linkers_df <span class="op">=</span> get_linkers_df(solutions_df, SuperModel<span class="op">=</span>arabidopsis_supermodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/978925231.py:7: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  df = df.append(pd.concat([df.loc[24]], keys=[0]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>met_df_mm <span class="op">=</span> get_metabolite_df(solutions_df, SuperModel<span class="op">=</span>arabidopsis_supermodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/978925231.py:7: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  df = df.append(pd.concat([df.loc[24]], keys=[0]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>ordered_index <span class="op">=</span> []</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> phase <span class="kw">in</span> [<span class="fl">0.0</span>, <span class="fl">6.0</span>, <span class="fl">6.5</span>, <span class="fl">18.0</span>, <span class="fl">24.0</span>]:</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> met <span class="kw">in</span> [<span class="st">"K"</span>, <span class="st">"Cl"</span>, <span class="st">"SUCROSE"</span>, <span class="st">"GLC"</span>, <span class="st">"FRU"</span>, <span class="st">"MAL"</span>, <span class="st">"CIT"</span>, <span class="st">"STARCH"</span>]:</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>        ordered_index.append((phase, met))</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>pd.MultiIndex.from_tuples(ordered_index)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>met_df_mm <span class="op">=</span> met_df_mm.reindex(ordered_index)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>met_df_mm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="10" halign="left">blue</th>
      <th>...</th>
      <th colspan="10" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="6" halign="left">unconstrained</th>
      <th colspan="4" halign="left">constrained</th>
      <th>...</th>
      <th colspan="4" halign="left">unconstrained</th>
      <th colspan="6" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th colspan="3" halign="left">wt</th>
      <th colspan="3" halign="left">starchko</th>
      <th colspan="3" halign="left">wt</th>
      <th>starchko</th>
      <th>...</th>
      <th>wt</th>
      <th colspan="3" halign="left">starchko</th>
      <th colspan="3" halign="left">wt</th>
      <th colspan="3" halign="left">starchko</th>
    </tr>
    <tr>
      <th></th>
      <th>Solution</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>...</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
    </tr>
    <tr>
      <th>Phase</th>
      <th>Reaction</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="8" valign="top">0.0</th>
      <th>K</th>
      <td>2.223338e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.223338e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.223338e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.223338e+01</td>
      <td>...</td>
      <td>NaN</td>
      <td>2.223338e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.623558e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.396758e+01</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Cl</th>
      <td>2.223223e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.223331e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.779201e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.456769e-14</td>
      <td>...</td>
      <td>NaN</td>
      <td>-3.212964e-12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.404497e-15</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SUCROSE</th>
      <td>8.531006e-12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.588203e-11</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.203986e+01</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.710048e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.124427e+01</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>GLC</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-8.322345e-12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>-2.236757e-13</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>FRU</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.034804e-06</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.863518e-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.859590e-13</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>MAL</th>
      <td>2.414779e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.414862e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.119376e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.303941e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>1.750039e-13</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.287615e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>CIT</th>
      <td>1.007895e-12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.094230e-13</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.576202e-12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.284107e-16</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.552446e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.186282e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>STARCH</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.154663e-03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.976651e-03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">6.0</th>
      <th>K</th>
      <td>2.223338e+01</td>
      <td>0.000000e+00</td>
      <td>129.146199</td>
      <td>2.223338e+01</td>
      <td>5.364309e-16</td>
      <td>129.146199</td>
      <td>2.223338e+01</td>
      <td>0.000000e+00</td>
      <td>129.146199</td>
      <td>2.223338e+01</td>
      <td>...</td>
      <td>129.146199</td>
      <td>2.223338e+01</td>
      <td>0.0</td>
      <td>129.146199</td>
      <td>1.623558e+01</td>
      <td>0.000000e+00</td>
      <td>129.146199</td>
      <td>1.396758e+01</td>
      <td>0.000000e+00</td>
      <td>124.337668</td>
    </tr>
    <tr>
      <th>Cl</th>
      <td>2.223223e+01</td>
      <td>0.000000e+00</td>
      <td>89.290671</td>
      <td>2.223331e+01</td>
      <td>0.000000e+00</td>
      <td>89.290671</td>
      <td>1.779201e+01</td>
      <td>0.000000e+00</td>
      <td>89.290671</td>
      <td>2.456769e-14</td>
      <td>...</td>
      <td>89.290671</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>89.290671</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>89.290671</td>
      <td>-2.404497e-15</td>
      <td>6.793058e-26</td>
      <td>80.389461</td>
    </tr>
    <tr>
      <th>SUCROSE</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>178.581341</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>178.581341</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>178.581341</td>
      <td>3.203986e+01</td>
      <td>...</td>
      <td>178.581341</td>
      <td>-1.634626e-14</td>
      <td>0.0</td>
      <td>178.581341</td>
      <td>1.710048e+01</td>
      <td>0.000000e+00</td>
      <td>178.581341</td>
      <td>3.124427e+01</td>
      <td>0.000000e+00</td>
      <td>178.581341</td>
    </tr>
    <tr>
      <th>GLC</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>178.581341</td>
      <td>1.532076e-15</td>
      <td>0.000000e+00</td>
      <td>178.581341</td>
      <td>-8.322345e-12</td>
      <td>0.000000e+00</td>
      <td>178.581341</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>178.581341</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>178.581341</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>178.581341</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>160.463896</td>
    </tr>
    <tr>
      <th>FRU</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>178.581341</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>178.581341</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>178.581341</td>
      <td>-1.034804e-06</td>
      <td>...</td>
      <td>178.581341</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>178.581341</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>178.581341</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>160.463896</td>
    </tr>
    <tr>
      <th>MAL</th>
      <td>2.414779e+01</td>
      <td>0.000000e+00</td>
      <td>64.494321</td>
      <td>2.414862e+01</td>
      <td>6.028235e-27</td>
      <td>64.494321</td>
      <td>8.119376e+00</td>
      <td>0.000000e+00</td>
      <td>64.494321</td>
      <td>5.303941e+00</td>
      <td>...</td>
      <td>64.494321</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>64.494321</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>64.494321</td>
      <td>7.287615e+00</td>
      <td>0.000000e+00</td>
      <td>64.494321</td>
    </tr>
    <tr>
      <th>CIT</th>
      <td>0.000000e+00</td>
      <td>-1.502669e-11</td>
      <td>49.435142</td>
      <td>-1.164076e-13</td>
      <td>0.000000e+00</td>
      <td>49.435142</td>
      <td>-8.653558e-13</td>
      <td>0.000000e+00</td>
      <td>49.435142</td>
      <td>5.997260e-16</td>
      <td>...</td>
      <td>49.435142</td>
      <td>-5.484840e-29</td>
      <td>0.0</td>
      <td>49.435142</td>
      <td>2.552446e+00</td>
      <td>0.000000e+00</td>
      <td>49.435142</td>
      <td>2.186282e+00</td>
      <td>0.000000e+00</td>
      <td>49.435142</td>
    </tr>
    <tr>
      <th>STARCH</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1000.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>7.154663e-03</td>
      <td>0.000000e+00</td>
      <td>0.304138</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>1000.000000</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>2.976651e-03</td>
      <td>0.000000e+00</td>
      <td>0.279649</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">6.5</th>
      <th>K</th>
      <td>5.134623e+01</td>
      <td>0.000000e+00</td>
      <td>143.220573</td>
      <td>5.134627e+01</td>
      <td>5.737648e-11</td>
      <td>143.220573</td>
      <td>3.640842e+01</td>
      <td>-3.701394e-27</td>
      <td>129.269842</td>
      <td>3.640842e+01</td>
      <td>...</td>
      <td>143.220573</td>
      <td>4.997736e+01</td>
      <td>0.0</td>
      <td>143.220573</td>
      <td>3.119891e+01</td>
      <td>8.523167e-15</td>
      <td>129.269842</td>
      <td>2.922898e+01</td>
      <td>0.000000e+00</td>
      <td>125.093289</td>
    </tr>
    <tr>
      <th>Cl</th>
      <td>5.134524e+01</td>
      <td>0.000000e+00</td>
      <td>108.221407</td>
      <td>5.134621e+01</td>
      <td>0.000000e+00</td>
      <td>108.221407</td>
      <td>3.255078e+01</td>
      <td>0.000000e+00</td>
      <td>94.652468</td>
      <td>1.709714e+01</td>
      <td>...</td>
      <td>108.221407</td>
      <td>3.066608e+01</td>
      <td>0.0</td>
      <td>108.221407</td>
      <td>1.709714e+01</td>
      <td>0.000000e+00</td>
      <td>94.652468</td>
      <td>1.709714e+01</td>
      <td>0.000000e+00</td>
      <td>86.921132</td>
    </tr>
    <tr>
      <th>SUCROSE</th>
      <td>4.083694e-01</td>
      <td>0.000000e+00</td>
      <td>216.442814</td>
      <td>4.083952e-01</td>
      <td>0.000000e+00</td>
      <td>216.442814</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>216.442814</td>
      <td>-5.356596e-14</td>
      <td>...</td>
      <td>216.442814</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>216.442814</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>216.442814</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>138.964049</td>
    </tr>
    <tr>
      <th>GLC</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>216.442814</td>
      <td>1.330718e-15</td>
      <td>0.000000e+00</td>
      <td>216.442814</td>
      <td>2.819572e+01</td>
      <td>0.000000e+00</td>
      <td>216.442814</td>
      <td>2.782890e+01</td>
      <td>...</td>
      <td>216.442814</td>
      <td>-2.027432e-12</td>
      <td>0.0</td>
      <td>216.442814</td>
      <td>2.602939e+01</td>
      <td>0.000000e+00</td>
      <td>216.442814</td>
      <td>2.713788e+01</td>
      <td>0.000000e+00</td>
      <td>216.442814</td>
    </tr>
    <tr>
      <th>FRU</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>216.442814</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>216.442814</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>216.442814</td>
      <td>2.782890e+01</td>
      <td>...</td>
      <td>216.442814</td>
      <td>-2.027432e-12</td>
      <td>0.0</td>
      <td>216.442814</td>
      <td>1.485299e+01</td>
      <td>0.000000e+00</td>
      <td>216.442814</td>
      <td>2.713788e+01</td>
      <td>0.000000e+00</td>
      <td>216.442814</td>
    </tr>
    <tr>
      <th>MAL</th>
      <td>1.782797e+01</td>
      <td>0.000000e+00</td>
      <td>65.116825</td>
      <td>1.782858e+01</td>
      <td>0.000000e+00</td>
      <td>65.116825</td>
      <td>5.994419e+00</td>
      <td>0.000000e+00</td>
      <td>65.116825</td>
      <td>3.915824e+00</td>
      <td>...</td>
      <td>65.116825</td>
      <td>-1.319257e-14</td>
      <td>0.0</td>
      <td>65.116825</td>
      <td>3.325473e+00</td>
      <td>0.000000e+00</td>
      <td>65.116825</td>
      <td>8.228756e+00</td>
      <td>0.000000e+00</td>
      <td>62.368323</td>
    </tr>
    <tr>
      <th>CIT</th>
      <td>9.648151e-13</td>
      <td>0.000000e+00</td>
      <td>44.869080</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>44.869080</td>
      <td>-2.581520e-28</td>
      <td>9.651638e-13</td>
      <td>44.869080</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>44.869080</td>
      <td>1.358935e-14</td>
      <td>0.0</td>
      <td>44.869080</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>44.869080</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>39.253775</td>
    </tr>
    <tr>
      <th>STARCH</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.099944</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.099944</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">18.0</th>
      <th>K</th>
      <td>2.223338e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.223338e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.223338e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.223338e+01</td>
      <td>...</td>
      <td>NaN</td>
      <td>2.223338e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.623558e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.396758e+01</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Cl</th>
      <td>2.223223e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.223331e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.779201e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>-2.669871e-12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-4.272136e-14</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SUCROSE</th>
      <td>8.530463e-12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.240018e-15</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.564578e-11</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.203986e+01</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.710048e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.124427e+01</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>GLC</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>FRU</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.034804e-06</td>
      <td>...</td>
      <td>NaN</td>
      <td>-3.887412e-12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.232265e-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.654689e-13</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>MAL</th>
      <td>2.414779e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.414862e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.119376e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.303941e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>8.329726e-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.118566e-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.287615e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>CIT</th>
      <td>1.007895e-12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.559742e-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>-8.839934e-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.552446e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.186282e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>STARCH</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.154663e-03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.976651e-03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">24.0</th>
      <th>K</th>
      <td>2.223338e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.223338e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.223338e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.223338e+01</td>
      <td>...</td>
      <td>NaN</td>
      <td>2.223338e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.623558e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.396758e+01</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Cl</th>
      <td>2.223223e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.223331e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.779201e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.456769e-14</td>
      <td>...</td>
      <td>NaN</td>
      <td>-3.212964e-12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.404497e-15</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SUCROSE</th>
      <td>8.531006e-12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.588203e-11</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.203986e+01</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.710048e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.124427e+01</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>GLC</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-8.322345e-12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>-2.236757e-13</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>FRU</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.034804e-06</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.863518e-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.859590e-13</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>MAL</th>
      <td>2.414779e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.414862e+01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.119376e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.303941e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>1.750039e-13</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.287615e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>CIT</th>
      <td>1.007895e-12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.094230e-13</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-1.576202e-12</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.284107e-16</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.552446e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.186282e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>STARCH</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.154663e-03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.976651e-03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>40 rows × 36 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>met_df <span class="op">=</span> get_metabolite_df(solutions_df, concentrations<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/978925231.py:7: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.
  df = df.append(pd.concat([df.loc[24]], keys=[0]))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_linkers(df, light):</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    fig, axs <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>), sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x, atpase_condition <span class="kw">in</span> <span class="bu">enumerate</span>([<span class="st">"unconstrained"</span>, <span class="st">"constrained"</span>]):</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> y, starch_condition <span class="kw">in</span> <span class="bu">enumerate</span>([<span class="st">"wt"</span>, <span class="st">"starchko"</span>]):</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>            df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                :, (light, atpase_condition, starch_condition)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>            ].unstack().plot(</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>                title<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span>atpase_condition<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>starch_condition<span class="sc">}</span><span class="ss">"</span>, ax<span class="op">=</span>axs[x][y]</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>            starch_axis <span class="op">=</span> axs[x][y].twinx()</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>            (</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>                df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>                .loc[:, (light, atpase_condition, starch_condition)]</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>                .xs(<span class="st">"STARCH"</span>, level<span class="op">=</span><span class="st">"Reaction"</span>)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>            ).plot(ax<span class="op">=</span>starch_axis, ylim<span class="op">=</span>(<span class="dv">0</span>, <span class="fl">0.01</span>), color<span class="op">=</span><span class="st">"black"</span>)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>            axs[x][y].get_legend().remove()</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    axs[<span class="dv">1</span>][<span class="dv">0</span>].legend(loc<span class="op">=</span><span class="st">"center left"</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">2.3</span>, <span class="fl">1.1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> light <span class="kw">in</span> [<span class="st">"blue"</span>, <span class="st">"white"</span>]:</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    plot_linkers(met_df_mm, light)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-27-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-27-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="plotting-before-and-after-opening" class="level2">
<h2 class="anchored" data-anchor-id="plotting-before-and-after-opening">Plotting before and after opening</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_starch_cols_to_per_gc(row_series, SuperModel, units):</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> row_series.name[<span class="dv">1</span>] <span class="op">==</span> <span class="st">"STARCH"</span>:</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>        n_gcs <span class="op">=</span> SuperModel.N_gcs</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>        row_series_moles <span class="op">=</span> row_series <span class="op">*</span> <span class="dv">10</span> <span class="op">**</span> <span class="op">-</span><span class="dv">3</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>        moles_per_gc <span class="op">=</span> row_series_moles <span class="op">/</span> n_gcs</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>        row_series_converted_to_units <span class="op">=</span> moles_per_gc <span class="op">*</span> (<span class="dv">1</span> <span class="op">/</span> units)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> row_series_converted_to_units</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> row_series</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>femtomoles <span class="op">=</span> <span class="dv">10</span> <span class="op">**</span> <span class="op">-</span><span class="dv">15</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>met_df_mm_starch_fmol_per_gc <span class="op">=</span> met_df_mm.<span class="bu">apply</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    convert_starch_cols_to_per_gc, args<span class="op">=</span>[arabidopsis_supermodel, femtomoles], axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>met_df_mm_starch_fmol_per_gc.xs(<span class="st">"STARCH"</span>, level<span class="op">=</span><span class="st">"Reaction"</span>).xs(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="4" halign="left">white</th>
      <th colspan="4" halign="left">nops</th>
    </tr>
    <tr>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.335626</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.632011</td>
      <td>0.0</td>
      <td>-1.186387e-16</td>
      <td>0.0</td>
      <td>5.132157</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.335626</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.632011</td>
      <td>0.0</td>
      <td>-1.186387e-16</td>
      <td>0.0</td>
      <td>5.132157</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6.5</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>18.0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.335626</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.632011</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>5.132157</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>24.0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.335626</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>11.632011</td>
      <td>0.0</td>
      <td>-1.186387e-16</td>
      <td>0.0</td>
      <td>5.132157</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> light <span class="kw">in</span> [<span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"nops"</span>]:</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> atpase <span class="kw">in</span> [<span class="st">"unconstrained"</span>, <span class="st">"constrained"</span>]:</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        specific_df <span class="op">=</span> met_df_mm_starch_fmol_per_gc.loc[:, (light, atpase)].xs(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>        fig <span class="op">=</span> get_totals_plot(specific_df)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>        plot_name <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>light<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>atpase<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>        fig.savefig(</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"../outputs/total_opening_plots/</span><span class="sc">{</span>plot_name<span class="sc">}</span><span class="ss">.svg"</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>            <span class="bu">format</span><span class="op">=</span><span class="st">"svg"</span>,</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>            bbox_inches<span class="op">=</span><span class="st">"tight"</span>,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>        fig.savefig(</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>            <span class="ss">f"../outputs/total_opening_plots/</span><span class="sc">{</span>plot_name<span class="sc">}</span><span class="ss">.png"</span>,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>            <span class="bu">format</span><span class="op">=</span><span class="st">"png"</span>,</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>            bbox_inches<span class="op">=</span><span class="st">"tight"</span>,</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>            dpi<span class="op">=</span><span class="dv">300</span>,</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>        )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/1926438676.py:3: PerformanceWarning: indexing past lexsort depth may impact performance.
  specific_df = met_df_mm_starch_fmol_per_gc.loc[:, (light, atpase)].xs(
/tmp/ipykernel_374830/1926438676.py:3: PerformanceWarning: indexing past lexsort depth may impact performance.
  specific_df = met_df_mm_starch_fmol_per_gc.loc[:, (light, atpase)].xs(
/tmp/ipykernel_374830/1926438676.py:3: PerformanceWarning: indexing past lexsort depth may impact performance.
  specific_df = met_df_mm_starch_fmol_per_gc.loc[:, (light, atpase)].xs(
/tmp/ipykernel_374830/1926438676.py:3: PerformanceWarning: indexing past lexsort depth may impact performance.
  specific_df = met_df_mm_starch_fmol_per_gc.loc[:, (light, atpase)].xs(
/tmp/ipykernel_374830/1926438676.py:3: PerformanceWarning: indexing past lexsort depth may impact performance.
  specific_df = met_df_mm_starch_fmol_per_gc.loc[:, (light, atpase)].xs(
/tmp/ipykernel_374830/1926438676.py:3: PerformanceWarning: indexing past lexsort depth may impact performance.
  specific_df = met_df_mm_starch_fmol_per_gc.loc[:, (light, atpase)].xs(</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-31-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-31-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-31-output-4.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-31-output-5.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-31-output-6.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-31-output-7.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="flux-maps" class="level2">
<h2 class="anchored" data-anchor-id="flux-maps">Flux maps</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> light <span class="kw">in</span> [<span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"nops"</span>]:</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> atpase <span class="kw">in</span> [<span class="st">"unconstrained"</span>, <span class="st">"constrained"</span>]:</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> starch <span class="kw">in</span> [<span class="st">"wt"</span>, <span class="st">"starchko"</span>]:</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>            model_solution <span class="op">=</span> solutions_df_unphased.loc[</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                :, (light, atpase, starch, <span class="st">"fluxes"</span>)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>            flux_map <span class="op">=</span> get_escher_map(</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>                model_solution,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                <span class="bu">map</span><span class="op">=</span><span class="st">"../inputs/map.json"</span>,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>                json_model<span class="op">=</span><span class="st">"../models/4_stage_GC.json"</span>,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>            flux_map_name <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>light<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>atpase<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>starch<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>            flux_map.save_html(<span class="ss">f"../outputs/escher_maps/</span><span class="sc">{</span>flux_map_name<span class="sc">}</span><span class="ss">.html"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>linkers_met_dict <span class="op">=</span> {</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SUCROSE"</span>: <span class="st">"Suc"</span>,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GLC"</span>: <span class="st">"Glc"</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FRU"</span>: <span class="st">"Fru"</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MAL"</span>: <span class="st">"Mal"</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CIT"</span>: <span class="st">"Cit"</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"L_ASPARTATE"</span>: <span class="st">"Asp"</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SER"</span>: <span class="st">"Ser"</span>,</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>linkers_df.loc[</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    ([<span class="dv">6</span>, <span class="fl">6.5</span>], [<span class="st">"SUCROSE"</span>, <span class="st">"GLC"</span>, <span class="st">"FRU"</span>, <span class="st">"MAL"</span>, <span class="st">"CIT"</span>, <span class="st">"L_ASPARTATE"</span>, <span class="st">"SER"</span>]),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"white"</span>, <span class="st">"constrained"</span>, <span class="st">"starchko"</span>, <span class="st">"fluxes"</span>),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>].unstack(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Phase</th>
      <th>6.0</th>
      <th>6.5</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Compartment</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">SUCROSE</th>
      <th>Cytoplasm</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>Vacuole</th>
      <td>3.464566e+01</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">GLC</th>
      <th>Cytoplasm</th>
      <td>0.000000e+00</td>
      <td>1.010736e+01</td>
    </tr>
    <tr>
      <th>Vacuole</th>
      <td>0.000000e+00</td>
      <td>3.009223e+01</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">FRU</th>
      <th>Cytoplasm</th>
      <td>-2.311596e-15</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>Vacuole</th>
      <td>0.000000e+00</td>
      <td>3.009223e+01</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">MAL</th>
      <th>Cytoplasm</th>
      <td>2.181359e+01</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>Vacuole</th>
      <td>0.000000e+00</td>
      <td>6.281917e+00</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">CIT</th>
      <th>Cytoplasm</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>Vacuole</th>
      <td>0.000000e+00</td>
      <td>-1.467736e-10</td>
    </tr>
    <tr>
      <th>L_ASPARTATE</th>
      <th>Vacuole</th>
      <td>3.099630e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>SER</th>
      <th>Vacuole</th>
      <td>0.000000e+00</td>
      <td>2.692250e+00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>linkers_df.loc[</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>    ([<span class="dv">6</span>, <span class="fl">6.5</span>], [<span class="st">"SUCROSE"</span>, <span class="st">"GLC"</span>, <span class="st">"FRU"</span>, <span class="st">"MAL"</span>, <span class="st">"CIT"</span>, <span class="st">"L_ASPARTATE"</span>, <span class="st">"SER"</span>]),</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    (<span class="st">"white"</span>, <span class="st">"constrained"</span>, <span class="st">"wt"</span>, <span class="st">"fluxes"</span>),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>].unstack(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Phase</th>
      <th>6.0</th>
      <th>6.5</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Compartment</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">SUCROSE</th>
      <th>Cytoplasm</th>
      <td>7.886935e-13</td>
      <td>8.180265e+00</td>
    </tr>
    <tr>
      <th>Vacuole</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">GLC</th>
      <th>Cytoplasm</th>
      <td>0.000000e+00</td>
      <td>1.067769e+02</td>
    </tr>
    <tr>
      <th>Vacuole</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">FRU</th>
      <th>Cytoplasm</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>Vacuole</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">MAL</th>
      <th>Cytoplasm</th>
      <td>0.000000e+00</td>
      <td>3.382845e+01</td>
    </tr>
    <tr>
      <th>Vacuole</th>
      <td>1.063445e+01</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">CIT</th>
      <th>Cytoplasm</th>
      <td>3.221217e-11</td>
      <td>-2.892443e-11</td>
    </tr>
    <tr>
      <th>Vacuole</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>L_ASPARTATE</th>
      <th>Vacuole</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>SER</th>
      <th>Vacuole</th>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> light <span class="kw">in</span> [<span class="st">"blue"</span>, <span class="st">"white"</span>, <span class="st">"nops"</span>]:</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> atpase <span class="kw">in</span> [<span class="st">"unconstrained"</span>, <span class="st">"constrained"</span>]:</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> starch <span class="kw">in</span> [<span class="st">"wt"</span>, <span class="st">"starchko"</span>]:</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>light<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>atpase<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>starch<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>            mets_to_include <span class="op">=</span> [<span class="st">"SUCROSE"</span>, <span class="st">"GLC"</span>, <span class="st">"FRU"</span>, <span class="st">"MAL"</span>, <span class="st">"CIT"</span>, <span class="st">"L_ASPARTATE"</span>, <span class="st">"SER"</span>]</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>            test_df <span class="op">=</span> linkers_df.loc[</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>                (</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>                    [<span class="dv">6</span>, <span class="fl">6.5</span>],</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>                    mets_to_include,</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>                (light, atpase, starch, <span class="st">"fluxes"</span>),</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>            ].unstack(<span class="dv">0</span>)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>            test_df.columns <span class="op">=</span> [<span class="st">"EoN"</span>, <span class="st">"30 mins"</span>]</span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>            test_df.index <span class="op">=</span> pd.MultiIndex.from_tuples(</span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>                [(linkers_met_dict[index[<span class="dv">0</span>]], index[<span class="dv">1</span>]) <span class="cf">for</span> index <span class="kw">in</span> test_df.index]</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>            scaling <span class="op">=</span> <span class="fl">0.4</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>            test_df <span class="op">=</span> test_df <span class="op">*</span> scaling</span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (test_df.loc[[<span class="st">"Asp"</span>, <span class="st">"Ser"</span>]] <span class="op">&gt;</span> <span class="fl">0.0000000001</span>).<span class="bu">sum</span>().<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>                aspser <span class="op">=</span> <span class="va">True</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(test_df)</span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>                aspser <span class="op">=</span> <span class="va">False</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>            scale_conc <span class="op">=</span> <span class="dv">50</span>  <span class="co"># mM</span></span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>            scaled_scale_conc <span class="op">=</span> scale_conc <span class="op">*</span> scaling</span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>            map_name <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>light<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>atpase<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>starch<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> starch <span class="op">==</span> <span class="st">"wt"</span>:</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>                gc_path <span class="op">=</span> getgcdiagram(</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>                    test_df,</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a>                    map_name,</span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>                    atpase,</span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>                    starch,</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>                    scaled_scale_conc,</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>                    flipped<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a>                    aspser<span class="op">=</span>aspser,</span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>                    display_svg<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>                    debug<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>                    brokenaxis<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>                gc_path <span class="op">=</span> getgcdiagram(</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a>                    test_df,</span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>                    map_name,</span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>                    atpase,</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a>                    starch,</span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>                    scaled_scale_conc,</span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>                    flipped<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>                    aspser<span class="op">=</span>aspser,</span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>                    display_svg<span class="op">=</span><span class="va">True</span>,</span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a>                    debug<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a>                    brokenaxis<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-61"><a href="#cb43-61" aria-hidden="true" tabindex="-1"></a>            <span class="co"># doesn't seem to work with hatched</span></span>
<span id="cb43-62"><a href="#cb43-62" aria-hidden="true" tabindex="-1"></a>            <span class="co"># svg_code = open(gc_path, 'rt').read()</span></span>
<span id="cb43-63"><a href="#cb43-63" aria-hidden="true" tabindex="-1"></a>            <span class="co"># svg2png(bytestring=svg_code, write_to=f"../outputs/flux_maps/{map_name}.png", dpi=300)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>blue_unconstrained_wt
('Asp', 'Vacuole') not in template
('Ser', 'Vacuole') not in template</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-36-output-2.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>blue_unconstrained_starchko
('Asp', 'Vacuole') not in template
('Ser', 'Vacuole') not in template</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-36-output-4.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>blue_constrained_wt
('Asp', 'Vacuole') not in template
('Ser', 'Vacuole') not in template</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-36-output-6.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>blue_constrained_starchko
('Asp', 'Vacuole') not in template
('Ser', 'Vacuole') not in template</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-36-output-8.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>white_unconstrained_wt
('Asp', 'Vacuole') not in template
('Ser', 'Vacuole') not in template</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-36-output-10.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>white_unconstrained_starchko
('Asp', 'Vacuole') not in template
('Ser', 'Vacuole') not in template</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-36-output-12.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>white_constrained_wt
('Asp', 'Vacuole') not in template
('Ser', 'Vacuole') not in template</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-36-output-14.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>white_constrained_starchko
                        EoN       30 mins
Suc Cytoplasm  0.000000e+00  0.000000e+00
    Vacuole    1.385826e+01  0.000000e+00
Glc Cytoplasm  0.000000e+00  4.042944e+00
    Vacuole    0.000000e+00  1.203689e+01
Fru Cytoplasm -9.246382e-16  0.000000e+00
    Vacuole    0.000000e+00  1.203689e+01
Mal Cytoplasm  8.725438e+00  0.000000e+00
    Vacuole    0.000000e+00  2.512767e+00
Cit Cytoplasm  0.000000e+00  0.000000e+00
    Vacuole    0.000000e+00 -5.870942e-11
Asp Vacuole    1.239852e+00  0.000000e+00
Ser Vacuole    0.000000e+00  1.076900e+00
('Cit', 'Vacuole') not in template</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-36-output-16.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>nops_unconstrained_wt
('Asp', 'Vacuole') not in template
('Ser', 'Vacuole') not in template</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-36-output-18.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>nops_unconstrained_starchko
('Asp', 'Vacuole') not in template
('Ser', 'Vacuole') not in template</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-36-output-20.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>nops_constrained_wt
('Asp', 'Vacuole') not in template
('Ser', 'Vacuole') not in template</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-36-output-22.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>nops_constrained_starchko
('Asp', 'Vacuole') not in template
('Ser', 'Vacuole') not in template</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-36-output-24.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>blue_phloem_tx_overall_df <span class="op">=</span> solutions_df.loc[<span class="st">"Phloem_tx_overall"</span>, <span class="st">"blue"</span>].xs(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>white_phloem_tx_overall_df <span class="op">=</span> solutions_df.loc[<span class="st">"Phloem_tx_overall"</span>, <span class="st">"white"</span>].xs(</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>blue_phloem_tx_overall_df_wt_unconstrained_corrected <span class="op">=</span> (</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    blue_phloem_tx_overall_df <span class="op">-</span> blue_phloem_tx_overall_df.iloc[<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>blue_phloem_tx_overall_df_wt_unconstrained_corrected <span class="op">=</span> (</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    blue_phloem_tx_overall_df_wt_unconstrained_corrected.mask(</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>        blue_phloem_tx_overall_df_wt_unconstrained_corrected <span class="op">&gt;</span> <span class="op">-</span><span class="fl">0.0000000001</span>, <span class="dv">0</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>blue_phloem_tx_overall_df_wt_unconstrained_corrected_fmol <span class="op">=</span> (</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    blue_phloem_tx_overall_df_wt_unconstrained_corrected</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span> parameters_df.loc[<span class="st">"N_gcs"</span>, <span class="st">"Value"</span>]</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span> <span class="dv">10</span> <span class="op">**</span> <span class="dv">12</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>white_phloem_tx_overall_df_wt_unconstrained_corrected <span class="op">=</span> (</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    white_phloem_tx_overall_df <span class="op">-</span> white_phloem_tx_overall_df.iloc[<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>white_phloem_tx_overall_df_wt_unconstrained_corrected <span class="op">=</span> (</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    white_phloem_tx_overall_df_wt_unconstrained_corrected.mask(</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>        white_phloem_tx_overall_df_wt_unconstrained_corrected <span class="op">&gt;</span> <span class="op">-</span><span class="fl">0.0000000001</span>, <span class="dv">0</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>white_phloem_tx_overall_df_wt_unconstrained_corrected_fmol <span class="op">=</span> (</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    white_phloem_tx_overall_df_wt_unconstrained_corrected</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">/</span> parameters_df.loc[<span class="st">"N_gcs"</span>, <span class="st">"Value"</span>]</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span> <span class="dv">10</span> <span class="op">**</span> <span class="dv">12</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>combined_fmol <span class="op">=</span> pd.concat(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    [</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>        blue_phloem_tx_overall_df_wt_unconstrained_corrected_fmol,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>        white_phloem_tx_overall_df_wt_unconstrained_corrected_fmol,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    ],</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    keys<span class="op">=</span>[<span class="st">"Blue"</span>, <span class="st">"White"</span>],</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>combined_fmol.index <span class="op">=</span> combined_fmol.index.droplevel(<span class="dv">1</span>)</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>combined_fmol</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Blue</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.009728</td>
      <td>-0.030701</td>
    </tr>
    <tr>
      <th>White</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.011841</td>
      <td>-0.037546</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>combined_fmol.plot.bar(ax<span class="op">=</span>ax)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>ax.legend(loc<span class="op">=</span><span class="st">"center left"</span>, bbox_to_anchor<span class="op">=</span>(<span class="dv">1</span>, <span class="fl">0.5</span>))</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Reduction in overall phloem output compared to </span><span class="ch">\n</span><span class="st"> unconstrained WT in specified light(fmol gc$^{-1}$ h$^{-1}$)"</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>fig.set_tight_layout(<span class="va">True</span>)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/efficiency_comparisons/efficiency_comparisons_compared.svg"</span>)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">"../outputs/efficiency_comparisons/efficiency_comparisons_compared.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-41-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> <span class="bu">reduce</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiply_series_by_coefficient(series_object, model, metabolite_id):</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    reaction_id <span class="op">=</span> series_object.name[<span class="dv">0</span>]</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    coefficient <span class="op">=</span> model.reactions.get_by_id(<span class="ss">f"</span><span class="sc">{</span>reaction_id<span class="sc">}</span><span class="ss">_1"</span>).get_coefficient(</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f"</span><span class="sc">{</span>metabolite_id<span class="sc">}</span><span class="ss">_1"</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> coefficient <span class="op">*</span> series_object</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_metabolite_budget(solution_df, metabolite, model):</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>    metabolite_reactions_df <span class="op">=</span> solution_df.loc[</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>        (</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>            [</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>                reaction.<span class="bu">id</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> reaction <span class="kw">in</span> four_stage_GC_model.metabolites.get_by_id(</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>                    <span class="ss">f"</span><span class="sc">{</span>metabolite<span class="sc">}</span><span class="ss">_1"</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>                ).reactions</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>            ],</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>            <span class="bu">slice</span>(<span class="va">None</span>),</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>        :,</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    metabolite_consumed_produced_df <span class="op">=</span> metabolite_reactions_df.<span class="bu">apply</span>(</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>        multiply_series_by_coefficient, args<span class="op">=</span>[model, metabolite], axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> metabolite_consumed_produced_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_relevant_reaction_fluxes(</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>    solution_df,</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    scenarios_to_drop<span class="op">=</span>[(<span class="st">"nops"</span>, <span class="st">"unconstrained"</span>), (<span class="st">"white"</span>, <span class="st">"unconstrained"</span>)],</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    solution_df <span class="op">=</span> solution_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    solution_df <span class="op">=</span> solution_df.loc[</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>        (<span class="bu">abs</span>(solution_df) <span class="op">&gt;</span> <span class="fl">0.00001</span>).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>), :</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    ]  <span class="co"># pick only reactions which have a flux in at least one scenario</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    solution_df[<span class="bu">abs</span>(solution_df) <span class="op">&lt;</span> <span class="fl">0.00001</span>] <span class="op">=</span> <span class="dv">0</span>  <span class="co"># ignore tiny fluxes from solver error</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    solution_df <span class="op">=</span> solution_df.drop(</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>        scenarios_to_drop, axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>    )  <span class="co"># only keep the scenarios that we are interested in</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> solution_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_budget_for_multiple_metabolites(solution_df, metabolites, fba_model):</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    metabolite_dfs <span class="op">=</span> [</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>        get_metabolite_budget(solution_df, metabolite, fba_model)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> metabolite <span class="kw">in</span> metabolites</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>    metabolite_total_df <span class="op">=</span> <span class="bu">reduce</span>(<span class="kw">lambda</span> a, b: a.add(b, fill_value<span class="op">=</span><span class="dv">0</span>), metabolite_dfs)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>    metabolite_total_df <span class="op">=</span> get_relevant_reaction_fluxes(metabolite_total_df)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> metabolite_total_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>atp_metabolites <span class="op">=</span> [</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>    metabolite.<span class="bu">id</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> metabolite <span class="kw">in</span> four_stage_GC_model.metabolites</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"ATP"</span> <span class="kw">in</span> metabolite.<span class="bu">id</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>gc_atp_metabolites <span class="op">=</span> [</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    metabolite[:<span class="op">-</span><span class="dv">2</span>] <span class="cf">for</span> metabolite <span class="kw">in</span> atp_metabolites <span class="cf">if</span> <span class="st">"gc_2"</span> <span class="kw">in</span> metabolite</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>gc_atp_metabolites <span class="op">=</span> [</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    e</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> e <span class="kw">in</span> gc_atp_metabolites</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> e <span class="kw">not</span> <span class="kw">in</span> (<span class="st">"DATP_p_gc"</span>, <span class="st">"PHOSPHORIBOSYL_ATP_p_gc"</span>, <span class="st">"aDATP_p_gc"</span>)</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>atp_budget_df <span class="op">=</span> get_budget_for_multiple_metabolites(</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    solutions_df, gc_atp_metabolites, four_stage_GC_model</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/4037575462.py:11: PerformanceWarning: indexing past lexsort depth may impact performance.
  solution_df = solution_df.drop(</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>nadh_nadph_metabolites <span class="op">=</span> [</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>    metabolite.<span class="bu">id</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> metabolite <span class="kw">in</span> four_stage_GC_model.metabolites</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"NADH"</span> <span class="kw">in</span> metabolite.<span class="bu">id</span> <span class="kw">or</span> <span class="st">"NADPH"</span> <span class="kw">in</span> metabolite.<span class="bu">id</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>gc_nadh_nadph_metabolites <span class="op">=</span> [</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>    metabolite[:<span class="op">-</span><span class="dv">2</span>] <span class="cf">for</span> metabolite <span class="kw">in</span> nadh_nadph_metabolites <span class="cf">if</span> <span class="st">"gc_2"</span> <span class="kw">in</span> metabolite</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>nadh_nadph_budget_df <span class="op">=</span> get_budget_for_multiple_metabolites(</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    solutions_df, gc_nadh_nadph_metabolites, four_stage_GC_model</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/4037575462.py:11: PerformanceWarning: indexing past lexsort depth may impact performance.
  solution_df = solution_df.drop(</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>nadh_nadph_budget_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">1_PERIOD_18_PERIOD_1_PERIOD_2_RXN_p_gc</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.022910</td>
      <td>0.022910</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.022910</td>
      <td>0.022910</td>
      <td>0.022910</td>
      <td>0.022910</td>
      <td>0.022910</td>
      <td>0.022910</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1_PERIOD_2_PERIOD_1_PERIOD_13_RXN_p_gc</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.021037</td>
      <td>-0.019431</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.021569</td>
      <td>-0.021569</td>
      <td>-0.021534</td>
      <td>-0.021405</td>
      <td>-0.021531</td>
      <td>-0.021448</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2OXOGLUTARATEDEH_RXN_m_gc</th>
      <th>2</th>
      <td>0.000768</td>
      <td>0.000768</td>
      <td>0.000537</td>
      <td>0.000351</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.001125</td>
      <td>0.000964</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000021</td>
      <td>0.000037</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">GAPOXNPHOSPHN_RXN_c_gc</th>
      <th>2</th>
      <td>-0.000829</td>
      <td>-0.000829</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000563</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000079</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">GAPOXNPHOSPHN_RXN_p_gc</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.001026</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000046</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>HYDROXYPYRUVATE_REDUCTASE_RXN_NAD_x_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.000045</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">ISOCITRATE_DEHYDROGENASE_NAD_RXN_m_gc</th>
      <th>2</th>
      <td>0.000768</td>
      <td>0.000768</td>
      <td>0.000537</td>
      <td>0.000351</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.001125</td>
      <td>0.000964</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000021</td>
      <td>0.000037</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">MALATE_DEHYDROGENASE_NADPs_RXN_p_gc</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.001873</td>
      <td>-0.003479</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.001341</td>
      <td>-0.001341</td>
      <td>-0.001377</td>
      <td>-0.001505</td>
      <td>-0.001380</td>
      <td>-0.001463</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">MALATE_DEH_RXN_c_gc</th>
      <th>2</th>
      <td>0.000829</td>
      <td>0.000829</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.000563</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.000079</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">MALATE_DEH_RXN_m_gc</th>
      <th>2</th>
      <td>0.000768</td>
      <td>0.000768</td>
      <td>0.000537</td>
      <td>0.000701</td>
      <td>0.002627</td>
      <td>0.002453</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.001272</td>
      <td>0.001272</td>
      <td>0.001353</td>
      <td>0.001490</td>
      <td>0.001347</td>
      <td>0.001463</td>
      <td>0.000141</td>
      <td>0.000158</td>
    </tr>
    <tr>
      <th>MALATE_DEH_RXN_p_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.000046</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>MALATE_DEH_RXN_x_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000045</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>MALIC_NAD_RXN_m_gc</th>
      <th>2</th>
      <td>0.000768</td>
      <td>0.000768</td>
      <td>0.000537</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">NADH_DEHYDROG_A_RXN_mi_gc</th>
      <th>2</th>
      <td>-0.003838</td>
      <td>-0.003838</td>
      <td>-0.002684</td>
      <td>-0.001753</td>
      <td>-0.002627</td>
      <td>-0.002453</td>
      <td>-0.002250</td>
      <td>-0.001927</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.001272</td>
      <td>-0.001272</td>
      <td>-0.001353</td>
      <td>-0.001490</td>
      <td>-0.001347</td>
      <td>-0.001463</td>
      <td>-0.000254</td>
      <td>-0.000312</td>
    </tr>
    <tr>
      <th>PGLYCDEHYDROG_RXN_p_gc</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.001026</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">PYRUVDEH_RXN_m_gc</th>
      <th>2</th>
      <td>0.000768</td>
      <td>0.000768</td>
      <td>0.000537</td>
      <td>0.000351</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000070</td>
      <td>0.000079</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>atp_ordered_by_most_likely_importance <span class="op">=</span> (</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">abs</span>(atp_budget_df)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>    .groupby(by<span class="op">=</span><span class="st">"Reaction"</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">sum</span>()</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    .sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>atp_budget_df_reordered <span class="op">=</span> atp_budget_df.reindex(</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>    atp_ordered_by_most_likely_importance.index, level<span class="op">=</span><span class="st">"Reaction"</span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>nadh_nadph_ordered_by_most_likely_importance <span class="op">=</span> (</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">abs</span>(nadh_nadph_budget_df)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>    .groupby(by<span class="op">=</span><span class="st">"Reaction"</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">sum</span>()</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    .sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>nadh_nadph_budget_df_reordered <span class="op">=</span> nadh_nadph_budget_df.reindex(</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    nadh_nadph_ordered_by_most_likely_importance.index, level<span class="op">=</span><span class="st">"Reaction"</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_fluxes_to_per_guard_cell(series, super_model, units):</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> series <span class="op">*</span> <span class="dv">10</span> <span class="op">**</span> <span class="op">-</span><span class="dv">3</span> <span class="op">/</span> super_model.N_gcs <span class="op">*</span> (<span class="dv">1</span> <span class="op">/</span> units)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>units <span class="op">=</span> <span class="dv">10</span> <span class="op">**</span> <span class="op">-</span><span class="dv">15</span>  <span class="co"># fmol</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>atp_budget_df_reordered_nmoles_gc <span class="op">=</span> atp_budget_df_reordered.<span class="bu">apply</span>(</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    convert_fluxes_to_per_guard_cell, args<span class="op">=</span>[arabidopsis_supermodel, units], axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>nadh_nadph_budget_df_reordered_nmoles_gc <span class="op">=</span> nadh_nadph_budget_df_reordered.<span class="bu">apply</span>(</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    convert_fluxes_to_per_guard_cell, args<span class="op">=</span>[arabidopsis_supermodel, units], axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Carbon movement df generation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>apoplastic_linker_reactions <span class="op">=</span> [</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>    reaction.<span class="bu">id</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> reaction <span class="kw">in</span> four_stage_GC_model.reactions</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"a_Linker"</span> <span class="kw">in</span> reaction.<span class="bu">id</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>get_relevant_reaction_fluxes(</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    solutions_df.loc[(apoplastic_linker_reactions, <span class="bu">slice</span>(<span class="va">None</span>)), :]</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/4037575462.py:11: PerformanceWarning: indexing past lexsort depth may impact performance.
  solution_df = solution_df.drop(</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SUCROSE_a_Linker</th>
      <th>3</th>
      <td>0.010272</td>
      <td>0.010272</td>
      <td>0.006685</td>
      <td>0.006689</td>
      <td>0.007382</td>
      <td>0.007517</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>transfer_reactions <span class="op">=</span> [</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>    reaction.<span class="bu">id</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> reaction <span class="kw">in</span> four_stage_GC_model.reactions</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"ae_gc"</span> <span class="kw">in</span> reaction.<span class="bu">id</span></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>transfer_reactions <span class="op">=</span> [</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    e <span class="cf">for</span> e <span class="kw">in</span> transfer_reactions <span class="cf">if</span> e <span class="kw">not</span> <span class="kw">in</span> (<span class="st">"WATER_ae_gc"</span>, <span class="st">"K_ae_gc"</span>, <span class="st">"Cl_ae_gc"</span>, <span class="st">"NITRATE_ae_gc"</span>)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>transfer_reactions <span class="op">=</span> solutions_df.loc[(transfer_reactions, <span class="bu">slice</span>(<span class="va">None</span>)), :]</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>transfer_reactions <span class="op">=</span> get_relevant_reaction_fluxes(transfer_reactions)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>transfer_reactions.loc[(<span class="st">"GLC_ae_gc"</span>, <span class="dv">2</span>), :] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>transfer_reactions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/4037575462.py:11: PerformanceWarning: indexing past lexsort depth may impact performance.
  solution_df = solution_df.drop(</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">SUCROSE_ae_gc</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.000893</td>
      <td>-0.000893</td>
      <td>-0.000581</td>
      <td>-0.000582</td>
      <td>-0.000642</td>
      <td>-0.000654</td>
      <td>0.000305</td>
      <td>0.000319</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">GLC_ae_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.000622</td>
      <td>-0.000614</td>
      <td>-0.000587</td>
      <td>-0.000554</td>
      <td>-0.000574</td>
      <td>-0.000599</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>transfer_reactions_me <span class="op">=</span> [</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    reaction.<span class="bu">id</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> reaction <span class="kw">in</span> four_stage_GC_model.reactions</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">"ae_me"</span> <span class="kw">in</span> reaction.<span class="bu">id</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>transfer_reactions_me <span class="op">=</span> [</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>    e</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> e <span class="kw">in</span> transfer_reactions_me</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> e</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">not</span> <span class="kw">in</span> (</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">"WATER_ae_me"</span>,</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">"K_ae_me"</span>,</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">"Cl_ae_me"</span>,</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">"NITRATE_ae_me"</span>,</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SULFATE_ae_me"</span>,</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">"AMMONIUM_ae_me"</span>,</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>]</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>transfer_reactions_me <span class="op">=</span> get_relevant_reaction_fluxes(</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>    solutions_df.loc[(transfer_reactions_me, <span class="bu">slice</span>(<span class="va">None</span>)), :]</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>transfer_reactions_me</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/4037575462.py:11: PerformanceWarning: indexing past lexsort depth may impact performance.
  solution_df = solution_df.drop(</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">SUCROSE_ae_me</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.000305</td>
      <td>-0.000319</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.001712</td>
      <td>0.001712</td>
      <td>0.001114</td>
      <td>0.001115</td>
      <td>0.001230</td>
      <td>0.001253</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>GLC_ae_me</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000622</td>
      <td>0.000614</td>
      <td>0.000587</td>
      <td>0.000554</td>
      <td>0.000574</td>
      <td>0.000599</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> adjust_for_hexose_equivalents(series_object):</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    hexose_equivalents <span class="op">=</span> {</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">"GLC"</span>: <span class="dv">1</span>,</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"SUCROSE"</span>: <span class="dv">2</span>,</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"FRU"</span>: <span class="dv">1</span>,</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    metabolite <span class="op">=</span> series_object.name[<span class="dv">0</span>].split(<span class="st">"_"</span>)[<span class="dv">0</span>]</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>    hexose_equivalent <span class="op">=</span> hexose_equivalents[metabolite]</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> series_object <span class="op">*</span> hexose_equivalent</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mmon_gcm.analysing <span class="im">import</span> adjust_for_phases</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>transfer_reactions_me</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">SUCROSE_ae_me</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.000305</td>
      <td>-0.000319</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.001712</td>
      <td>0.001712</td>
      <td>0.001114</td>
      <td>0.001115</td>
      <td>0.001230</td>
      <td>0.001253</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>GLC_ae_me</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000622</td>
      <td>0.000614</td>
      <td>0.000587</td>
      <td>0.000554</td>
      <td>0.000574</td>
      <td>0.000599</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>me_carbon_production_consumption <span class="op">=</span> (</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>    transfer_reactions_me.<span class="bu">apply</span>(adjust_for_phases, args<span class="op">=</span>[four_stage_GC_model], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">apply</span>(adjust_for_hexose_equivalents, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>    .<span class="bu">sum</span>()</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>me_carbon_production_consumption</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
blue   unconstrained  wt         -0.020545
                      starchko   -0.020545
       constrained    wt         -0.020525
                      starchko   -0.020440
white  constrained    wt         -0.021510
                      starchko   -0.021406
nops   constrained    wt          0.000405
                      starchko    0.000455
dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>gc_carbon_production_consumption <span class="op">=</span> (</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>    transfer_reactions.loc[[<span class="st">"GLC_ae_gc"</span>, <span class="st">"SUCROSE_ae_gc"</span>], :].<span class="bu">apply</span>(</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>        adjust_for_phases, args<span class="op">=</span>[four_stage_GC_model], axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    ).<span class="bu">apply</span>(adjust_for_hexose_equivalents, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>gc_carbon_production_consumption</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">GLC_ae_gc</th>
      <th>3</th>
      <td>-0.000000</td>
      <td>-0.000000</td>
      <td>0.007155</td>
      <td>0.007062</td>
      <td>0.006747</td>
      <td>0.006373</td>
      <td>0.006605</td>
      <td>0.006886</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.000000</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">SUCROSE_ae_gc</th>
      <th>2</th>
      <td>-0.000000</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.020545</td>
      <td>0.020545</td>
      <td>0.013370</td>
      <td>0.013379</td>
      <td>0.014764</td>
      <td>0.015033</td>
      <td>-0.007010</td>
      <td>-0.007341</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>gc_carbon_production_consumption_nmoles_gc <span class="op">=</span> gc_carbon_production_consumption.<span class="bu">apply</span>(</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>    convert_fluxes_to_per_guard_cell, args<span class="op">=</span>[arabidopsis_supermodel, units], axis<span class="op">=</span><span class="dv">1</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>atp_colours <span class="op">=</span> {</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"6PFRUCTPHOS_RXN_c_gc"</span>: [<span class="dv">6</span>, <span class="dv">6</span>],  <span class="co"># phosphofructokinase glycolysis</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"FRUCTOKINASE_RXN_c_gc"</span>: [<span class="dv">6</span>, <span class="dv">6</span>],  <span class="co"># fructokinase glycolysis</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GLUC1PADENYLTRANS_RXN_p_gc"</span>: [<span class="dv">8</span>, <span class="dv">8</span>],  <span class="co"># glc1p -&gt; adp glc (starch synthesis)</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GLY3KIN_RXN_p_gc"</span>: [<span class="dv">6</span>, <span class="dv">6</span>],  <span class="co"># g3p -&gt; glycerate (carbon degradation)</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mitochondrial_ATP_Synthase_m_gc"</span>: [<span class="dv">7</span>, <span class="dv">7</span>],  <span class="co"># mitochondrial atp synthase</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"PEPCARBOXYKIN_RXN_c_gc"</span>: [<span class="dv">6</span>, <span class="dv">6</span>],  <span class="co"># OAA -&gt; pyruvate (mal deg)</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"PEPDEPHOS_RXN_c_gc"</span>: [<span class="dv">6</span>, <span class="dv">6</span>],  <span class="co"># PEP -&gt; pyruvate</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"PEPDEPHOS_RXN_p_gc"</span>: [<span class="dv">6</span>, <span class="dv">6</span>],  <span class="co"># PEP -&gt; pyruvate</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"PHOSGLYPHOS_RXN_c_gc"</span>: [<span class="dv">2</span>, <span class="dv">6</span>],  <span class="co"># DPG -&gt; G3p (glycolysis)</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"PHOSGLYPHOS_RXN_p_gc"</span>: [<span class="dv">4</span>, <span class="dv">4</span>],  <span class="co"># DPG -&gt; G3p (glycolysis)</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">"PHOSPHORIBULOKINASE_RXN_p_gc"</span>: [<span class="dv">4</span>, <span class="dv">4</span>],  <span class="co"># calvin cycle</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"PROTONATP_rev_vc_gc"</span>: [<span class="dv">0</span>, <span class="dv">0</span>],  <span class="co"># tonoplastic proton pump</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"PROTON_ATPase_c_gc"</span>: [<span class="dv">1</span>, <span class="dv">1</span>],  <span class="co"># plasma membrane proton pump</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Plastidial_ATP_Synthase_p_gc"</span>: [<span class="dv">3</span>, <span class="dv">3</span>],  <span class="co"># plastidial atp_synthase</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SUCCCOASYN_RXN_m_gc"</span>: [<span class="dv">6</span>, <span class="dv">6</span>],  <span class="co"># TCA cycle</span></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"UDPKIN_RXN_c_gc"</span>: [<span class="dv">2</span>, <span class="dv">2</span>],  <span class="co"># atp-&gt;utp, sucrose synthesis</span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GLUCOKIN_RXN_c_gc"</span>: [<span class="dv">9</span>, <span class="dv">9</span>],</span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ATP_ADP_mc_gc"</span>: [<span class="dv">9</span>, <span class="dv">9</span>],  <span class="co"># ATP shuttle</span></span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>nadh_nadph_colours <span class="op">=</span> {</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1_PERIOD_18_PERIOD_1_PERIOD_2_RXN_p_gc"</span>: [<span class="dv">3</span>, <span class="dv">3</span>],  <span class="co"># ps</span></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1_PERIOD_2_PERIOD_1_PERIOD_13_RXN_p_gc"</span>: [<span class="dv">4</span>, <span class="dv">4</span>],  <span class="co"># ps</span></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2OXOGLUTARATEDEH_RXN_m_gc"</span>: [<span class="dv">6</span>, <span class="dv">6</span>],  <span class="co"># tca</span></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GAPOXNPHOSPHN_RXN_c_gc"</span>: [<span class="dv">2</span>, <span class="dv">6</span>],  <span class="co"># glycolysis or gluconeogenesis</span></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a>    <span class="st">"GAPOXNPHOSPHN_RXN_p_gc"</span>: [<span class="dv">4</span>, <span class="dv">4</span>],  <span class="co"># calvin cycle but nadh</span></span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a>    <span class="st">"HYDROXYPYRUVATE_REDUCTASE_RXN_NAD_x_gc"</span>: [<span class="dv">5</span>, <span class="dv">5</span>],  <span class="co"># OH_PYR_x -&gt; Glycerate_x to do with serine/aspartate metabolism</span></span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ISOCITRATE_DEHYDROGENASE_NAD_RXN_m_gc"</span>: [<span class="dv">6</span>, <span class="dv">6</span>],  <span class="co"># tca</span></span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MALATE_DEHYDROGENASE_NADPs_RXN_p_gc"</span>: [<span class="dv">9</span>, <span class="dv">9</span>],  <span class="co"># shuttle</span></span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MALATE_DEH_RXN_c_gc"</span>: [<span class="dv">9</span>, <span class="dv">6</span>],  <span class="co"># malate degradation when forward but also shuttle in reverse</span></span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MALATE_DEH_RXN_m_gc"</span>: [<span class="dv">9</span>, <span class="dv">9</span>],  <span class="co"># can be tca but mainly shuttle</span></span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MALATE_DEH_RXN_p_gc"</span>: [<span class="dv">9</span>, <span class="dv">9</span>],  <span class="co"># shuttle</span></span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MALATE_DEH_RXN_x_gc"</span>: [<span class="dv">9</span>, <span class="dv">9</span>],  <span class="co"># shuttle</span></span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a>    <span class="st">"MALIC_NAD_RXN_m_gc"</span>: [<span class="dv">6</span>, <span class="dv">6</span>],  <span class="co"># malate degradation (al-&gt;pyr)</span></span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NADH_DEHYDROG_A_RXN_mi_gc"</span>: [<span class="dv">7</span>, <span class="dv">7</span>],  <span class="co"># complex 1 (TC)</span></span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a>    <span class="st">"PGLYCDEHYDROG_RXN_p_gc"</span>: [<span class="dv">5</span>, <span class="dv">5</span>],  <span class="co"># ser_synthesis from g3p</span></span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a>    <span class="st">"PYRUVDEH_RXN_m_gc"</span>: [<span class="dv">6</span>, <span class="dv">6</span>],  <span class="co"># pyruvate degradation</span></span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ISOCITDEH_RXN_c_gc"</span>: [<span class="dv">6</span>, <span class="dv">6</span>],  <span class="co"># tca nadp</span></span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"6PGLUCONDEHYDROG_RXN_p_gc"</span>: [<span class="dv">9</span>, <span class="dv">9</span>],  <span class="co"># PPP</span></span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a>reaction_colours <span class="op">=</span> {<span class="op">**</span>atp_colours, <span class="op">**</span>nadh_nadph_colours}</span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> reaction, colour_number <span class="kw">in</span> reaction_colours.items():</span>
<span id="cb89-45"><a href="#cb89-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, reverse_forward <span class="kw">in</span> <span class="bu">enumerate</span>(colour_number):</span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> reverse_forward <span class="op">==</span> <span class="dv">9</span>:</span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true" tabindex="-1"></a>            reaction_colours[reaction][i] <span class="op">=</span> <span class="st">"#DDDDDD"</span></span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true" tabindex="-1"></a>            reaction_colours[reaction][i] <span class="op">=</span> colours[reverse_forward]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>colours_legend <span class="op">=</span> {</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Tonoplast membrane ATPase"</span>: <span class="dv">0</span>,</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Plasma membrane ATPase"</span>: <span class="dv">1</span>,</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sucrose/Glucose synthesis"</span>: <span class="dv">2</span>,</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Plastid/PS"</span>: <span class="dv">3</span>,</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Carbon fixation"</span>: <span class="dv">4</span>,</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Serine Synthesis"</span>: <span class="dv">5</span>,</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Carbon degradation</span><span class="ch">\n</span><span class="st">(Glycolysis, TCA etc.)"</span>: <span class="dv">6</span>,</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ETC/Mitochondrial</span><span class="ch">\n</span><span class="st">ATP Synthase"</span>: <span class="dv">7</span>,</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Starch synthesis"</span>: <span class="dv">8</span>,</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Other e.g. shuttles"</span>: <span class="dv">9</span>,</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> category, colour_number <span class="kw">in</span> colours_legend.items():</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> colour_number <span class="op">==</span> <span class="dv">9</span>:</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>        colours_legend[category] <span class="op">=</span> <span class="st">"#DDDDDD"</span></span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>        colours_legend[category] <span class="op">=</span> colours[colour_number]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>carbon_colours <span class="op">=</span> {<span class="st">"SUCROSE_ae_gc"</span>: colours[<span class="dv">2</span>], <span class="st">"GLC_ae_gc"</span>: colours[<span class="dv">6</span>], <span class="st">"FRU_ae_gc"</span>: colours[<span class="dv">4</span>]}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>legend_colours <span class="op">=</span> {</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Glucose"</span>: colours[<span class="dv">6</span>],</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Sucrose"</span>: colours[<span class="dv">2</span>],</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>nadh_nadph_budget_df_reordered_nmoles_gc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">1_PERIOD_18_PERIOD_1_PERIOD_2_RXN_p_gc</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>39.500551</td>
      <td>39.500551</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>39.500551</td>
      <td>39.500551</td>
      <td>39.500551</td>
      <td>39.500551</td>
      <td>39.500551</td>
      <td>39.500551</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1_PERIOD_2_PERIOD_1_PERIOD_13_RXN_p_gc</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-36.271334</td>
      <td>-33.502269</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-37.187692</td>
      <td>-37.187689</td>
      <td>-37.127180</td>
      <td>-36.905720</td>
      <td>-37.122098</td>
      <td>-36.978487</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">NADH_DEHYDROG_A_RXN_mi_gc</th>
      <th>2</th>
      <td>-6.617777</td>
      <td>-6.617798</td>
      <td>-4.628047</td>
      <td>-3.023238</td>
      <td>-4.529872</td>
      <td>-4.229137</td>
      <td>-3.879718</td>
      <td>-3.323148</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-2.193170</td>
      <td>-2.193169</td>
      <td>-2.333127</td>
      <td>-2.568542</td>
      <td>-2.321904</td>
      <td>-2.522065</td>
      <td>-0.438120</td>
      <td>-0.537478</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">MALATE_DEH_RXN_m_gc</th>
      <th>2</th>
      <td>1.323555</td>
      <td>1.323560</td>
      <td>0.925610</td>
      <td>1.209295</td>
      <td>4.529872</td>
      <td>4.229137</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.193170</td>
      <td>2.193169</td>
      <td>2.333127</td>
      <td>2.568542</td>
      <td>2.321904</td>
      <td>2.522065</td>
      <td>0.242721</td>
      <td>0.272785</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">MALATE_DEHYDROGENASE_NADPs_RXN_p_gc</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-3.229217</td>
      <td>-5.998282</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-2.312859</td>
      <td>-2.312862</td>
      <td>-2.373371</td>
      <td>-2.594831</td>
      <td>-2.378454</td>
      <td>-2.522065</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">ISOCITRATE_DEHYDROGENASE_NAD_RXN_m_gc</th>
      <th>2</th>
      <td>1.323555</td>
      <td>1.323560</td>
      <td>0.925609</td>
      <td>0.604648</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.939859</td>
      <td>1.661574</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.037019</td>
      <td>0.064150</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2OXOGLUTARATEDEH_RXN_m_gc</th>
      <th>2</th>
      <td>1.323555</td>
      <td>1.323560</td>
      <td>0.925609</td>
      <td>0.604648</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.939859</td>
      <td>1.661574</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.037019</td>
      <td>0.064150</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">PYRUVDEH_RXN_m_gc</th>
      <th>2</th>
      <td>1.323555</td>
      <td>1.323560</td>
      <td>0.925609</td>
      <td>0.604648</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.121361</td>
      <td>0.136392</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">GAPOXNPHOSPHN_RXN_c_gc</th>
      <th>2</th>
      <td>-1.429293</td>
      <td>-1.429383</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.969930</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.136392</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">MALATE_DEH_RXN_c_gc</th>
      <th>2</th>
      <td>1.429293</td>
      <td>1.429383</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.969930</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.136392</td>
    </tr>
    <tr>
      <th>MALIC_NAD_RXN_m_gc</th>
      <th>2</th>
      <td>1.323555</td>
      <td>1.323560</td>
      <td>0.925609</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">GAPOXNPHOSPHN_RXN_p_gc</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-1.769145</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.079190</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>PGLYCDEHYDROG_RXN_p_gc</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.769145</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>MALATE_DEH_RXN_p_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.079190</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>MALATE_DEH_RXN_x_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.076919</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>HYDROXYPYRUVATE_REDUCTASE_RXN_NAD_x_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.076919</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>color_order <span class="op">=</span> [[nadh_nadph_colours[reaction][<span class="dv">1</span>], reaction]</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>               <span class="cf">for</span> reaction <span class="kw">in</span> nadh_nadph_budget_df_reordered_nmoles_gc.index.levels[<span class="dv">0</span>]]</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>nadh_nadph_budget_df_reordered_nmoles_gc <span class="op">=</span> nadh_nadph_budget_df_reordered_nmoles_gc.loc[pd.DataFrame(</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>    color_order).sort_values(by<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>]).loc[:, <span class="dv">1</span>].values]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>color_order <span class="op">=</span> [[atp_colours[reaction][<span class="dv">1</span>], reaction]</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>               <span class="cf">for</span> reaction <span class="kw">in</span> atp_budget_df_reordered_nmoles_gc.index.levels[<span class="dv">0</span>]]</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>atp_budget_df_reordered_nmoles_gc <span class="op">=</span> atp_budget_df_reordered_nmoles_gc.loc[pd.DataFrame(color_order).sort_values(by<span class="op">=</span>[</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">1</span>]).loc[:, <span class="dv">1</span>].values]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>atp_budget_df_reordered_nmoles_gc.drop(<span class="st">"nops"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(<span class="st">"Plastidial_ATP_Synthase_p_gc"</span>, <span class="dv">3</span>)].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/544428024.py:1: PerformanceWarning: dropping on a non-lexsorted multi-index without a level parameter may impact performance.
  atp_budget_df_reordered_nmoles_gc.drop("nops", axis=1).loc[("Plastidial_ATP_Synthase_p_gc", 3)].mean()</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>50.78642316655137</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">abs</span>(nadh_nadph_budget_df_reordered_nmoles_gc)<span class="op">/</span><span class="dv">2</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
blue   unconstrained  wt          49.740791
                      starchko    49.740902
       constrained    wt          46.461726
                      starchko    45.092332
white  constrained    wt          85.852878
                      starchko    87.598369
nops   constrained    wt           5.366958
                      starchko     3.997019
dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>nadh_nadph_budget_df_reordered_nmoles_gc.loc[(<span class="bu">slice</span>(<span class="va">None</span>), <span class="dv">3</span>), :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1_PERIOD_18_PERIOD_1_PERIOD_2_RXN_p_gc</th>
      <th>3</th>
      <td>39.500551</td>
      <td>39.500551</td>
      <td>39.500551</td>
      <td>39.500551</td>
      <td>39.500551</td>
      <td>39.500551</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>NADH_DEHYDROG_A_RXN_mi_gc</th>
      <th>3</th>
      <td>-2.193170</td>
      <td>-2.193169</td>
      <td>-2.333127</td>
      <td>-2.568542</td>
      <td>-2.321904</td>
      <td>-2.522065</td>
      <td>-0.438120</td>
      <td>-0.537478</td>
    </tr>
    <tr>
      <th>1_PERIOD_2_PERIOD_1_PERIOD_13_RXN_p_gc</th>
      <th>3</th>
      <td>-37.187692</td>
      <td>-37.187689</td>
      <td>-37.127180</td>
      <td>-36.905720</td>
      <td>-37.122098</td>
      <td>-36.978487</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>GAPOXNPHOSPHN_RXN_p_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.079190</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2OXOGLUTARATEDEH_RXN_m_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.037019</td>
      <td>0.064150</td>
    </tr>
    <tr>
      <th>GAPOXNPHOSPHN_RXN_c_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.136392</td>
    </tr>
    <tr>
      <th>ISOCITRATE_DEHYDROGENASE_NAD_RXN_m_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.037019</td>
      <td>0.064150</td>
    </tr>
    <tr>
      <th>MALATE_DEH_RXN_c_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.136392</td>
    </tr>
    <tr>
      <th>PYRUVDEH_RXN_m_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.121361</td>
      <td>0.136392</td>
    </tr>
    <tr>
      <th>HYDROXYPYRUVATE_REDUCTASE_RXN_NAD_x_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.076919</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>MALATE_DEHYDROGENASE_NADPs_RXN_p_gc</th>
      <th>3</th>
      <td>-2.312859</td>
      <td>-2.312862</td>
      <td>-2.373371</td>
      <td>-2.594831</td>
      <td>-2.378454</td>
      <td>-2.522065</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>MALATE_DEH_RXN_m_gc</th>
      <th>3</th>
      <td>2.193170</td>
      <td>2.193169</td>
      <td>2.333127</td>
      <td>2.568542</td>
      <td>2.321904</td>
      <td>2.522065</td>
      <td>0.242721</td>
      <td>0.272785</td>
    </tr>
    <tr>
      <th>MALATE_DEH_RXN_p_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.079190</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>MALATE_DEH_RXN_x_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.076919</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>nops_nadph_3 <span class="op">=</span> nadh_nadph_budget_df_reordered_nmoles_gc.loc[(<span class="bu">slice</span>(<span class="va">None</span>), <span class="dv">3</span>), <span class="st">"nops"</span>].index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>colours_legend_iv <span class="op">=</span> {v: k <span class="cf">for</span> k, v <span class="kw">in</span> colours_legend.items()}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>nops_nadph_3_df <span class="op">=</span> nadh_nadph_budget_df_reordered_nmoles_gc.loc[(<span class="bu">slice</span>(<span class="va">None</span>), <span class="dv">3</span>), <span class="st">"nops"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>nops_nadph_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>MultiIndex([('1_PERIOD_18_PERIOD_1_PERIOD_2_RXN_p_gc', 3),
            (             'NADH_DEHYDROG_A_RXN_mi_gc', 3),
            ('1_PERIOD_2_PERIOD_1_PERIOD_13_RXN_p_gc', 3),
            (                'GAPOXNPHOSPHN_RXN_p_gc', 3),
            (             '2OXOGLUTARATEDEH_RXN_m_gc', 3),
            (                'GAPOXNPHOSPHN_RXN_c_gc', 3),
            ( 'ISOCITRATE_DEHYDROGENASE_NAD_RXN_m_gc', 3),
            (                   'MALATE_DEH_RXN_c_gc', 3),
            (                     'PYRUVDEH_RXN_m_gc', 3),
            ('HYDROXYPYRUVATE_REDUCTASE_RXN_NAD_x_gc', 3),
            (   'MALATE_DEHYDROGENASE_NADPs_RXN_p_gc', 3),
            (                   'MALATE_DEH_RXN_m_gc', 3),
            (                   'MALATE_DEH_RXN_p_gc', 3),
            (                   'MALATE_DEH_RXN_x_gc', 3)],
           names=['Reaction', 'Phase'])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>nops_nadph_3_reactions <span class="op">=</span> [i[<span class="dv">0</span>] <span class="cf">for</span> i <span class="kw">in</span> nops_nadph_3]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>descriptions <span class="op">=</span> []</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> reaction <span class="kw">in</span> nops_nadph_3_reactions:</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>    descriptions.append(colours_legend_iv[nadh_nadph_colours[reaction][<span class="dv">0</span>]].replace(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>, <span class="st">""</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>nops_nadph_3_df.loc[:, <span class="st">"Description"</span>] <span class="op">=</span> descriptions</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>nops_nadph_3_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">constrained</th>
      <th>Description</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th></th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1_PERIOD_18_PERIOD_1_PERIOD_2_RXN_p_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>Plastid/PS</td>
    </tr>
    <tr>
      <th>NADH_DEHYDROG_A_RXN_mi_gc</th>
      <th>3</th>
      <td>-0.438120</td>
      <td>-0.537478</td>
      <td>ETC/MitochondrialATP Synthase</td>
    </tr>
    <tr>
      <th>1_PERIOD_2_PERIOD_1_PERIOD_13_RXN_p_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>Carbon fixation</td>
    </tr>
    <tr>
      <th>GAPOXNPHOSPHN_RXN_p_gc</th>
      <th>3</th>
      <td>0.079190</td>
      <td>0.000000</td>
      <td>Carbon fixation</td>
    </tr>
    <tr>
      <th>2OXOGLUTARATEDEH_RXN_m_gc</th>
      <th>3</th>
      <td>0.037019</td>
      <td>0.064150</td>
      <td>Carbon degradation(Glycolysis, TCA etc.)</td>
    </tr>
    <tr>
      <th>GAPOXNPHOSPHN_RXN_c_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.136392</td>
      <td>Sucrose/Glucose synthesis</td>
    </tr>
    <tr>
      <th>ISOCITRATE_DEHYDROGENASE_NAD_RXN_m_gc</th>
      <th>3</th>
      <td>0.037019</td>
      <td>0.064150</td>
      <td>Carbon degradation(Glycolysis, TCA etc.)</td>
    </tr>
    <tr>
      <th>MALATE_DEH_RXN_c_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>-0.136392</td>
      <td>Other e.g. shuttles</td>
    </tr>
    <tr>
      <th>PYRUVDEH_RXN_m_gc</th>
      <th>3</th>
      <td>0.121361</td>
      <td>0.136392</td>
      <td>Carbon degradation(Glycolysis, TCA etc.)</td>
    </tr>
    <tr>
      <th>HYDROXYPYRUVATE_REDUCTASE_RXN_NAD_x_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>Serine Synthesis</td>
    </tr>
    <tr>
      <th>MALATE_DEHYDROGENASE_NADPs_RXN_p_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>Other e.g. shuttles</td>
    </tr>
    <tr>
      <th>MALATE_DEH_RXN_m_gc</th>
      <th>3</th>
      <td>0.242721</td>
      <td>0.272785</td>
      <td>Other e.g. shuttles</td>
    </tr>
    <tr>
      <th>MALATE_DEH_RXN_p_gc</th>
      <th>3</th>
      <td>-0.079190</td>
      <td>0.000000</td>
      <td>Other e.g. shuttles</td>
    </tr>
    <tr>
      <th>MALATE_DEH_RXN_x_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>Other e.g. shuttles</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>metabolites <span class="op">=</span> [<span class="st">"ATP"</span>, <span class="st">"NAD(P)H"</span>]</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>phases <span class="op">=</span> [<span class="st">"Opening"</span>, <span class="st">"Day"</span>]</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>hatches <span class="op">=</span> {<span class="st">"wt"</span>: <span class="va">None</span>, <span class="st">"starchko"</span>: <span class="st">"//"</span>}</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>atpase_labelling <span class="op">=</span> {<span class="st">"unconstrained"</span>: <span class="st">"–"</span>, <span class="st">"constrained"</span>: <span class="st">"+"</span>}</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">9</span>, <span class="dv">12</span>), sharex<span class="op">=</span><span class="va">True</span>, sharey<span class="op">=</span><span class="st">"row"</span>)</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>plt.subplots_adjust(hspace<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>colour_rectangles_thickness <span class="op">=</span> <span class="dv">4</span> <span class="op">/</span> (<span class="dv">75</span> <span class="op">*</span> <span class="dv">2</span>)</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> y, metabolite <span class="kw">in</span> <span class="bu">enumerate</span>(</span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>    [atp_budget_df_reordered_nmoles_gc, nadh_nadph_budget_df_reordered_nmoles_gc]</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x, phase <span class="kw">in</span> <span class="bu">enumerate</span>([<span class="dv">2</span>, <span class="dv">3</span>]):</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>        budget_df <span class="op">=</span> metabolite.xs(phase, level<span class="op">=</span><span class="st">"Phase"</span>)</span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> axs[y][x]</span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if y == 0:</span></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> x1, x2, colour <span class="kw">in</span> <span class="bu">zip</span>(</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>            [<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">3.5</span>, <span class="fl">5.5</span>], [<span class="fl">3.5</span>, <span class="fl">5.5</span>, <span class="fl">7.5</span>], [<span class="st">"#004488"</span>, <span class="st">"white"</span>, <span class="st">"#DDDDDD"</span>]</span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>        ):</span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a>            ax.fill_betweenx(</span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a>                [<span class="dv">75</span> <span class="op">-</span> colour_rectangles_thickness <span class="op">*</span> <span class="dv">75</span> <span class="op">*</span> <span class="dv">2</span>, <span class="dv">75</span>],</span>
<span id="cb111-24"><a href="#cb111-24" aria-hidden="true" tabindex="-1"></a>                x1,</span>
<span id="cb111-25"><a href="#cb111-25" aria-hidden="true" tabindex="-1"></a>                x2,</span>
<span id="cb111-26"><a href="#cb111-26" aria-hidden="true" tabindex="-1"></a>                alpha<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb111-27"><a href="#cb111-27" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span>colour,</span>
<span id="cb111-28"><a href="#cb111-28" aria-hidden="true" tabindex="-1"></a>                linewidth<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb111-29"><a href="#cb111-29" aria-hidden="true" tabindex="-1"></a>                edgecolor<span class="op">=</span><span class="st">"black"</span>,</span>
<span id="cb111-30"><a href="#cb111-30" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb111-31"><a href="#cb111-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-32"><a href="#cb111-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, scenario <span class="kw">in</span> <span class="bu">enumerate</span>(budget_df.columns):</span>
<span id="cb111-33"><a href="#cb111-33" aria-hidden="true" tabindex="-1"></a>            positive_bottom <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb111-34"><a href="#cb111-34" aria-hidden="true" tabindex="-1"></a>            negative_top <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb111-35"><a href="#cb111-35" aria-hidden="true" tabindex="-1"></a>            scenario_df <span class="op">=</span> budget_df.loc[:, scenario]</span>
<span id="cb111-36"><a href="#cb111-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> reaction <span class="kw">in</span> scenario_df.index:</span>
<span id="cb111-37"><a href="#cb111-37" aria-hidden="true" tabindex="-1"></a>                value <span class="op">=</span> scenario_df.loc[reaction]</span>
<span id="cb111-38"><a href="#cb111-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> value <span class="op">&gt;</span> <span class="fl">0.00001</span>:</span>
<span id="cb111-39"><a href="#cb111-39" aria-hidden="true" tabindex="-1"></a>                    ax.bar(</span>
<span id="cb111-40"><a href="#cb111-40" aria-hidden="true" tabindex="-1"></a>                        i,</span>
<span id="cb111-41"><a href="#cb111-41" aria-hidden="true" tabindex="-1"></a>                        value,</span>
<span id="cb111-42"><a href="#cb111-42" aria-hidden="true" tabindex="-1"></a>                        bottom<span class="op">=</span>positive_bottom,</span>
<span id="cb111-43"><a href="#cb111-43" aria-hidden="true" tabindex="-1"></a>                        color<span class="op">=</span>reaction_colours[reaction][<span class="dv">1</span>],</span>
<span id="cb111-44"><a href="#cb111-44" aria-hidden="true" tabindex="-1"></a>                        linewidth<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb111-45"><a href="#cb111-45" aria-hidden="true" tabindex="-1"></a>                        hatch<span class="op">=</span>hatches[scenario[<span class="dv">2</span>]],</span>
<span id="cb111-46"><a href="#cb111-46" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb111-47"><a href="#cb111-47" aria-hidden="true" tabindex="-1"></a>                    positive_bottom <span class="op">+=</span> value</span>
<span id="cb111-48"><a href="#cb111-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> value <span class="op">&lt;</span> <span class="fl">0.00001</span>:</span>
<span id="cb111-49"><a href="#cb111-49" aria-hidden="true" tabindex="-1"></a>                    ax.bar(</span>
<span id="cb111-50"><a href="#cb111-50" aria-hidden="true" tabindex="-1"></a>                        i,</span>
<span id="cb111-51"><a href="#cb111-51" aria-hidden="true" tabindex="-1"></a>                        value,</span>
<span id="cb111-52"><a href="#cb111-52" aria-hidden="true" tabindex="-1"></a>                        bottom<span class="op">=</span>negative_top,</span>
<span id="cb111-53"><a href="#cb111-53" aria-hidden="true" tabindex="-1"></a>                        color<span class="op">=</span>reaction_colours[reaction][<span class="dv">0</span>],</span>
<span id="cb111-54"><a href="#cb111-54" aria-hidden="true" tabindex="-1"></a>                        linewidth<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb111-55"><a href="#cb111-55" aria-hidden="true" tabindex="-1"></a>                        hatch<span class="op">=</span>hatches[scenario[<span class="dv">2</span>]],</span>
<span id="cb111-56"><a href="#cb111-56" aria-hidden="true" tabindex="-1"></a>                    )</span>
<span id="cb111-57"><a href="#cb111-57" aria-hidden="true" tabindex="-1"></a>                    negative_top <span class="op">+=</span> value</span>
<span id="cb111-58"><a href="#cb111-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-59"><a href="#cb111-59" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ax.text(i, positive_bottom + 0.005, round(positive_bottom, 6), rotation=90)</span></span>
<span id="cb111-60"><a href="#cb111-60" aria-hidden="true" tabindex="-1"></a>        ax.set_xticks([])  <span class="co"># range(len(budget_df.columns)))</span></span>
<span id="cb111-61"><a href="#cb111-61" aria-hidden="true" tabindex="-1"></a>        ax.set_xticklabels(</span>
<span id="cb111-62"><a href="#cb111-62" aria-hidden="true" tabindex="-1"></a>            []</span>
<span id="cb111-63"><a href="#cb111-63" aria-hidden="true" tabindex="-1"></a>        )  <span class="co"># [atpase_labelling[scenario[1]] for scenario in budget_df.columns])</span></span>
<span id="cb111-64"><a href="#cb111-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-65"><a href="#cb111-65" aria-hidden="true" tabindex="-1"></a>        <span class="co"># if y==1:</span></span>
<span id="cb111-66"><a href="#cb111-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> x1, x2 <span class="kw">in</span> <span class="bu">zip</span>([<span class="op">-</span><span class="fl">0.4</span>, <span class="fl">1.6</span>], [<span class="fl">1.4</span>, <span class="fl">7.4</span>]):  <span class="co"># lines above atpase text</span></span>
<span id="cb111-67"><a href="#cb111-67" aria-hidden="true" tabindex="-1"></a>            ax.hlines(<span class="op">-</span><span class="dv">75</span>, x1, x2, color<span class="op">=</span><span class="st">"black"</span>, linewidth<span class="op">=</span><span class="dv">3</span>, clip_on<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb111-68"><a href="#cb111-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-69"><a href="#cb111-69" aria-hidden="true" tabindex="-1"></a>        <span class="co">"""    </span></span>
<span id="cb111-70"><a href="#cb111-70" aria-hidden="true" tabindex="-1"></a><span class="co">        atpase_text_y = -80</span></span>
<span id="cb111-71"><a href="#cb111-71" aria-hidden="true" tabindex="-1"></a><span class="co">        if y==1:</span></span>
<span id="cb111-72"><a href="#cb111-72" aria-hidden="true" tabindex="-1"></a><span class="co">            ax.text(0.5, atpase_text_y, "Un-", ha="center", va="top", size="x-large")</span></span>
<span id="cb111-73"><a href="#cb111-73" aria-hidden="true" tabindex="-1"></a><span class="co">            ax.text(4.5, atpase_text_y, "Constrained", ha="center", va="top", size="x-large")</span></span>
<span id="cb111-74"><a href="#cb111-74" aria-hidden="true" tabindex="-1"></a><span class="co">            if x == 0:</span></span>
<span id="cb111-75"><a href="#cb111-75" aria-hidden="true" tabindex="-1"></a><span class="co">                ax.text(-0.7, atpase_text_y, "ATPase", ha="right", va="top", size="x-large")</span></span>
<span id="cb111-76"><a href="#cb111-76" aria-hidden="true" tabindex="-1"></a><span class="co">        """</span></span>
<span id="cb111-77"><a href="#cb111-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-78"><a href="#cb111-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> y <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb111-79"><a href="#cb111-79" aria-hidden="true" tabindex="-1"></a>            ax.set_title(phases[x], pad<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb111-80"><a href="#cb111-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> x <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb111-81"><a href="#cb111-81" aria-hidden="true" tabindex="-1"></a>            ax.set_ylabel(metabolites[y])</span>
<span id="cb111-82"><a href="#cb111-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-83"><a href="#cb111-83" aria-hidden="true" tabindex="-1"></a>        ax.set_xlim(<span class="op">-</span><span class="fl">0.70</span>, <span class="fl">7.7</span>)</span>
<span id="cb111-84"><a href="#cb111-84" aria-hidden="true" tabindex="-1"></a>        ax.set_ylim(<span class="op">-</span><span class="dv">70</span>, <span class="dv">75</span>)</span>
<span id="cb111-85"><a href="#cb111-85" aria-hidden="true" tabindex="-1"></a>        ax.spines[<span class="st">"bottom"</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb111-86"><a href="#cb111-86" aria-hidden="true" tabindex="-1"></a>        ax.spines[<span class="st">"left"</span>].set_bounds(<span class="op">-</span><span class="dv">70</span>, <span class="dv">70</span>)</span>
<span id="cb111-87"><a href="#cb111-87" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ax.xaxis.set_major_locator(MultipleLocator(1))</span></span>
<span id="cb111-88"><a href="#cb111-88" aria-hidden="true" tabindex="-1"></a>        ax.yaxis.set_major_locator(MultipleLocator(<span class="dv">35</span>))</span>
<span id="cb111-89"><a href="#cb111-89" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ax.yaxis.set_minor_locator(AutoMinorLocator(2))</span></span>
<span id="cb111-90"><a href="#cb111-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-91"><a href="#cb111-91" aria-hidden="true" tabindex="-1"></a>        ax.hlines(<span class="dv">0</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">7.5</span>, color<span class="op">=</span><span class="st">"black"</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb111-92"><a href="#cb111-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-93"><a href="#cb111-93" aria-hidden="true" tabindex="-1"></a>fig.text(</span>
<span id="cb111-94"><a href="#cb111-94" aria-hidden="true" tabindex="-1"></a>    <span class="op">-</span><span class="fl">0.02</span>,</span>
<span id="cb111-95"><a href="#cb111-95" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.66</span>,</span>
<span id="cb111-96"><a href="#cb111-96" aria-hidden="true" tabindex="-1"></a>    <span class="vs">r"Rate of production/consumption of energy"</span></span>
<span id="cb111-97"><a href="#cb111-97" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb111-98"><a href="#cb111-98" aria-hidden="true" tabindex="-1"></a>    <span class="st">"and reducing power (fmol$\cdot$GC$^{-1}\cdot$h$^{-1}$)"</span>,</span>
<span id="cb111-99"><a href="#cb111-99" aria-hidden="true" tabindex="-1"></a>    rotation<span class="op">=</span><span class="dv">90</span>,</span>
<span id="cb111-100"><a href="#cb111-100" aria-hidden="true" tabindex="-1"></a>    va<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb111-101"><a href="#cb111-101" aria-hidden="true" tabindex="-1"></a>    ha<span class="op">=</span><span class="st">"center"</span>,</span>
<span id="cb111-102"><a href="#cb111-102" aria-hidden="true" tabindex="-1"></a>    size<span class="op">=</span><span class="st">"large"</span>,</span>
<span id="cb111-103"><a href="#cb111-103" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb111-104"><a href="#cb111-104" aria-hidden="true" tabindex="-1"></a><span class="co"># ax.set_title(f"ATP Phase {phase}", pad=70)</span></span>
<span id="cb111-105"><a href="#cb111-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-106"><a href="#cb111-106" aria-hidden="true" tabindex="-1"></a>patchList <span class="op">=</span> []</span>
<span id="cb111-107"><a href="#cb111-107" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key <span class="kw">in</span> colours_legend:</span>
<span id="cb111-108"><a href="#cb111-108" aria-hidden="true" tabindex="-1"></a>    data_key <span class="op">=</span> mpatches.Patch(color<span class="op">=</span>colours_legend[key], label<span class="op">=</span>key)</span>
<span id="cb111-109"><a href="#cb111-109" aria-hidden="true" tabindex="-1"></a>    patchList.append(data_key)</span>
<span id="cb111-110"><a href="#cb111-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-111"><a href="#cb111-111" aria-hidden="true" tabindex="-1"></a>fig.legend(handles<span class="op">=</span>patchList, loc<span class="op">=</span><span class="st">"center left"</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">0.925</span>, <span class="fl">0.63</span>))</span>
<span id="cb111-112"><a href="#cb111-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-113"><a href="#cb111-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-114"><a href="#cb111-114" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x, ax <span class="kw">in</span> <span class="bu">enumerate</span>(axs[<span class="dv">2</span>]):</span>
<span id="cb111-115"><a href="#cb111-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-116"><a href="#cb111-116" aria-hidden="true" tabindex="-1"></a>    phase <span class="op">=</span> [<span class="dv">2</span>, <span class="dv">3</span>][x]</span>
<span id="cb111-117"><a href="#cb111-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-118"><a href="#cb111-118" aria-hidden="true" tabindex="-1"></a>    y_lim_for_hexose <span class="op">=</span> <span class="dv">49</span></span>
<span id="cb111-119"><a href="#cb111-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-120"><a href="#cb111-120" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x1, x2, colour <span class="kw">in</span> <span class="bu">zip</span>(</span>
<span id="cb111-121"><a href="#cb111-121" aria-hidden="true" tabindex="-1"></a>        [<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">3.5</span>, <span class="fl">5.5</span>], [<span class="fl">3.5</span>, <span class="fl">5.5</span>, <span class="fl">7.5</span>], [<span class="st">"#004488"</span>, <span class="st">"white"</span>, <span class="st">"#DDDDDD"</span>]</span>
<span id="cb111-122"><a href="#cb111-122" aria-hidden="true" tabindex="-1"></a>    ):</span>
<span id="cb111-123"><a href="#cb111-123" aria-hidden="true" tabindex="-1"></a>        ax.fill_betweenx(</span>
<span id="cb111-124"><a href="#cb111-124" aria-hidden="true" tabindex="-1"></a>            [y_lim_for_hexose <span class="op">-</span> y_lim_for_hexose <span class="op">*</span> colour_rectangles_thickness, y_lim_for_hexose],</span>
<span id="cb111-125"><a href="#cb111-125" aria-hidden="true" tabindex="-1"></a>            x1,</span>
<span id="cb111-126"><a href="#cb111-126" aria-hidden="true" tabindex="-1"></a>            x2,</span>
<span id="cb111-127"><a href="#cb111-127" aria-hidden="true" tabindex="-1"></a>            alpha<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb111-128"><a href="#cb111-128" aria-hidden="true" tabindex="-1"></a>            color<span class="op">=</span>colour,</span>
<span id="cb111-129"><a href="#cb111-129" aria-hidden="true" tabindex="-1"></a>            linewidth<span class="op">=</span><span class="fl">0.5</span>,</span>
<span id="cb111-130"><a href="#cb111-130" aria-hidden="true" tabindex="-1"></a>            edgecolor<span class="op">=</span><span class="st">"black"</span>,</span>
<span id="cb111-131"><a href="#cb111-131" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb111-132"><a href="#cb111-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-133"><a href="#cb111-133" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, scenario <span class="kw">in</span> <span class="bu">enumerate</span>(gc_carbon_production_consumption_nmoles_gc.columns):</span>
<span id="cb111-134"><a href="#cb111-134" aria-hidden="true" tabindex="-1"></a>        positive_bottom <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb111-135"><a href="#cb111-135" aria-hidden="true" tabindex="-1"></a>        negative_top <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb111-136"><a href="#cb111-136" aria-hidden="true" tabindex="-1"></a>        scenario_df <span class="op">=</span> gc_carbon_production_consumption_nmoles_gc.xs(</span>
<span id="cb111-137"><a href="#cb111-137" aria-hidden="true" tabindex="-1"></a>            phase, level<span class="op">=</span><span class="st">"Phase"</span></span>
<span id="cb111-138"><a href="#cb111-138" aria-hidden="true" tabindex="-1"></a>        ).loc[:, scenario]</span>
<span id="cb111-139"><a href="#cb111-139" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> reaction <span class="kw">in</span> scenario_df.index:</span>
<span id="cb111-140"><a href="#cb111-140" aria-hidden="true" tabindex="-1"></a>            value <span class="op">=</span> scenario_df.loc[reaction]</span>
<span id="cb111-141"><a href="#cb111-141" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> value <span class="op">&gt;</span> <span class="fl">0.00001</span>:</span>
<span id="cb111-142"><a href="#cb111-142" aria-hidden="true" tabindex="-1"></a>                ax.bar(</span>
<span id="cb111-143"><a href="#cb111-143" aria-hidden="true" tabindex="-1"></a>                    i,</span>
<span id="cb111-144"><a href="#cb111-144" aria-hidden="true" tabindex="-1"></a>                    value,</span>
<span id="cb111-145"><a href="#cb111-145" aria-hidden="true" tabindex="-1"></a>                    bottom<span class="op">=</span>positive_bottom,</span>
<span id="cb111-146"><a href="#cb111-146" aria-hidden="true" tabindex="-1"></a>                    color<span class="op">=</span>carbon_colours[reaction],</span>
<span id="cb111-147"><a href="#cb111-147" aria-hidden="true" tabindex="-1"></a>                    linewidth<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb111-148"><a href="#cb111-148" aria-hidden="true" tabindex="-1"></a>                    hatch<span class="op">=</span>hatches[scenario[<span class="dv">2</span>]],</span>
<span id="cb111-149"><a href="#cb111-149" aria-hidden="true" tabindex="-1"></a>                    align<span class="op">=</span><span class="st">"edge"</span>,</span>
<span id="cb111-150"><a href="#cb111-150" aria-hidden="true" tabindex="-1"></a>                    width<span class="op">=-</span><span class="fl">0.4</span>,</span>
<span id="cb111-151"><a href="#cb111-151" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb111-152"><a href="#cb111-152" aria-hidden="true" tabindex="-1"></a>                positive_bottom <span class="op">+=</span> value</span>
<span id="cb111-153"><a href="#cb111-153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> value <span class="op">&lt;</span> <span class="fl">0.00001</span>:</span>
<span id="cb111-154"><a href="#cb111-154" aria-hidden="true" tabindex="-1"></a>                ax.bar(</span>
<span id="cb111-155"><a href="#cb111-155" aria-hidden="true" tabindex="-1"></a>                    i,</span>
<span id="cb111-156"><a href="#cb111-156" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">abs</span>(value),</span>
<span id="cb111-157"><a href="#cb111-157" aria-hidden="true" tabindex="-1"></a>                    bottom<span class="op">=</span>negative_top,</span>
<span id="cb111-158"><a href="#cb111-158" aria-hidden="true" tabindex="-1"></a>                    color<span class="op">=</span>carbon_colours[reaction],</span>
<span id="cb111-159"><a href="#cb111-159" aria-hidden="true" tabindex="-1"></a>                    linewidth<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb111-160"><a href="#cb111-160" aria-hidden="true" tabindex="-1"></a>                    hatch<span class="op">=</span>hatches[scenario[<span class="dv">2</span>]],</span>
<span id="cb111-161"><a href="#cb111-161" aria-hidden="true" tabindex="-1"></a>                    align<span class="op">=</span><span class="st">"edge"</span>,</span>
<span id="cb111-162"><a href="#cb111-162" aria-hidden="true" tabindex="-1"></a>                    width<span class="op">=</span><span class="fl">0.4</span>,</span>
<span id="cb111-163"><a href="#cb111-163" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb111-164"><a href="#cb111-164" aria-hidden="true" tabindex="-1"></a>                negative_top <span class="op">+=</span> <span class="bu">abs</span>(value)</span>
<span id="cb111-165"><a href="#cb111-165" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> positive_bottom <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb111-166"><a href="#cb111-166" aria-hidden="true" tabindex="-1"></a>            ax.bar(</span>
<span id="cb111-167"><a href="#cb111-167" aria-hidden="true" tabindex="-1"></a>                i,</span>
<span id="cb111-168"><a href="#cb111-168" aria-hidden="true" tabindex="-1"></a>                <span class="fl">0.3</span>,</span>
<span id="cb111-169"><a href="#cb111-169" aria-hidden="true" tabindex="-1"></a>                bottom<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb111-170"><a href="#cb111-170" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span>carbon_colours[reaction],</span>
<span id="cb111-171"><a href="#cb111-171" aria-hidden="true" tabindex="-1"></a>                linewidth<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb111-172"><a href="#cb111-172" aria-hidden="true" tabindex="-1"></a>                hatch<span class="op">=</span>hatches[scenario[<span class="dv">2</span>]],</span>
<span id="cb111-173"><a href="#cb111-173" aria-hidden="true" tabindex="-1"></a>                align<span class="op">=</span><span class="st">"edge"</span>,</span>
<span id="cb111-174"><a href="#cb111-174" aria-hidden="true" tabindex="-1"></a>                width<span class="op">=-</span><span class="fl">0.4</span>,</span>
<span id="cb111-175"><a href="#cb111-175" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb111-176"><a href="#cb111-176" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> negative_top <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb111-177"><a href="#cb111-177" aria-hidden="true" tabindex="-1"></a>            ax.bar(</span>
<span id="cb111-178"><a href="#cb111-178" aria-hidden="true" tabindex="-1"></a>                i,</span>
<span id="cb111-179"><a href="#cb111-179" aria-hidden="true" tabindex="-1"></a>                <span class="fl">0.3</span>,</span>
<span id="cb111-180"><a href="#cb111-180" aria-hidden="true" tabindex="-1"></a>                bottom<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb111-181"><a href="#cb111-181" aria-hidden="true" tabindex="-1"></a>                color<span class="op">=</span>carbon_colours[reaction],</span>
<span id="cb111-182"><a href="#cb111-182" aria-hidden="true" tabindex="-1"></a>                linewidth<span class="op">=</span><span class="fl">0.1</span>,</span>
<span id="cb111-183"><a href="#cb111-183" aria-hidden="true" tabindex="-1"></a>                hatch<span class="op">=</span>hatches[scenario[<span class="dv">2</span>]],</span>
<span id="cb111-184"><a href="#cb111-184" aria-hidden="true" tabindex="-1"></a>                align<span class="op">=</span><span class="st">"edge"</span>,</span>
<span id="cb111-185"><a href="#cb111-185" aria-hidden="true" tabindex="-1"></a>                width<span class="op">=</span><span class="fl">0.4</span>,</span>
<span id="cb111-186"><a href="#cb111-186" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb111-187"><a href="#cb111-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-188"><a href="#cb111-188" aria-hidden="true" tabindex="-1"></a>        <span class="co"># ax.text(</span></span>
<span id="cb111-189"><a href="#cb111-189" aria-hidden="true" tabindex="-1"></a>        <span class="co">#    i - 0.2, positive_bottom + 1.5, "+", ha="center", va="center", size="large"</span></span>
<span id="cb111-190"><a href="#cb111-190" aria-hidden="true" tabindex="-1"></a>        <span class="co"># )</span></span>
<span id="cb111-191"><a href="#cb111-191" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> positive_bottom <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb111-192"><a href="#cb111-192" aria-hidden="true" tabindex="-1"></a>            ax.text(</span>
<span id="cb111-193"><a href="#cb111-193" aria-hidden="true" tabindex="-1"></a>                i <span class="op">-</span> <span class="fl">0.2</span>, positive_bottom <span class="op">+</span> <span class="fl">1.5</span>, <span class="ss">f"+</span><span class="sc">{</span><span class="bu">round</span>(positive_bottom, <span class="dv">2</span>)<span class="sc">}</span><span class="ss">"</span>, ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"bottom"</span>, size<span class="op">=</span><span class="st">"x-small"</span>, rotation<span class="op">=</span><span class="dv">90</span></span>
<span id="cb111-194"><a href="#cb111-194" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb111-195"><a href="#cb111-195" aria-hidden="true" tabindex="-1"></a>        <span class="co">#ax.text(i + 0.2, negative_top + 1.5, "-", ha="center", va="center", size="large")</span></span>
<span id="cb111-196"><a href="#cb111-196" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> negative_top <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb111-197"><a href="#cb111-197" aria-hidden="true" tabindex="-1"></a>            ax.text(</span>
<span id="cb111-198"><a href="#cb111-198" aria-hidden="true" tabindex="-1"></a>                i <span class="op">+</span> <span class="fl">0.2</span>, negative_top <span class="op">+</span> <span class="fl">1.5</span>, <span class="ss">f"–</span><span class="sc">{</span><span class="bu">abs</span>(<span class="bu">round</span>(negative_top, <span class="dv">2</span>))<span class="sc">}</span><span class="ss">"</span>, ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"bottom"</span>, size<span class="op">=</span><span class="st">"x-small"</span>, rotation<span class="op">=</span><span class="dv">90</span></span>
<span id="cb111-199"><a href="#cb111-199" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb111-200"><a href="#cb111-200" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> positive_bottom <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> negative_top <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb111-201"><a href="#cb111-201" aria-hidden="true" tabindex="-1"></a>            net_value <span class="op">=</span> <span class="bu">round</span>(positive_bottom<span class="op">-</span>negative_top, <span class="dv">2</span>)</span>
<span id="cb111-202"><a href="#cb111-202" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> net_value <span class="op">&lt;</span> <span class="dv">0</span>:</span>
<span id="cb111-203"><a href="#cb111-203" aria-hidden="true" tabindex="-1"></a>                ax.text(</span>
<span id="cb111-204"><a href="#cb111-204" aria-hidden="true" tabindex="-1"></a>                    i<span class="op">-</span><span class="fl">0.1</span>, <span class="dv">25</span>, <span class="ss">f"–</span><span class="sc">{</span><span class="bu">abs</span>(net_value)<span class="sc">}</span><span class="ss">"</span>, ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"center"</span>, size<span class="op">=</span><span class="st">"x-small"</span></span>
<span id="cb111-205"><a href="#cb111-205" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb111-206"><a href="#cb111-206" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb111-207"><a href="#cb111-207" aria-hidden="true" tabindex="-1"></a>                ax.text(</span>
<span id="cb111-208"><a href="#cb111-208" aria-hidden="true" tabindex="-1"></a>                    i<span class="op">-</span><span class="fl">0.1</span>, <span class="dv">25</span>, <span class="ss">f"</span><span class="sc">{</span>net_value<span class="sc">}</span><span class="ss">"</span>, ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"center"</span>, size<span class="op">=</span><span class="st">"x-small"</span></span>
<span id="cb111-209"><a href="#cb111-209" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb111-210"><a href="#cb111-210" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> phase <span class="op">==</span> <span class="dv">3</span>:</span>
<span id="cb111-211"><a href="#cb111-211" aria-hidden="true" tabindex="-1"></a>            ax.text(</span>
<span id="cb111-212"><a href="#cb111-212" aria-hidden="true" tabindex="-1"></a>                <span class="fl">6.5</span>, <span class="dv">27</span>, <span class="st">"Net:"</span>, ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"bottom"</span>, size<span class="op">=</span><span class="st">"small"</span>, weight<span class="op">=</span><span class="st">"normal"</span></span>
<span id="cb111-213"><a href="#cb111-213" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb111-214"><a href="#cb111-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-215"><a href="#cb111-215" aria-hidden="true" tabindex="-1"></a>        starch_condition <span class="op">=</span> {<span class="st">"wt"</span>: <span class="st">"WT"</span>, <span class="st">"starchko"</span>: <span class="st">"KO"</span>}[scenario_df.name[<span class="dv">2</span>]]</span>
<span id="cb111-216"><a href="#cb111-216" aria-hidden="true" tabindex="-1"></a>        ax.text(i, <span class="op">-</span><span class="fl">1.5</span>, starch_condition, ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"center"</span>, size<span class="op">=</span><span class="st">"small"</span>)</span>
<span id="cb111-217"><a href="#cb111-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-218"><a href="#cb111-218" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ax.hlines(0, -0.5, 7.5, color="black", linewidth=0.5)</span></span>
<span id="cb111-219"><a href="#cb111-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-220"><a href="#cb111-220" aria-hidden="true" tabindex="-1"></a>    patchList <span class="op">=</span> []</span>
<span id="cb111-221"><a href="#cb111-221" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key <span class="kw">in</span> legend_colours:</span>
<span id="cb111-222"><a href="#cb111-222" aria-hidden="true" tabindex="-1"></a>        data_key <span class="op">=</span> mpatches.Patch(color<span class="op">=</span>legend_colours[key], label<span class="op">=</span>key)</span>
<span id="cb111-223"><a href="#cb111-223" aria-hidden="true" tabindex="-1"></a>        patchList.append(data_key)</span>
<span id="cb111-224"><a href="#cb111-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-225"><a href="#cb111-225" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb111-226"><a href="#cb111-226" aria-hidden="true" tabindex="-1"></a>        ax.legend(handles<span class="op">=</span>patchList, loc<span class="op">=</span><span class="st">"center left"</span>, bbox_to_anchor<span class="op">=</span>(<span class="fl">1.1</span>, <span class="fl">0.5</span>))</span>
<span id="cb111-227"><a href="#cb111-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-228"><a href="#cb111-228" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x1, x2 <span class="kw">in</span> <span class="bu">zip</span>([<span class="op">-</span><span class="fl">0.4</span>, <span class="fl">1.6</span>], [<span class="fl">1.4</span>, <span class="fl">7.4</span>]):  <span class="co"># lines above atpase text</span></span>
<span id="cb111-229"><a href="#cb111-229" aria-hidden="true" tabindex="-1"></a>        ax.hlines(<span class="op">-</span><span class="dv">3</span>, x1, x2, color<span class="op">=</span><span class="st">"black"</span>, linewidth<span class="op">=</span><span class="dv">3</span>, clip_on<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb111-230"><a href="#cb111-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-231"><a href="#cb111-231" aria-hidden="true" tabindex="-1"></a>    atpase_text_y <span class="op">=</span> <span class="op">-</span><span class="fl">3.5</span></span>
<span id="cb111-232"><a href="#cb111-232" aria-hidden="true" tabindex="-1"></a>    ax.text(<span class="fl">0.5</span>, atpase_text_y, <span class="st">"Un-"</span>, ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"top"</span>, size<span class="op">=</span><span class="st">"x-large"</span>)</span>
<span id="cb111-233"><a href="#cb111-233" aria-hidden="true" tabindex="-1"></a>    ax.text(<span class="fl">4.5</span>, atpase_text_y, <span class="st">"Constrained"</span>, ha<span class="op">=</span><span class="st">"center"</span>, va<span class="op">=</span><span class="st">"top"</span>, size<span class="op">=</span><span class="st">"x-large"</span>)</span>
<span id="cb111-234"><a href="#cb111-234" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb111-235"><a href="#cb111-235" aria-hidden="true" tabindex="-1"></a>        ax.text(<span class="op">-</span><span class="fl">0.7</span>, atpase_text_y, <span class="st">"ATPase"</span>, ha<span class="op">=</span><span class="st">"right"</span>, va<span class="op">=</span><span class="st">"top"</span>, size<span class="op">=</span><span class="st">"x-large"</span>)</span>
<span id="cb111-236"><a href="#cb111-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-237"><a href="#cb111-237" aria-hidden="true" tabindex="-1"></a>    ax.set_xlim(<span class="op">-</span><span class="fl">0.7</span>, <span class="fl">7.7</span>)</span>
<span id="cb111-238"><a href="#cb111-238" aria-hidden="true" tabindex="-1"></a>    ax.set_ylim(<span class="op">-</span><span class="fl">0.1</span>, y_lim_for_hexose)</span>
<span id="cb111-239"><a href="#cb111-239" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">"bottom"</span>].set_visible(<span class="va">False</span>)</span>
<span id="cb111-240"><a href="#cb111-240" aria-hidden="true" tabindex="-1"></a>    ax.spines[<span class="st">"left"</span>].set_bounds(<span class="dv">0</span>, <span class="dv">40</span>)</span>
<span id="cb111-241"><a href="#cb111-241" aria-hidden="true" tabindex="-1"></a>    ax.set_xticks([])  <span class="co"># range(len(budget_df.columns)))</span></span>
<span id="cb111-242"><a href="#cb111-242" aria-hidden="true" tabindex="-1"></a>    ax.set_xticklabels(</span>
<span id="cb111-243"><a href="#cb111-243" aria-hidden="true" tabindex="-1"></a>        []</span>
<span id="cb111-244"><a href="#cb111-244" aria-hidden="true" tabindex="-1"></a>    )  <span class="co"># [atpase_labelling[scenario[1]] for scenario in budget_df.columns])</span></span>
<span id="cb111-245"><a href="#cb111-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-246"><a href="#cb111-246" aria-hidden="true" tabindex="-1"></a>    ax.hlines(<span class="dv">0</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="fl">7.5</span>, color<span class="op">=</span><span class="st">"black"</span>, linewidth<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb111-247"><a href="#cb111-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-248"><a href="#cb111-248" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> x <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb111-249"><a href="#cb111-249" aria-hidden="true" tabindex="-1"></a>        ax.set_ylabel(</span>
<span id="cb111-250"><a href="#cb111-250" aria-hidden="true" tabindex="-1"></a>            <span class="st">"Hexose equivalents </span><span class="ch">\n</span><span class="st"> exported (+) or imported (–) </span><span class="ch">\n</span><span class="st"> by GC during phase </span><span class="ch">\n</span><span class="st">"</span></span>
<span id="cb111-251"><a href="#cb111-251" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r"(fmol$\cdot$GC$^{-1}$)"</span>,</span>
<span id="cb111-252"><a href="#cb111-252" aria-hidden="true" tabindex="-1"></a>            labelpad<span class="op">=</span><span class="dv">15</span>,</span>
<span id="cb111-253"><a href="#cb111-253" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb111-254"><a href="#cb111-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-255"><a href="#cb111-255" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb111-256"><a href="#cb111-256" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb111-257"><a href="#cb111-257" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>):</span>
<span id="cb111-258"><a href="#cb111-258" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> axs[y][x]</span>
<span id="cb111-259"><a href="#cb111-259" aria-hidden="true" tabindex="-1"></a>        letter <span class="op">=</span> string.ascii_uppercase[i]</span>
<span id="cb111-260"><a href="#cb111-260" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> x <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb111-261"><a href="#cb111-261" aria-hidden="true" tabindex="-1"></a>            ax.text(<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.92</span>, letter, size<span class="op">=</span><span class="st">"x-large"</span>, transform<span class="op">=</span>ax.transAxes)</span>
<span id="cb111-262"><a href="#cb111-262" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> x <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb111-263"><a href="#cb111-263" aria-hidden="true" tabindex="-1"></a>            ax.text(<span class="op">-</span><span class="fl">0.1</span>, <span class="fl">0.92</span>, letter, size<span class="op">=</span><span class="st">"x-large"</span>, transform<span class="op">=</span>ax.transAxes)</span>
<span id="cb111-264"><a href="#cb111-264" aria-hidden="true" tabindex="-1"></a>        i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb111-265"><a href="#cb111-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-266"><a href="#cb111-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-267"><a href="#cb111-267" aria-hidden="true" tabindex="-1"></a><span class="co"># fig.text(-0.02,0.25, "Hexose equivalents imported (+) \n or exported (-) by GC " r"(nmoles$\cdot$GC$^{-1}$)", rotation=90, va="center", ha="center", size="large")</span></span>
<span id="cb111-268"><a href="#cb111-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-269"><a href="#cb111-269" aria-hidden="true" tabindex="-1"></a>fig.savefig(</span>
<span id="cb111-270"><a href="#cb111-270" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"../plant_cell_paper/figure_6.svg"</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span></span>
<span id="cb111-271"><a href="#cb111-271" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb111-272"><a href="#cb111-272" aria-hidden="true" tabindex="-1"></a>fig.savefig(</span>
<span id="cb111-273"><a href="#cb111-273" aria-hidden="true" tabindex="-1"></a>    <span class="ss">f"../plant_cell_paper/figure_6.png"</span>, dpi<span class="op">=</span><span class="dv">300</span>, bbox_inches<span class="op">=</span><span class="st">"tight"</span></span>
<span id="cb111-274"><a href="#cb111-274" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-82-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>carbon_rank <span class="op">=</span> gc_carbon_production_consumption_nmoles_gc.<span class="bu">sum</span>().rank(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>atp_2_rank <span class="op">=</span> <span class="bu">abs</span>(atp_budget_df_reordered_nmoles_gc).xs(<span class="dv">2</span>, level<span class="op">=</span><span class="st">"Phase"</span>).<span class="bu">sum</span>().rank(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>atp_3_rank <span class="op">=</span> <span class="bu">abs</span>(atp_budget_df_reordered_nmoles_gc).xs(<span class="dv">3</span>, level<span class="op">=</span><span class="st">"Phase"</span>).<span class="bu">sum</span>().rank(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>atp_rank <span class="op">=</span> (<span class="bu">abs</span>(atp_budget_df_reordered_nmoles_gc).xs(<span class="dv">3</span>, level<span class="op">=</span><span class="st">"Phase"</span>)<span class="op">*</span><span class="fl">0.5</span> <span class="op">+</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>            <span class="bu">abs</span>(atp_budget_df_reordered_nmoles_gc).xs(<span class="dv">3</span>, level<span class="op">=</span><span class="st">"Phase"</span>)<span class="op">*</span><span class="fl">11.5</span>).<span class="bu">sum</span>().rank(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>nad_2_rank <span class="op">=</span> <span class="bu">abs</span>(nadh_nadph_budget_df_reordered_nmoles_gc).xs(<span class="dv">2</span>, level<span class="op">=</span><span class="st">"Phase"</span>).<span class="bu">sum</span>().rank(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>nad_3_rank <span class="op">=</span> <span class="bu">abs</span>(nadh_nadph_budget_df_reordered_nmoles_gc).xs(<span class="dv">3</span>, level<span class="op">=</span><span class="st">"Phase"</span>).<span class="bu">sum</span>().rank(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>nad_rank <span class="op">=</span> (<span class="bu">abs</span>(nadh_nadph_budget_df_reordered_nmoles_gc).xs(<span class="dv">3</span>, level<span class="op">=</span><span class="st">"Phase"</span>)<span class="op">*</span><span class="fl">0.5</span> <span class="op">+</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>            <span class="bu">abs</span>(nadh_nadph_budget_df_reordered_nmoles_gc).xs(<span class="dv">3</span>, level<span class="op">=</span><span class="st">"Phase"</span>)<span class="op">*</span><span class="fl">11.5</span>).<span class="bu">sum</span>().rank(ascending<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>pd.concat([carbon_rank, atp_2_rank, atp_3_rank, atp_rank, nad_2_rank, nad_3_rank, nad_rank], axis<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>          keys<span class="op">=</span>[<span class="st">"Carbon"</span>, <span class="st">"ATP 2"</span>, <span class="st">"ATP 3"</span>, <span class="st">"ATP Day"</span>, <span class="st">"NAD 2"</span>, <span class="st">"NAD 3"</span>, <span class="st">"NAD Day"</span>]).sort_values(<span class="st">"Carbon"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>Carbon</th>
      <th>ATP 2</th>
      <th>ATP 3</th>
      <th>ATP Day</th>
      <th>NAD 2</th>
      <th>NAD 3</th>
      <th>NAD Day</th>
    </tr>
    <tr>
      <th>Light</th>
      <th>ATPase</th>
      <th>Starch</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">white</th>
      <th rowspan="2" valign="top">constrained</th>
      <th>wt</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>starchko</th>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">blue</th>
      <th rowspan="2" valign="top">unconstrained</th>
      <th>starchko</th>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>wt</th>
      <td>4.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>5.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">constrained</th>
      <th>wt</th>
      <td>5.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>starchko</th>
      <td>6.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>8.0</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">nops</th>
      <th rowspan="2" valign="top">constrained</th>
      <th>wt</th>
      <td>7.0</td>
      <td>5.0</td>
      <td>8.0</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>8.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>starchko</th>
      <td>8.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<ul>
<li>Starch KO leads to lower carbon consumption and higher ATP and NAD turnover</li>
<li>Constraining ATPase leads to lower efficiency and higher ATP and NAD turnover</li>
<li>PS is more complicated because it’s both phases, so won’t include
<ul>
<li>Removing it vs blue eads to</li>
</ul></li>
</ul>
</section>
<section id="bits-and-bobs-for-paper" class="level2">
<h2 class="anchored" data-anchor-id="bits-and-bobs-for-paper">Bits and bobs for paper</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>blue_constrained_wt_osmolytes <span class="op">=</span> met_df_mm.loc[:, (<span class="st">"blue"</span>, <span class="st">"constrained"</span>, <span class="st">"wt"</span>, <span class="st">"fluxes"</span>)].unstack()</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>os_fraction <span class="op">=</span> (blue_constrained_wt_osmolytes.loc[<span class="fl">6.5</span>] <span class="op">-</span> blue_constrained_wt_osmolytes.loc[<span class="fl">6.0</span>]) <span class="op">/</span> (</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>    blue_constrained_wt_osmolytes.loc[<span class="fl">6.5</span>] <span class="op">-</span> blue_constrained_wt_osmolytes.loc[<span class="fl">6.0</span>]).<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>os_fraction</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Reaction
CIT        1.573448e-12
Cl         2.683538e+01
FRU        0.000000e+00
GLC        5.126735e+01
K          2.577402e+01
MAL       -3.863739e+00
STARCH    -1.300909e-02
SUCROSE    0.000000e+00
dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>blue_constrained_wt_osmolytes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>Reaction</th>
      <th>CIT</th>
      <th>Cl</th>
      <th>FRU</th>
      <th>GLC</th>
      <th>K</th>
      <th>MAL</th>
      <th>STARCH</th>
      <th>SUCROSE</th>
    </tr>
    <tr>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>-1.576202e-12</td>
      <td>17.792012</td>
      <td>0.0</td>
      <td>-8.322345e-12</td>
      <td>22.233377</td>
      <td>8.119376</td>
      <td>0.007155</td>
      <td>-1.588203e-11</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>-8.653558e-13</td>
      <td>17.792012</td>
      <td>0.0</td>
      <td>-8.322345e-12</td>
      <td>22.233377</td>
      <td>8.119376</td>
      <td>0.007155</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>6.5</th>
      <td>-2.581520e-28</td>
      <td>32.550776</td>
      <td>0.0</td>
      <td>2.819572e+01</td>
      <td>36.408419</td>
      <td>5.994419</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>18.0</th>
      <td>0.000000e+00</td>
      <td>17.792012</td>
      <td>0.0</td>
      <td>0.000000e+00</td>
      <td>22.233377</td>
      <td>8.119376</td>
      <td>0.007155</td>
      <td>-1.564578e-11</td>
    </tr>
    <tr>
      <th>24.0</th>
      <td>-1.576202e-12</td>
      <td>17.792012</td>
      <td>0.0</td>
      <td>-8.322345e-12</td>
      <td>22.233377</td>
      <td>8.119376</td>
      <td>0.007155</td>
      <td>-1.588203e-11</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>os_fraction.loc[<span class="st">"Cl"</span>]<span class="op">+</span>os_fraction.loc[<span class="st">"K"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>52.609396448638556</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>(blue_constrained_wt_osmolytes.loc[<span class="fl">6.5</span>] <span class="op">-</span> blue_constrained_wt_osmolytes.loc[<span class="fl">6.0</span>]).loc[<span class="st">"Cl"</span>] <span class="op">+</span> <span class="op">\</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>    (blue_constrained_wt_osmolytes.loc[<span class="fl">6.5</span>] <span class="op">-</span> blue_constrained_wt_osmolytes.loc[<span class="fl">6.0</span>]).loc[<span class="st">"K"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>28.93380608398066</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>solutions_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="10" halign="left">blue</th>
      <th>...</th>
      <th colspan="10" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="6" halign="left">unconstrained</th>
      <th colspan="4" halign="left">constrained</th>
      <th>...</th>
      <th colspan="4" halign="left">unconstrained</th>
      <th colspan="6" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th colspan="3" halign="left">wt</th>
      <th colspan="3" halign="left">starchko</th>
      <th colspan="3" halign="left">wt</th>
      <th>starchko</th>
      <th>...</th>
      <th>wt</th>
      <th colspan="3" halign="left">starchko</th>
      <th colspan="3" halign="left">wt</th>
      <th colspan="3" halign="left">starchko</th>
    </tr>
    <tr>
      <th></th>
      <th>Solution</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>...</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">EX_X_pi_t_me</th>
      <th>1</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>EX_X_pi_t_gc</th>
      <th>1</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Cl_total_pseudolinker</th>
      <th>4</th>
      <td>4.899985e-03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.900221e-03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.921359e-03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.414718e-18</td>
      <td>...</td>
      <td>NaN</td>
      <td>-7.081374e-16</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-5.299512e-19</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">CIT_total_pseudolinker</th>
      <th>1</th>
      <td>0.000000e+00</td>
      <td>-3.311882e-15</td>
      <td>0.010896</td>
      <td>-2.565624e-17</td>
      <td>0.0</td>
      <td>0.010896</td>
      <td>-1.907244e-16</td>
      <td>0.000000e+00</td>
      <td>0.010896</td>
      <td>1.321796e-19</td>
      <td>...</td>
      <td>0.010896</td>
      <td>-1.208859e-32</td>
      <td>0.0</td>
      <td>0.010896</td>
      <td>0.000563</td>
      <td>0.0</td>
      <td>0.010896</td>
      <td>4.818565e-04</td>
      <td>0.0</td>
      <td>0.010896</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.448218e-16</td>
      <td>0.000000e+00</td>
      <td>0.011386</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.011386</td>
      <td>-6.550608e-32</td>
      <td>2.449103e-16</td>
      <td>0.011386</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>0.011386</td>
      <td>3.448298e-18</td>
      <td>0.0</td>
      <td>0.011386</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.011386</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.009961</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.221401e-16</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-7.845672e-18</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>-1.948321e-17</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000563</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.818565e-04</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.221401e-16</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.411683e-17</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.473949e-16</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.238173e-20</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000563</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.818565e-04</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>7101 rows × 36 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"K_ec_gc"</span>, <span class="dv">2</span>), :] <span class="op">+</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(<span class="st">"Cl_PROTON_ec_gc"</span>, <span class="dv">2</span>), :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
blue   unconstrained  wt          0.024387
                      starchko    0.024387
       constrained    wt          0.013015
                      starchko    0.013015
white  unconstrained  wt          0.023240
                      starchko    0.023240
       constrained    wt          0.013015
                      starchko    0.013015
nops   unconstrained  wt          0.023345
                      starchko    0.023345
       constrained    wt          0.013015
                      starchko    0.013015
dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.013015</span><span class="op">/</span><span class="fl">0.024387</span><span class="op">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>53.36859802353714</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>blue_constrained_starcko_osmolytes <span class="op">=</span> met_df_mm.loc[:, (<span class="st">"blue"</span>, <span class="st">"constrained"</span>, <span class="st">"starchko"</span>, <span class="st">"fluxes"</span>)].unstack()</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>os_fraction <span class="op">=</span> (blue_constrained_wt_osmolytes.loc[<span class="fl">6.5</span>] <span class="op">-</span> blue_constrained_wt_osmolytes.loc[<span class="fl">6.0</span>]) <span class="op">/</span> (</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>    blue_constrained_wt_osmolytes.loc[<span class="fl">6.5</span>] <span class="op">-</span> blue_constrained_wt_osmolytes.loc[<span class="fl">6.0</span>]).<span class="bu">sum</span>() <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>os_fraction</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Reaction
CIT        1.573448e-12
Cl         2.683538e+01
FRU        0.000000e+00
GLC        5.126735e+01
K          2.577402e+01
MAL       -3.863739e+00
STARCH    -1.300909e-02
SUCROSE    0.000000e+00
dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>blue_constrained_wt_osmolytes.loc[[<span class="dv">6</span>, <span class="fl">6.5</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>Reaction</th>
      <th>CIT</th>
      <th>Cl</th>
      <th>FRU</th>
      <th>GLC</th>
      <th>K</th>
      <th>MAL</th>
      <th>STARCH</th>
      <th>SUCROSE</th>
    </tr>
    <tr>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6.0</th>
      <td>-8.653558e-13</td>
      <td>17.792012</td>
      <td>0.0</td>
      <td>-8.322345e-12</td>
      <td>22.233377</td>
      <td>8.119376</td>
      <td>0.007155</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6.5</th>
      <td>-2.581520e-28</td>
      <td>32.550776</td>
      <td>0.0</td>
      <td>2.819572e+01</td>
      <td>36.408419</td>
      <td>5.994419</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>blue_constrained_wt_osmolytes.loc[[<span class="dv">6</span>, <span class="fl">6.5</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>Reaction</th>
      <th>CIT</th>
      <th>Cl</th>
      <th>FRU</th>
      <th>GLC</th>
      <th>K</th>
      <th>MAL</th>
      <th>STARCH</th>
      <th>SUCROSE</th>
    </tr>
    <tr>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6.0</th>
      <td>-8.653558e-13</td>
      <td>17.792012</td>
      <td>0.0</td>
      <td>-8.322345e-12</td>
      <td>22.233377</td>
      <td>8.119376</td>
      <td>0.007155</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6.5</th>
      <td>-2.581520e-28</td>
      <td>32.550776</td>
      <td>0.0</td>
      <td>2.819572e+01</td>
      <td>36.408419</td>
      <td>5.994419</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>blue_constrained_starcko_osmolytes.loc[[<span class="dv">6</span>, <span class="fl">6.5</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>Reaction</th>
      <th>CIT</th>
      <th>Cl</th>
      <th>FRU</th>
      <th>GLC</th>
      <th>K</th>
      <th>MAL</th>
      <th>STARCH</th>
      <th>SUCROSE</th>
    </tr>
    <tr>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6.0</th>
      <td>5.997260e-16</td>
      <td>2.456769e-14</td>
      <td>-0.000001</td>
      <td>0.000000</td>
      <td>22.233378</td>
      <td>5.303941</td>
      <td>0.0</td>
      <td>3.203986e+01</td>
    </tr>
    <tr>
      <th>6.5</th>
      <td>0.000000e+00</td>
      <td>1.709714e+01</td>
      <td>27.828905</td>
      <td>27.828905</td>
      <td>36.408419</td>
      <td>3.915824</td>
      <td>0.0</td>
      <td>-5.356596e-14</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fl">27.828905</span><span class="op">*</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>55.65781</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>met_df.loc[:, (<span class="st">"white"</span>, <span class="st">"constrained"</span>)].xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[([<span class="fl">6.0</span>, <span class="fl">6.5</span>], <span class="st">"STARCH"</span>), :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/1419630875.py:1: PerformanceWarning: indexing past lexsort depth may impact performance.
  met_df.loc[:, ("white", "constrained")].xs("fluxes", level="Solution", axis=1).loc[([6.0, 6.5], "STARCH"), :]</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Phase</th>
      <th>Reaction</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6.0</th>
      <th>STARCH</th>
      <td>0.006747</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>6.5</th>
      <th>STARCH</th>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>(<span class="fl">0.006747</span> <span class="op">*</span> <span class="dv">10</span> <span class="op">**</span> <span class="op">-</span><span class="dv">3</span><span class="op">/</span>arabidopsis_supermodel.N_gcs) <span class="op">*</span> <span class="dv">10</span> <span class="op">**</span> <span class="dv">15</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>11.632758620689657</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(<span class="st">"PROTON_ATPase_c_gc"</span>, <span class="dv">2</span>), :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
blue   unconstrained  wt          0.008129
                      starchko    0.008129
       constrained    wt          0.004338
                      starchko    0.004338
white  unconstrained  wt          0.007747
                      starchko    0.007747
       constrained    wt          0.004338
                      starchko    0.004338
nops   unconstrained  wt          0.007963
                      starchko    0.007963
       constrained    wt          0.004338
                      starchko    0.004338
Name: (PROTON_ATPase_c_gc, 2), dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>solutions_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="10" halign="left">blue</th>
      <th>...</th>
      <th colspan="10" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="6" halign="left">unconstrained</th>
      <th colspan="4" halign="left">constrained</th>
      <th>...</th>
      <th colspan="4" halign="left">unconstrained</th>
      <th colspan="6" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th colspan="3" halign="left">wt</th>
      <th colspan="3" halign="left">starchko</th>
      <th colspan="3" halign="left">wt</th>
      <th>starchko</th>
      <th>...</th>
      <th>wt</th>
      <th colspan="3" halign="left">starchko</th>
      <th colspan="3" halign="left">wt</th>
      <th colspan="3" halign="left">starchko</th>
    </tr>
    <tr>
      <th></th>
      <th>Solution</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>...</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
      <th>fluxes</th>
      <th>minimum</th>
      <th>maximum</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">EX_X_pi_t_me</th>
      <th>1</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>EX_X_pi_t_gc</th>
      <th>1</th>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Cl_total_pseudolinker</th>
      <th>4</th>
      <td>4.899985e-03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.900221e-03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.921359e-03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.414718e-18</td>
      <td>...</td>
      <td>NaN</td>
      <td>-7.081374e-16</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-5.299512e-19</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">CIT_total_pseudolinker</th>
      <th>1</th>
      <td>0.000000e+00</td>
      <td>-3.311882e-15</td>
      <td>0.010896</td>
      <td>-2.565624e-17</td>
      <td>0.0</td>
      <td>0.010896</td>
      <td>-1.907244e-16</td>
      <td>0.000000e+00</td>
      <td>0.010896</td>
      <td>1.321796e-19</td>
      <td>...</td>
      <td>0.010896</td>
      <td>-1.208859e-32</td>
      <td>0.0</td>
      <td>0.010896</td>
      <td>0.000563</td>
      <td>0.0</td>
      <td>0.010896</td>
      <td>4.818565e-04</td>
      <td>0.0</td>
      <td>0.010896</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.448218e-16</td>
      <td>0.000000e+00</td>
      <td>0.011386</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.011386</td>
      <td>-6.550608e-32</td>
      <td>2.449103e-16</td>
      <td>0.011386</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>0.011386</td>
      <td>3.448298e-18</td>
      <td>0.0</td>
      <td>0.011386</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.011386</td>
      <td>0.000000e+00</td>
      <td>0.0</td>
      <td>0.009961</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.221401e-16</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-7.845672e-18</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>NaN</td>
      <td>-1.948321e-17</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000563</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.818565e-04</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.221401e-16</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-2.411683e-17</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>-3.473949e-16</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.238173e-20</td>
      <td>...</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000563</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.818565e-04</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>7101 rows × 36 columns</p>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>pm_proton_pump <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(<span class="st">"PROTONATP_rev_vc_gc"</span>, <span class="dv">2</span>), :]</span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> value <span class="kw">in</span> pm_proton_pump.values:</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'</span><span class="sc">{0:.10f}</span><span class="st">'</span>.<span class="bu">format</span>(value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.0036702884
0.0036702049
0.0052175915
0.0019039819
-0.0000000002
0.0000000007
0.0000327323
0.0000000000
0.0058439202
0.0058439202
0.0058439202
0.0041422750</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>tonoplast_proton_pump <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(<span class="st">"PROTON_PPi_rev_vc_gc"</span>, <span class="dv">2</span>), :]</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>tonoplast_proton_pump</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
blue   unconstrained  wt          0.000622
                      starchko    0.000622
       constrained    wt          0.000000
                      starchko    0.000000
white  unconstrained  wt          0.009596
                      starchko    0.009596
       constrained    wt          0.009862
                      starchko    0.009716
nops   unconstrained  wt          0.000000
                      starchko    0.000000
       constrained    wt          0.000000
                      starchko    0.000000
Name: (PROTON_PPi_rev_vc_gc, 2), dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>(pm_proton_pump <span class="op">+</span> tonoplast_proton_pump).plot.bar()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: xlabel='Light,ATPase,Starch'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-105-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(<span class="st">"PHOSGLYPHOS_RXN_c_gc"</span>, <span class="dv">2</span>), :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
blue   unconstrained  wt          8.289899e-04
                      starchko    8.290422e-04
       constrained    wt         -2.906954e-10
                      starchko    9.122828e-10
white  unconstrained  wt          0.000000e+00
                      starchko    0.000000e+00
       constrained    wt          0.000000e+00
                      starchko    0.000000e+00
nops   unconstrained  wt         -7.247574e-04
                      starchko   -7.247574e-04
       constrained    wt         -5.625591e-04
                      starchko    0.000000e+00
Name: (PHOSGLYPHOS_RXN_c_gc, 2), dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(<span class="st">"2PGADEHYDRAT_RXN_c_gc"</span>, <span class="dv">2</span>), :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
blue   unconstrained  wt         -8.289899e-04
                      starchko   -8.290422e-04
       constrained    wt          2.906983e-10
                      starchko   -9.122828e-10
white  unconstrained  wt         -8.965687e-04
                      starchko   -8.965681e-04
       constrained    wt         -7.543795e-04
                      starchko    0.000000e+00
nops   unconstrained  wt          7.247574e-04
                      starchko    7.247574e-04
       constrained    wt          5.625591e-04
                      starchko    0.000000e+00
Name: (2PGADEHYDRAT_RXN_c_gc, 2), dtype: float64</code></pre>
</div>
</div>
<p>MALATE_DEH_RXN_c_gc## Fraction is ATPase vs PPi for tonoplast</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>pm_proton_pump <span class="op">/</span> (pm_proton_pump <span class="op">+</span> tonoplast_proton_pump) <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
blue   unconstrained  wt           85.514028
                      starchko     85.512964
       constrained    wt          100.000000
                      starchko    100.000000
white  unconstrained  wt           -0.000002
                      starchko      0.000007
       constrained    wt            0.330800
                      starchko      0.000000
nops   unconstrained  wt          100.000000
                      starchko    100.000000
       constrained    wt          100.000000
                      starchko    100.000000
dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>plastidatp_reactions <span class="op">=</span> [reaction.<span class="bu">id</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> reaction <span class="kw">in</span> arabidopsis_supermodel.fba_model.metabolites.ATP_p_gc_2.reactions]</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>plastidatp_df <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(plastidatp_reactions, <span class="dv">2</span>), :]</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>plastidatp_df <span class="op">=</span> plastidatp_df.loc[<span class="op">~</span>(<span class="bu">abs</span>(plastidatp_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>).<span class="bu">all</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>plastidatp_df.mask(<span class="bu">abs</span>(plastidatp_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>, <span class="dv">0</span>).drop(</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>    [(<span class="st">"white"</span>, <span class="st">"unconstrained"</span>), (<span class="st">"nops"</span>, <span class="st">"unconstrained"</span>)], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/3663876372.py:5: PerformanceWarning: indexing past lexsort depth may impact performance.
  plastidatp_df.mask(abs(plastidatp_df) &lt; 0.0000000001, 0).drop(</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ATP_ADP_Pi_pc_gc</th>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.001723</td>
      <td>-0.001743</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>PHOSPHORIBULOKINASE_RXN_p_gc</th>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.010141</td>
      <td>0.010742</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>PHOSGLYPHOS_RXN_p_gc</th>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.021037</td>
      <td>0.020457</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Plastidial_ATP_Synthase_p_gc</th>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.009819</td>
      <td>0.009819</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>plastidatp_reactions <span class="op">=</span> [reaction.<span class="bu">id</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> reaction <span class="kw">in</span> arabidopsis_supermodel.fba_model.metabolites.ATP_p_gc_2.reactions]</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>plastidatp_df <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(plastidatp_reactions, <span class="dv">3</span>), :]</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>plastidatp_df <span class="op">=</span> plastidatp_df.loc[<span class="op">~</span>(<span class="bu">abs</span>(plastidatp_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>).<span class="bu">all</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>plastidatp_df.mask(<span class="bu">abs</span>(plastidatp_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>, <span class="dv">0</span>).drop(</span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>    [(<span class="st">"white"</span>, <span class="st">"unconstrained"</span>), (<span class="st">"nops"</span>, <span class="st">"unconstrained"</span>)], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/3680442761.py:5: PerformanceWarning: indexing past lexsort depth may impact performance.
  plastidatp_df.mask(abs(plastidatp_df) &lt; 0.0000000001, 0).drop(</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PEPDEPHOS_RXN_p_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000046</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>ATP_ADP_Pi_pc_gc</th>
      <th>3</th>
      <td>-0.002932</td>
      <td>-0.002932</td>
      <td>-0.003478</td>
      <td>-0.002659</td>
      <td>-0.003443</td>
      <td>-0.002737</td>
      <td>-0.000167</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>GLUC1PADENYLTRANS_RXN_p_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000622</td>
      <td>0.000000</td>
      <td>0.000587</td>
      <td>0.000000</td>
      <td>0.000259</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>PHOSPHORIBULOKINASE_RXN_p_gc</th>
      <th>3</th>
      <td>0.010819</td>
      <td>0.010819</td>
      <td>0.010779</td>
      <td>0.010710</td>
      <td>0.010782</td>
      <td>0.010701</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>PHOSGLYPHOS_RXN_p_gc</th>
      <th>3</th>
      <td>0.021569</td>
      <td>0.021569</td>
      <td>0.021534</td>
      <td>0.021405</td>
      <td>0.021531</td>
      <td>0.021448</td>
      <td>-0.000046</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Plastidial_ATP_Synthase_p_gc</th>
      <th>3</th>
      <td>0.009819</td>
      <td>0.009819</td>
      <td>0.009819</td>
      <td>0.009819</td>
      <td>0.009819</td>
      <td>0.009819</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>GLY3KIN_RXN_p_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000045</td>
      <td>0.000000</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>plastidatp_reactions <span class="op">=</span> [reaction.<span class="bu">id</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> reaction <span class="kw">in</span> arabidopsis_supermodel.fba_model.metabolites.ATP_c_gc_3.reactions]</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>plastidatp_df <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(plastidatp_reactions, <span class="dv">3</span>), :]</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>plastidatp_df <span class="op">=</span> plastidatp_df.loc[<span class="op">~</span>(<span class="bu">abs</span>(plastidatp_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>).<span class="bu">all</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>plastidatp_df.mask(<span class="bu">abs</span>(plastidatp_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>, <span class="dv">0</span>).drop(</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>    [(<span class="st">"white"</span>, <span class="st">"unconstrained"</span>), (<span class="st">"nops"</span>, <span class="st">"unconstrained"</span>)], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/861862047.py:5: PerformanceWarning: indexing past lexsort depth may impact performance.
  plastidatp_df.mask(abs(plastidatp_df) &lt; 0.0000000001, 0).drop(</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PEPCARBOXYKIN_RXN_c_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000024</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>PROTON_ATPase_c_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000305</td>
      <td>0.000319</td>
    </tr>
    <tr>
      <th>FRUCTOKINASE_RXN_c_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000614</td>
      <td>0.000000</td>
      <td>0.000499</td>
      <td>0.000328</td>
      <td>0.000599</td>
    </tr>
    <tr>
      <th>ATP_ADP_Pi_pc_gc</th>
      <th>3</th>
      <td>-0.002932</td>
      <td>-0.002932</td>
      <td>-0.003478</td>
      <td>-0.002659</td>
      <td>-0.003443</td>
      <td>-0.002737</td>
      <td>-0.000167</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>UDPKIN_RXN_c_gc</th>
      <th>3</th>
      <td>0.000884</td>
      <td>0.000884</td>
      <td>0.000581</td>
      <td>0.001196</td>
      <td>0.000597</td>
      <td>0.001152</td>
      <td>0.000023</td>
      <td>0.000280</td>
    </tr>
    <tr>
      <th>PEPDEPHOS_RXN_c_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000024</td>
      <td>0.000079</td>
    </tr>
    <tr>
      <th>PHOSGLYPHOS_RXN_c_gc</th>
      <th>3</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.000079</td>
    </tr>
    <tr>
      <th>ATP_ADP_mc_gc</th>
      <th>3</th>
      <td>0.003816</td>
      <td>0.003816</td>
      <td>0.004060</td>
      <td>0.004469</td>
      <td>0.004040</td>
      <td>0.004388</td>
      <td>0.000822</td>
      <td>0.001039</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>plastidatp_reactions <span class="op">=</span> [reaction.<span class="bu">id</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> reaction <span class="kw">in</span> arabidopsis_supermodel.fba_model.metabolites.NADPH_p_gc_2.reactions]</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>plastidatp_df <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(plastidatp_reactions, <span class="dv">3</span>), :]</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>plastidatp_df <span class="op">=</span> plastidatp_df.loc[<span class="op">~</span>(<span class="bu">abs</span>(plastidatp_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>).<span class="bu">all</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>plastidatp_df.mask(<span class="bu">abs</span>(plastidatp_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>, <span class="dv">0</span>).drop(</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>    [(<span class="st">"white"</span>, <span class="st">"unconstrained"</span>), (<span class="st">"nops"</span>, <span class="st">"unconstrained"</span>)], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/3683469779.py:5: PerformanceWarning: indexing past lexsort depth may impact performance.
  plastidatp_df.mask(abs(plastidatp_df) &lt; 0.0000000001, 0).drop(</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1_PERIOD_2_PERIOD_1_PERIOD_13_RXN_p_gc</th>
      <th>3</th>
      <td>0.021569</td>
      <td>0.021569</td>
      <td>0.021534</td>
      <td>0.021405</td>
      <td>0.021531</td>
      <td>0.021448</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1_PERIOD_18_PERIOD_1_PERIOD_2_RXN_p_gc</th>
      <th>3</th>
      <td>0.022910</td>
      <td>0.022910</td>
      <td>0.022910</td>
      <td>0.022910</td>
      <td>0.022910</td>
      <td>0.022910</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>MALATE_DEHYDROGENASE_NADPs_RXN_p_gc</th>
      <th>3</th>
      <td>0.001341</td>
      <td>0.001341</td>
      <td>0.001377</td>
      <td>0.001505</td>
      <td>0.001380</td>
      <td>0.001463</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>plastidatp_reactions <span class="op">=</span> [reaction.<span class="bu">id</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> reaction <span class="kw">in</span> arabidopsis_supermodel.fba_model.metabolites.NADH_c_gc_2.reactions]</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a>plastidatp_df <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(plastidatp_reactions, <span class="dv">2</span>), :]</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>plastidatp_df <span class="op">=</span> plastidatp_df.loc[<span class="op">~</span>(<span class="bu">abs</span>(plastidatp_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>).<span class="bu">all</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>plastidatp_df.mask(<span class="bu">abs</span>(plastidatp_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>, <span class="dv">0</span>).drop(</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>    [(<span class="st">"white"</span>, <span class="st">"unconstrained"</span>), (<span class="st">"nops"</span>, <span class="st">"unconstrained"</span>)], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/2230598337.py:5: PerformanceWarning: indexing past lexsort depth may impact performance.
  plastidatp_df.mask(abs(plastidatp_df) &lt; 0.0000000001, 0).drop(</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MALATE_DEH_RXN_c_gc</th>
      <th>2</th>
      <td>0.000829</td>
      <td>0.000829</td>
      <td>-2.906954e-10</td>
      <td>9.122828e-10</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.000563</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>GAPOXNPHOSPHN_RXN_c_gc</th>
      <th>2</th>
      <td>-0.000829</td>
      <td>-0.000829</td>
      <td>2.906954e-10</td>
      <td>-9.122828e-10</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000563</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.003478</span><span class="op">-</span><span class="fl">0.002659</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.0008190000000000003</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.020457</span><span class="op">+</span><span class="fl">0.010742</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.031198999999999998</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(<span class="st">"PROTON_ATPase_c_gc"</span>, <span class="dv">2</span>), :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
blue   unconstrained  wt          0.008129
                      starchko    0.008129
       constrained    wt          0.004338
                      starchko    0.004338
white  unconstrained  wt          0.007747
                      starchko    0.007747
       constrained    wt          0.004338
                      starchko    0.004338
nops   unconstrained  wt          0.007963
                      starchko    0.007963
       constrained    wt          0.004338
                      starchko    0.004338
Name: (PROTON_ATPase_c_gc, 2), dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(<span class="st">"MALATE_DEHYDROGENASE_NADPs_RXN_p_gc"</span>, <span class="dv">2</span>), :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
blue   unconstrained  wt          0.000000
                      starchko    0.000000
       constrained    wt          0.000000
                      starchko    0.000000
white  unconstrained  wt          0.002544
                      starchko    0.002544
       constrained    wt          0.001873
                      starchko    0.003479
nops   unconstrained  wt          0.000000
                      starchko    0.000000
       constrained    wt          0.000000
                      starchko    0.000000
Name: (MALATE_DEHYDROGENASE_NADPs_RXN_p_gc, 2), dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>tonoplast_proton_transport_df <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[([<span class="st">"PROTON_PPi_rev_vc_gc"</span>, <span class="st">"PROTONATP_rev_vc_gc"</span>], <span class="dv">2</span>), :].drop(</span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>    [(<span class="st">"white"</span>, <span class="st">"unconstrained"</span>), (<span class="st">"nops"</span>, <span class="st">"unconstrained"</span>)], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>tonoplast_proton_transport_df.index <span class="op">=</span> [<span class="st">"PPi Pump"</span>, <span class="st">"ATPase Pump"</span>]</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>tonoplast_proton_transport_df.T.plot(kind<span class="op">=</span><span class="st">'bar'</span>, stacked<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax)</span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">"Flux (mmoles$\cdot$m$^{-2}$$\cdot$h$^{-1}$)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/2314583387.py:3: PerformanceWarning: indexing past lexsort depth may impact performance.
  tonoplast_proton_transport_df = solutions_df.xs("fluxes", level="Solution", axis=1).loc[(["PROTON_PPi_rev_vc_gc", "PROTONATP_rev_vc_gc"], 2), :].drop(</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>Text(0, 0.5, 'Flux (mmoles$\\cdot$m$^{-2}$$\\cdot$h$^{-1}$)')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-118-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>tonoplast_proton_transport_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PPi Pump</th>
      <td>0.000622</td>
      <td>0.000622</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.009862</td>
      <td>0.009716</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>ATPase Pump</th>
      <td>0.003670</td>
      <td>0.003670</td>
      <td>0.005218</td>
      <td>0.001904</td>
      <td>0.000033</td>
      <td>0.000000</td>
      <td>0.005844</td>
      <td>0.004142</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[([<span class="st">"PROTON_PPi_rev_vc_gc"</span>, <span class="st">"PROTONATP_rev_vc_gc"</span>], <span class="dv">2</span>), :].drop(</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>    [(<span class="st">"white"</span>, <span class="st">"unconstrained"</span>), (<span class="st">"nops"</span>, <span class="st">"unconstrained"</span>)], axis<span class="op">=</span><span class="dv">1</span>).<span class="bu">sum</span>().plot.bar()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/3027342076.py:1: PerformanceWarning: indexing past lexsort depth may impact performance.
  solutions_df.xs("fluxes", level="Solution", axis=1).loc[(["PROTON_PPi_rev_vc_gc", "PROTONATP_rev_vc_gc"], 2), :].drop(</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: xlabel='Light,ATPase,Starch'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-120-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>ppi_reactions <span class="op">=</span> [reaction.<span class="bu">id</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">for</span> reaction <span class="kw">in</span> arabidopsis_supermodel.fba_model.metabolites.PPI_c_gc_2.reactions]</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>ppi_df <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(ppi_reactions, <span class="dv">2</span>), :]</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>ppi_df <span class="op">=</span> ppi_df.loc[<span class="op">~</span>(<span class="bu">abs</span>(ppi_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>).<span class="bu">all</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>ppi_df.mask(<span class="bu">abs</span>(ppi_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>, <span class="dv">0</span>).drop(</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>    [(<span class="st">"white"</span>, <span class="st">"unconstrained"</span>), (<span class="st">"nops"</span>, <span class="st">"unconstrained"</span>)], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/3140086841.py:5: PerformanceWarning: indexing past lexsort depth may impact performance.
  ppi_df.mask(abs(ppi_df) &lt; 0.0000000001, 0).drop(</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2_PERIOD_7_PERIOD_1_PERIOD_90_RXN_c_gc</th>
      <th>2</th>
      <td>-0.000414</td>
      <td>-0.000415</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.008828</td>
      <td>-0.008438</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>GLUC1PURIDYLTRANS_RXN_c_gc</th>
      <th>2</th>
      <td>0.000207</td>
      <td>0.000207</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.001034</td>
      <td>0.001277</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>PROTON_PPi_rev_vc_gc</th>
      <th>2</th>
      <td>0.000622</td>
      <td>0.000622</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.009862</td>
      <td>0.009716</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>ppi_reactions <span class="op">=</span> [reaction.<span class="bu">id</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">for</span> reaction <span class="kw">in</span> arabidopsis_supermodel.fba_model.metabolites.PPI_p_gc_2.reactions]</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>ppi_df <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(ppi_reactions, <span class="dv">2</span>), :]</span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>ppi_df <span class="op">=</span> ppi_df.loc[<span class="op">~</span>(<span class="bu">abs</span>(ppi_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>).<span class="bu">all</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>ppi_df.mask(<span class="bu">abs</span>(ppi_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>, <span class="dv">0</span>).drop(</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>    [(<span class="st">"white"</span>, <span class="st">"unconstrained"</span>), (<span class="st">"nops"</span>, <span class="st">"unconstrained"</span>)], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/2145986697.py:5: PerformanceWarning: indexing past lexsort depth may impact performance.
  ppi_df.mask(abs(ppi_df) &lt; 0.0000000001, 0).drop(</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>boundary_reactions <span class="op">=</span> [reaction.<span class="bu">id</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>                      <span class="cf">for</span> reaction <span class="kw">in</span> arabidopsis_supermodel.fba_model.reactions <span class="cf">if</span> <span class="st">"_tx"</span> <span class="kw">in</span> reaction.<span class="bu">id</span>]</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>nitrate_uptake <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(<span class="st">"NITRATE_a_tx"</span>, <span class="bu">slice</span>(<span class="va">None</span>)), :]</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>nitrate_uptake</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="4" halign="left">white</th>
      <th colspan="4" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">NITRATE_a_tx</th>
      <th>1</th>
      <td>0.018952</td>
      <td>0.018952</td>
      <td>0.018952</td>
      <td>0.018952</td>
      <td>0.019835</td>
      <td>0.019835</td>
      <td>0.019835</td>
      <td>0.019835</td>
      <td>0.019831</td>
      <td>0.019831</td>
      <td>0.019831</td>
      <td>0.019831</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.056855</td>
      <td>0.056855</td>
      <td>0.056855</td>
      <td>0.056855</td>
      <td>0.251324</td>
      <td>0.251324</td>
      <td>0.251324</td>
      <td>0.251324</td>
      <td>0.251274</td>
      <td>0.251274</td>
      <td>0.251274</td>
      <td>0.251274</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.307408</td>
      <td>0.307408</td>
      <td>0.307408</td>
      <td>0.307408</td>
      <td>0.313542</td>
      <td>0.313542</td>
      <td>0.313542</td>
      <td>0.313541</td>
      <td>0.313480</td>
      <td>0.313480</td>
      <td>0.313479</td>
      <td>0.313479</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.012861</td>
      <td>0.012861</td>
      <td>0.012861</td>
      <td>0.012861</td>
      <td>0.013183</td>
      <td>0.013183</td>
      <td>0.013183</td>
      <td>0.013183</td>
      <td>0.013181</td>
      <td>0.013181</td>
      <td>0.013181</td>
      <td>0.013181</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mmon_gcm.analysing <span class="im">import</span> get_phase_lengths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>phase_lengths <span class="op">=</span> get_phase_lengths(arabidopsis_supermodel.fba_model)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>phase_lengths</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>[6.0, 0.5, 11.5, 6.0]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, phase_length <span class="kw">in</span> <span class="bu">zip</span>([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], phase_lengths):</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>    nitrate_uptake.loc[(<span class="st">"NITRATE_a_tx"</span>, i), :] <span class="op">=</span> nitrate_uptake.loc[(<span class="st">"NITRATE_a_tx"</span>, i), :] <span class="op">*</span> phase_length</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>nitrate_uptake</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="4" halign="left">white</th>
      <th colspan="4" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">NITRATE_a_tx</th>
      <th>1</th>
      <td>0.113710</td>
      <td>0.113710</td>
      <td>0.113710</td>
      <td>0.113710</td>
      <td>0.119010</td>
      <td>0.119010</td>
      <td>0.119010</td>
      <td>0.119010</td>
      <td>0.118987</td>
      <td>0.118987</td>
      <td>0.118987</td>
      <td>0.118987</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.028428</td>
      <td>0.028428</td>
      <td>0.028428</td>
      <td>0.028428</td>
      <td>0.125662</td>
      <td>0.125662</td>
      <td>0.125662</td>
      <td>0.125662</td>
      <td>0.125637</td>
      <td>0.125637</td>
      <td>0.125637</td>
      <td>0.125637</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.535195</td>
      <td>3.535195</td>
      <td>3.535194</td>
      <td>3.535191</td>
      <td>3.605729</td>
      <td>3.605729</td>
      <td>3.605728</td>
      <td>3.605724</td>
      <td>3.605016</td>
      <td>3.605016</td>
      <td>3.605006</td>
      <td>3.605004</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.077167</td>
      <td>0.077167</td>
      <td>0.077167</td>
      <td>0.077167</td>
      <td>0.079101</td>
      <td>0.079101</td>
      <td>0.079101</td>
      <td>0.079101</td>
      <td>0.079085</td>
      <td>0.079085</td>
      <td>0.079085</td>
      <td>0.079085</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>nitrate_uptake_day <span class="op">=</span> nitrate_uptake.loc[(<span class="bu">slice</span>(<span class="va">None</span>), [<span class="dv">2</span>, <span class="dv">3</span>]), :].<span class="bu">sum</span>()</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>nitrate_uptake_night <span class="op">=</span> nitrate_uptake.loc[(<span class="bu">slice</span>(<span class="va">None</span>), [<span class="dv">1</span>, <span class="dv">4</span>]), :].<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>nitrate_uptake_day</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
blue   unconstrained  wt          3.563623
                      starchko    3.563623
       constrained    wt          3.563621
                      starchko    3.563619
white  unconstrained  wt          3.731391
                      starchko    3.731391
       constrained    wt          3.731390
                      starchko    3.731386
nops   unconstrained  wt          3.730653
                      starchko    3.730653
       constrained    wt          3.730643
                      starchko    3.730641
dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>nitrate_uptake_night</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
blue   unconstrained  wt          0.190877
                      starchko    0.190877
       constrained    wt          0.190877
                      starchko    0.190877
white  unconstrained  wt          0.198111
                      starchko    0.198111
       constrained    wt          0.198111
                      starchko    0.198111
nops   unconstrained  wt          0.198072
                      starchko    0.198072
       constrained    wt          0.198071
                      starchko    0.198071
dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>nitrate_uptake_day<span class="op">/</span>nitrate_uptake_night</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
blue   unconstrained  wt          18.669741
                      starchko    18.669741
       constrained    wt          18.669741
                      starchko    18.669741
white  unconstrained  wt          18.834845
                      starchko    18.834845
       constrained    wt          18.834845
                      starchko    18.834845
nops   unconstrained  wt          18.834845
                      starchko    18.834845
       constrained    wt          18.834845
                      starchko    18.834845
dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>nitrate_uptake <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(<span class="st">"NITRATE_a_Linker"</span>, <span class="bu">slice</span>(<span class="va">None</span>)), :]</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>nitrate_uptake</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="4" halign="left">white</th>
      <th colspan="4" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">NITRATE_a_Linker</th>
      <th>1</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>nitrate_uptake <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(<span class="st">"NITRATE_ae_me"</span>, <span class="bu">slice</span>(<span class="va">None</span>)), :]</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>nitrate_uptake</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="4" halign="left">white</th>
      <th colspan="4" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">NITRATE_ae_me</th>
      <th>1</th>
      <td>0.018952</td>
      <td>0.018952</td>
      <td>0.018952</td>
      <td>0.018952</td>
      <td>0.019835</td>
      <td>0.019835</td>
      <td>0.019835</td>
      <td>0.019835</td>
      <td>0.019831</td>
      <td>0.019831</td>
      <td>0.019831</td>
      <td>0.019831</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.056855</td>
      <td>0.056855</td>
      <td>0.056855</td>
      <td>0.056855</td>
      <td>0.251324</td>
      <td>0.251324</td>
      <td>0.251324</td>
      <td>0.251324</td>
      <td>0.251274</td>
      <td>0.251274</td>
      <td>0.251274</td>
      <td>0.251274</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.307408</td>
      <td>0.307408</td>
      <td>0.307408</td>
      <td>0.307408</td>
      <td>0.313542</td>
      <td>0.313542</td>
      <td>0.313542</td>
      <td>0.313541</td>
      <td>0.313480</td>
      <td>0.313480</td>
      <td>0.313479</td>
      <td>0.313479</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.012861</td>
      <td>0.012861</td>
      <td>0.012861</td>
      <td>0.012861</td>
      <td>0.013183</td>
      <td>0.013183</td>
      <td>0.013183</td>
      <td>0.013183</td>
      <td>0.013181</td>
      <td>0.013181</td>
      <td>0.013181</td>
      <td>0.013181</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>arabidopsis_supermodel.fba_model.metabolites.NITRATE_e_gc_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">


        <table>
            <tbody><tr>
                <td><strong>Metabolite identifier</strong></td><td>NITRATE_e_gc_2</td>
            </tr><tr>
                <td><strong>Name</strong></td><td>NITRATE_gc_2</td>
            </tr><tr>
                <td><strong>Memory address</strong></td>
                <td>0x7f49b8b345e0</td>
            </tr><tr>
                <td><strong>Formula</strong></td><td>N1O3</td>
            </tr><tr>
                <td><strong>Compartment</strong></td><td>e</td>
            </tr><tr>
                <td><strong>In 2 reaction(s)</strong></td><td>
                    Nitrate_ec_gc_2, NITRATE_ae_gc_2
                    </td>
            </tr>
        </tbody></table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>filtered_reactions <span class="op">=</span> [reaction.<span class="bu">id</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>                      <span class="cf">for</span> reaction <span class="kw">in</span> arabidopsis_supermodel.fba_model.metabolites.NADH_c_gc_2.reactions]</span>
<span id="cb198-3"><a href="#cb198-3" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(filtered_reactions, <span class="dv">2</span>), :]</span>
<span id="cb198-4"><a href="#cb198-4" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> filtered_df.loc[<span class="op">~</span>(<span class="bu">abs</span>(filtered_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>).<span class="bu">all</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb198-5"><a href="#cb198-5" aria-hidden="true" tabindex="-1"></a>filtered_df.mask(<span class="bu">abs</span>(filtered_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>, <span class="dv">0</span>).drop(</span>
<span id="cb198-6"><a href="#cb198-6" aria-hidden="true" tabindex="-1"></a>    [(<span class="st">"white"</span>, <span class="st">"unconstrained"</span>), (<span class="st">"nops"</span>, <span class="st">"unconstrained"</span>)], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/2420179439.py:5: PerformanceWarning: indexing past lexsort depth may impact performance.
  filtered_df.mask(abs(filtered_df) &lt; 0.0000000001, 0).drop(</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MALATE_DEH_RXN_c_gc</th>
      <th>2</th>
      <td>0.000829</td>
      <td>0.000829</td>
      <td>-2.906954e-10</td>
      <td>9.122828e-10</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>-0.000563</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>GAPOXNPHOSPHN_RXN_c_gc</th>
      <th>2</th>
      <td>-0.000829</td>
      <td>-0.000829</td>
      <td>2.906954e-10</td>
      <td>-9.122828e-10</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.000563</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>filtered_reactions <span class="op">=</span> [reaction.<span class="bu">id</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>                      <span class="cf">for</span> reaction <span class="kw">in</span> arabidopsis_supermodel.fba_model.metabolites.ATP_c_gc_2.reactions]</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(filtered_reactions, <span class="dv">2</span>), :]</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> filtered_df.loc[<span class="op">~</span>(<span class="bu">abs</span>(filtered_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>).<span class="bu">all</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>filtered_df.mask(<span class="bu">abs</span>(filtered_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>, <span class="dv">0</span>).drop(</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>    [(<span class="st">"white"</span>, <span class="st">"unconstrained"</span>), (<span class="st">"nops"</span>, <span class="st">"unconstrained"</span>)], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/1610886466.py:5: PerformanceWarning: indexing past lexsort depth may impact performance.
  filtered_df.mask(abs(filtered_df) &lt; 0.0000000001, 0).drop(</code></pre>
</div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Light</th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="2" halign="left">white</th>
      <th colspan="2" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th>ATPase</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th>Starch</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Reaction</th>
      <th>Phase</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>PROTON_ATPase_c_gc</th>
      <th>2</th>
      <td>0.008129</td>
      <td>0.008129</td>
      <td>4.338400e-03</td>
      <td>4.338400e-03</td>
      <td>0.004338</td>
      <td>0.004338</td>
      <td>0.004338</td>
      <td>0.004338</td>
    </tr>
    <tr>
      <th>UDPKIN_RXN_c_gc</th>
      <th>2</th>
      <td>0.000207</td>
      <td>0.000207</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.001034</td>
      <td>0.001277</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>ATP_ADP_Pi_pc_gc</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>-0.001723</td>
      <td>-0.001743</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>PEPDEPHOS_RXN_c_gc</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.906983e-10</td>
      <td>3.506957e-04</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>PHOSGLYPHOS_RXN_c_gc</th>
      <th>2</th>
      <td>0.000829</td>
      <td>0.000829</td>
      <td>-2.906954e-10</td>
      <td>9.122828e-10</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.000563</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>PROTONATP_rev_vc_gc</th>
      <th>2</th>
      <td>0.003670</td>
      <td>0.003670</td>
      <td>5.217592e-03</td>
      <td>1.903982e-03</td>
      <td>0.000033</td>
      <td>0.000000</td>
      <td>0.005844</td>
      <td>0.004142</td>
    </tr>
    <tr>
      <th>6PFRUCTPHOS_RXN_c_gc</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.453477e-10</td>
      <td>-4.561414e-10</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000281</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>FRUCTOKINASE_RXN_c_gc</th>
      <th>2</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>-4.561414e-10</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>PEPCARBOXYKIN_RXN_c_gc</th>
      <th>2</th>
      <td>0.000829</td>
      <td>0.000829</td>
      <td>0.000000e+00</td>
      <td>3.506966e-04</td>
      <td>0.000754</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>ATP_ADP_mc_gc</th>
      <th>2</th>
      <td>0.013664</td>
      <td>0.013664</td>
      <td>9.555991e-03</td>
      <td>6.242383e-03</td>
      <td>0.007882</td>
      <td>0.007359</td>
      <td>0.009901</td>
      <td>0.008481</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>filtered_reactions <span class="op">=</span> [reaction.<span class="bu">id</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>                      <span class="cf">for</span> reaction <span class="kw">in</span> arabidopsis_supermodel.fba_model.metabolites.ATP_c_gc_2.reactions]</span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(filtered_reactions, <span class="dv">2</span>), :]</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> filtered_df.loc[<span class="op">~</span>(<span class="bu">abs</span>(filtered_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>).<span class="bu">all</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>filtered_df.mask(<span class="bu">abs</span>(filtered_df) <span class="op">&lt;</span> <span class="fl">0.0000000001</span>, <span class="dv">0</span>).loc[:, (<span class="st">"white"</span>, <span class="st">"constrained"</span>, <span class="st">"wt"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Reaction                Phase
PROTON_ATPase_c_gc      2        0.004338
UDPKIN_RXN_c_gc         2        0.001034
ATP_ADP_Pi_pc_gc        2       -0.001723
PEPDEPHOS_RXN_c_gc      2        0.000000
PHOSGLYPHOS_RXN_c_gc    2        0.000000
PROTONATP_rev_vc_gc     2        0.000033
6PFRUCTPHOS_RXN_c_gc    2        0.000000
FRUCTOKINASE_RXN_c_gc   2        0.000000
PEPCARBOXYKIN_RXN_c_gc  2        0.000754
ATP_ADP_mc_gc           2        0.007882
Name: (white, constrained, wt), dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(<span class="st">"PEPCARBOXYKIN_RXN_c_gc"</span>, <span class="dv">2</span>), :].drop(</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>    [(<span class="st">"white"</span>, <span class="st">"unconstrained"</span>), (<span class="st">"nops"</span>, <span class="st">"unconstrained"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/990213441.py:1: PerformanceWarning: indexing past lexsort depth may impact performance.
  solutions_df.xs("fluxes", level="Solution", axis=1).loc[("PEPCARBOXYKIN_RXN_c_gc", 2), :].drop(</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
blue   unconstrained  wt          0.000829
                      starchko    0.000829
       constrained    wt          0.000000
                      starchko    0.000351
white  constrained    wt          0.000754
                      starchko    0.000000
nops   constrained    wt          0.000000
                      starchko    0.000000
Name: (PEPCARBOXYKIN_RXN_c_gc, 2), dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>phloem_outputs <span class="op">=</span> solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(<span class="st">"Phloem_tx_overall"</span>, np.nan), :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>phloem_outputs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
blue   unconstrained  wt          15.179976
                      starchko    15.179976
       constrained    wt          15.179970
                      starchko    15.179958
white  unconstrained  wt          15.887536
                      starchko    15.887536
       constrained    wt          15.887530
                      starchko    15.887515
nops   unconstrained  wt          15.884392
                      starchko    15.884392
       constrained    wt          15.884351
                      starchko    15.884343
Name: (Phloem_tx_overall, nan), dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>phloem_outputs_dict <span class="op">=</span> {}</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name, value <span class="kw">in</span> phloem_outputs.items():</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>    phloem_outputs_dict[name] <span class="op">=</span> (phloem_outputs<span class="op">/</span>value <span class="op">*</span> <span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>phloem_outputs_comparison_table <span class="op">=</span> pd.DataFrame.from_dict(phloem_outputs_dict)</span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>phloem_outputs_comparison_table.to_csv(<span class="st">"../outputs/efficiency_comparisons/phloem_outputs_compare.csv"</span>)</span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a>phloem_outputs_comparison_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="4" halign="left">blue</th>
      <th colspan="4" halign="left">white</th>
      <th colspan="4" halign="left">nops</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
      <th colspan="2" halign="left">unconstrained</th>
      <th colspan="2" halign="left">constrained</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
      <th>wt</th>
      <th>starchko</th>
    </tr>
    <tr>
      <th>Light</th>
      <th>ATPase</th>
      <th>Starch</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">blue</th>
      <th rowspan="2" valign="top">unconstrained</th>
      <th>wt</th>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>95.546</td>
      <td>95.546</td>
      <td>95.546</td>
      <td>95.547</td>
      <td>95.565</td>
      <td>95.565</td>
      <td>95.566</td>
      <td>95.566</td>
    </tr>
    <tr>
      <th>starchko</th>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>95.546</td>
      <td>95.546</td>
      <td>95.546</td>
      <td>95.547</td>
      <td>95.565</td>
      <td>95.565</td>
      <td>95.566</td>
      <td>95.566</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">constrained</th>
      <th>wt</th>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>95.546</td>
      <td>95.546</td>
      <td>95.546</td>
      <td>95.547</td>
      <td>95.565</td>
      <td>95.565</td>
      <td>95.566</td>
      <td>95.566</td>
    </tr>
    <tr>
      <th>starchko</th>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>95.546</td>
      <td>95.546</td>
      <td>95.546</td>
      <td>95.546</td>
      <td>95.565</td>
      <td>95.565</td>
      <td>95.565</td>
      <td>95.566</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">white</th>
      <th rowspan="2" valign="top">unconstrained</th>
      <th>wt</th>
      <td>104.661</td>
      <td>104.661</td>
      <td>104.661</td>
      <td>104.661</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.020</td>
      <td>100.020</td>
      <td>100.020</td>
      <td>100.020</td>
    </tr>
    <tr>
      <th>starchko</th>
      <td>104.661</td>
      <td>104.661</td>
      <td>104.661</td>
      <td>104.661</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.020</td>
      <td>100.020</td>
      <td>100.020</td>
      <td>100.020</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">constrained</th>
      <th>wt</th>
      <td>104.661</td>
      <td>104.661</td>
      <td>104.661</td>
      <td>104.661</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.020</td>
      <td>100.020</td>
      <td>100.020</td>
      <td>100.020</td>
    </tr>
    <tr>
      <th>starchko</th>
      <td>104.661</td>
      <td>104.661</td>
      <td>104.661</td>
      <td>104.661</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.020</td>
      <td>100.020</td>
      <td>100.020</td>
      <td>100.020</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">nops</th>
      <th rowspan="2" valign="top">unconstrained</th>
      <th>wt</th>
      <td>104.640</td>
      <td>104.640</td>
      <td>104.640</td>
      <td>104.641</td>
      <td>99.980</td>
      <td>99.980</td>
      <td>99.980</td>
      <td>99.980</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
    </tr>
    <tr>
      <th>starchko</th>
      <td>104.640</td>
      <td>104.640</td>
      <td>104.640</td>
      <td>104.641</td>
      <td>99.980</td>
      <td>99.980</td>
      <td>99.980</td>
      <td>99.980</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">constrained</th>
      <th>wt</th>
      <td>104.640</td>
      <td>104.640</td>
      <td>104.640</td>
      <td>104.640</td>
      <td>99.980</td>
      <td>99.980</td>
      <td>99.980</td>
      <td>99.980</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
    </tr>
    <tr>
      <th>starchko</th>
      <td>104.640</td>
      <td>104.640</td>
      <td>104.640</td>
      <td>104.640</td>
      <td>99.980</td>
      <td>99.980</td>
      <td>99.980</td>
      <td>99.980</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
      <td>100.000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span><span class="op">-</span><span class="fl">99.980</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>0.01999999999999602</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>phloem_outputs_blue <span class="op">=</span> phloem_outputs.loc[<span class="st">"blue"</span>]</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>phloem_outputs_blue <span class="op">/</span> phloem_outputs_blue.iloc[<span class="dv">0</span>] <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>ATPase         Starch  
unconstrained  wt          100.000000
               starchko    100.000000
constrained    wt           99.999963
               starchko     99.999883
Name: (Phloem_tx_overall, nan), dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>phloem_outputs_white <span class="op">=</span> phloem_outputs.drop(<span class="st">"blue"</span>)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>phloem_outputs_white <span class="op">=</span> phloem_outputs_white <span class="op">/</span> phloem_outputs_white.iloc[<span class="dv">0</span>] <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>phloem_outputs_white</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/3118140255.py:1: PerformanceWarning: dropping on a non-lexsorted multi-index without a level parameter may impact performance.
  phloem_outputs_white = phloem_outputs.drop("blue")</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
white  unconstrained  wt          100.000000
                      starchko    100.000000
       constrained    wt           99.999957
                      starchko     99.999863
nops   unconstrained  wt           99.980210
                      starchko     99.980210
       constrained    wt           99.979949
                      starchko     99.979901
Name: (Phloem_tx_overall, nan), dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>phloem_outputs.drop(<span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_374830/4124221444.py:1: PerformanceWarning: dropping on a non-lexsorted multi-index without a level parameter may impact performance.
  phloem_outputs.drop("blue")</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>Light  ATPase         Starch  
white  unconstrained  wt          15.887536
                      starchko    15.887536
       constrained    wt          15.887530
                      starchko    15.887515
nops   unconstrained  wt          15.884392
                      starchko    15.884392
       constrained    wt          15.884351
                      starchko    15.884343
Name: (Phloem_tx_overall, nan), dtype: float64</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>solutions_df.xs(<span class="st">"fluxes"</span>, level<span class="op">=</span><span class="st">"Solution"</span>, axis<span class="op">=</span><span class="dv">1</span>).loc[(<span class="st">"Phloem_tx_overall"</span>, np.nan), :].plot.bar()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Axes: xlabel='Light,ATPase,Starch'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="2.2_analysingsolutions_files/figure-html/cell-146-output-2.png" class="img-fluid"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./2.1_solvingmodel.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Solving guard cell models for different parameters</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./2.3_flux_map_values.html" class="pagination-link">
        <span class="nav-page-text">Calculating line widths for flux maps</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>